<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: mmm2d.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mmm2d_8hpp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">mmm2d.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>MMM2D algorithm for long range coulomb interaction in 2d+h geometries.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="utils_8hpp_source.html">utils.hpp</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for mmm2d.hpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="mmm2d_8hpp__incl.svg" width="100%" height="552"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="mmm2d_8hpp__dep__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="mmm2d_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMMM2D__struct.html">MMM2D_struct</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">parameters for the MMM2D method for electrostatics.  <a href="structMMM2D__struct.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd0a18694d9f9773b18ee8e88ae7a40b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#afd0a18694d9f9773b18ee8e88ae7a40b">MMM2D_set_params</a> (double <a class="el" href="Mmm1dgpuForce__cuda_8cu.html#ae64910044d1d8f3cc7c1dd5612b7252d">maxPWerror</a>, double far_cut, double delta_top, double delta_bot, int const_pot_on, double pot_diff)</td></tr>
<tr class="memdesc:afd0a18694d9f9773b18ee8e88ae7a40b"><td class="mdescLeft">&#160;</td><td class="mdescRight">set parameters for MMM2D.  <a href="#afd0a18694d9f9773b18ee8e88ae7a40b">More...</a><br /></td></tr>
<tr class="separator:afd0a18694d9f9773b18ee8e88ae7a40b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a346d5c962e1de4aff62f07b5a787a82f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a346d5c962e1de4aff62f07b5a787a82f">MMM2D_add_far</a> (int f, int e)</td></tr>
<tr class="memdesc:a346d5c962e1de4aff62f07b5a787a82f"><td class="mdescLeft">&#160;</td><td class="mdescRight">the general long range force/energy calculation  <a href="#a346d5c962e1de4aff62f07b5a787a82f">More...</a><br /></td></tr>
<tr class="separator:a346d5c962e1de4aff62f07b5a787a82f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a018af5c4fe5603a21e1af8b8256d32cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a018af5c4fe5603a21e1af8b8256d32cb">MMM2D_add_far_force</a> ()</td></tr>
<tr class="memdesc:a018af5c4fe5603a21e1af8b8256d32cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">the actual long range force calculation  <a href="#a018af5c4fe5603a21e1af8b8256d32cb">More...</a><br /></td></tr>
<tr class="separator:a018af5c4fe5603a21e1af8b8256d32cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914194ff3d0134fc30fc84a3318c5163"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a914194ff3d0134fc30fc84a3318c5163">MMM2D_far_energy</a> ()</td></tr>
<tr class="memdesc:a914194ff3d0134fc30fc84a3318c5163"><td class="mdescLeft">&#160;</td><td class="mdescRight">the actual long range energy calculation  <a href="#a914194ff3d0134fc30fc84a3318c5163">More...</a><br /></td></tr>
<tr class="separator:a914194ff3d0134fc30fc84a3318c5163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99b8aecf35ecffb6009e7edfe0b1f1eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a99b8aecf35ecffb6009e7edfe0b1f1eb">add_mmm2d_coulomb_pair_force</a> (double charge_factor, double dv[3], double d2, double d, double f[3])</td></tr>
<tr class="memdesc:a99b8aecf35ecffb6009e7edfe0b1f1eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">pairwise calculated parts of MMM2D force (near neighbors)  <a href="#a99b8aecf35ecffb6009e7edfe0b1f1eb">More...</a><br /></td></tr>
<tr class="separator:a99b8aecf35ecffb6009e7edfe0b1f1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc855ae43ed6140feac9c9cdd695c3da"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#abc855ae43ed6140feac9c9cdd695c3da">mmm2d_coulomb_pair_energy</a> (double charge_factor, double dv[3], double d2, double d)</td></tr>
<tr class="memdesc:abc855ae43ed6140feac9c9cdd695c3da"><td class="mdescLeft">&#160;</td><td class="mdescRight">pairwise calculated parts of MMM2D force (near neighbors)  <a href="#abc855ae43ed6140feac9c9cdd695c3da">More...</a><br /></td></tr>
<tr class="separator:abc855ae43ed6140feac9c9cdd695c3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32dcb23ca7de8095375e6eb84a535730"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a32dcb23ca7de8095375e6eb84a535730">MMM2D_sanity_checks</a> ()</td></tr>
<tr class="memdesc:a32dcb23ca7de8095375e6eb84a535730"><td class="mdescLeft">&#160;</td><td class="mdescRight">check that MMM2D can run with the current parameters  <a href="#a32dcb23ca7de8095375e6eb84a535730">More...</a><br /></td></tr>
<tr class="separator:a32dcb23ca7de8095375e6eb84a535730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa25920576affb6fd9553c0738faf987"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#afa25920576affb6fd9553c0738faf987">MMM2D_init</a> ()</td></tr>
<tr class="memdesc:afa25920576affb6fd9553c0738faf987"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the MMM2D constants  <a href="#afa25920576affb6fd9553c0738faf987">More...</a><br /></td></tr>
<tr class="separator:afa25920576affb6fd9553c0738faf987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d52c129647a6b3c43610e575a23997"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#ab0d52c129647a6b3c43610e575a23997">MMM2D_on_resort_particles</a> ()</td></tr>
<tr class="memdesc:ab0d52c129647a6b3c43610e575a23997"><td class="mdescLeft">&#160;</td><td class="mdescRight">if the number of particles has changed (even per node), the particle buffers for the coefficients have to be resized.  <a href="#ab0d52c129647a6b3c43610e575a23997">More...</a><br /></td></tr>
<tr class="separator:ab0d52c129647a6b3c43610e575a23997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cea2efea8875f9a4c8cfbe8013a1fc1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a3cea2efea8875f9a4c8cfbe8013a1fc1">MMM2D_dielectric_layers_energy_contribution</a> ()</td></tr>
<tr class="memdesc:a3cea2efea8875f9a4c8cfbe8013a1fc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">energy contribution from dielectric layers  <a href="#a3cea2efea8875f9a4c8cfbe8013a1fc1">More...</a><br /></td></tr>
<tr class="separator:a3cea2efea8875f9a4c8cfbe8013a1fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51c4cebc1d29309f546e806495dc0d0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#a51c4cebc1d29309f546e806495dc0d0b">MMM2D_dielectric_layers_force_contribution</a> ()</td></tr>
<tr class="memdesc:a51c4cebc1d29309f546e806495dc0d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">force contribution from dielectric layers  <a href="#a51c4cebc1d29309f546e806495dc0d0b">More...</a><br /></td></tr>
<tr class="separator:a51c4cebc1d29309f546e806495dc0d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acd96db76bf1b25991251d86bfcba9163"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#acd96db76bf1b25991251d86bfcba9163">mmm2d_errors</a> []</td></tr>
<tr class="memdesc:acd96db76bf1b25991251d86bfcba9163"><td class="mdescLeft">&#160;</td><td class="mdescRight">error messages, see above  <a href="#acd96db76bf1b25991251d86bfcba9163">More...</a><br /></td></tr>
<tr class="separator:acd96db76bf1b25991251d86bfcba9163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d69d7a9e2ef89c11536a6e57f6afb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMMM2D__struct.html">MMM2D_struct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mmm2d_8hpp.html#ac0d69d7a9e2ef89c11536a6e57f6afb8">mmm2d_params</a></td></tr>
<tr class="separator:ac0d69d7a9e2ef89c11536a6e57f6afb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>MMM2D algorithm for long range coulomb interaction in 2d+h geometries. </p>
<p>Implementation of the MMM2D method for the calculation of the electrostatic interaction for two dimensionally periodic systems. For details on the method see MMM general. The MMM2D method works only with the layered or nsquared <a class="el" href="cells__tcl_8hpp.html#add79315ee40b70c9ebd0bbb230d9a106">cell system</a>. The tuning is not automated, since the only tunable parameter is the cell size, which can be changed easily in Tcl. Moreover, only a few values make sense to be tested, since in general the number of cells will be between 5 and 20. </p>

<p>Definition in file <a class="el" href="mmm2d_8hpp_source.html">mmm2d.hpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a99b8aecf35ecffb6009e7edfe0b1f1eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_mmm2d_coulomb_pair_force </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dv</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pairwise calculated parts of MMM2D force (near neighbors) </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01504">1504</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="mmm-common_8hpp_source.html#l00032">C_2PI</a>, <a class="el" href="mmm2d_8cpp_source.html#l00097">COMPLEX_FAC</a>, <a class="el" href="mmm2d_8cpp_source.html#l00094">COMPLEX_STEP</a>, <a class="el" href="mmm2d_8cpp_source.html#l00110">complexCutoff</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, <a class="el" href="utils_8hpp_source.html#l00080">IntList::e</a>, <a class="el" href="utils_8hpp_source.html#l00092">DoubleList::e</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="mmm2d_8cpp_source.html#l00065">K0</a>, <a class="el" href="mmm2d_8cpp_source.html#l00066">K1</a>, <a class="el" href="specfunc_8cpp_source.html#l00655">LPK01()</a>, <a class="el" href="mmm-common_8hpp_source.html#l00043">mod_psi_even()</a>, <a class="el" href="mmm-common_8hpp_source.html#l00047">mod_psi_odd()</a>, <a class="el" href="utils_8hpp_source.html#l00082">IntList::n</a>, <a class="el" href="mmm-common_8cpp_source.html#l00035">n_modPsi</a>, <a class="el" href="mmm2d_8cpp_source.html#l00104">part_error</a>, <a class="el" href="interaction__data_8hpp_source.html#l00524">Coulomb_parameters::prefactor</a>, <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux2</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">uy</a>, and <a class="el" href="mmm2d_8cpp_source.html#l00116">uy2</a>.</p>

<p>Referenced by <a class="el" href="forces__inline_8hpp_source.html#l00452">add_non_bonded_pair_force()</a>, <a class="el" href="iccp3m_8hpp_source.html#l00147">add_non_bonded_pair_force_iccp3m()</a>, and <a class="el" href="mmm2d_8cpp_source.html#l01970">MMM2D_dielectric_layers_force_contribution()</a>.</p>

</div>
</div>
<a class="anchor" id="a346d5c962e1de4aff62f07b5a787a82f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MMM2D_add_far </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the general long range force/energy calculation </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01295">1295</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="mmm2d_8cpp_source.html#l01186">add_force_contribution()</a>, <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="mmm-common_8hpp_source.html#l00032">C_2PI</a>, <a class="el" href="mmm2d_8cpp_source.html#l01242">energy_contribution()</a>, <a class="el" href="mmm2d_8hpp_source.html#l00046">MMM2D_struct::far_cut</a>, <a class="el" href="mmm2d_8hpp_source.html#l00046">MMM2D_struct::far_cut2</a>, <a class="el" href="mmm2d_8cpp_source.html#l00091">FARRELPREC</a>, <a class="el" href="debug_8hpp_source.html#l00041">free</a>, <a class="el" href="debug_8hpp_source.html#l00040">malloc</a>, <a class="el" href="mmm2d_8cpp_source.html#l00204">n_scxcache</a>, <a class="el" href="mmm2d_8cpp_source.html#l00207">n_scycache</a>, <a class="el" href="mmm2d_8cpp_source.html#l00290">prepare_scx_cache()</a>, <a class="el" href="mmm2d_8cpp_source.html#l00313">prepare_scy_cache()</a>, <a class="el" href="mmm2d_8cpp_source.html#l00127">self_energy</a>, <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux2</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">uy2</a>, and <a class="el" href="mmm2d_8cpp_source.html#l00116">uz</a>.</p>

<p>Referenced by <a class="el" href="mmm2d_8hpp_source.html#l00079">MMM2D_add_far_force()</a>, and <a class="el" href="mmm2d_8hpp_source.html#l00084">MMM2D_far_energy()</a>.</p>

</div>
</div>
<a class="anchor" id="a018af5c4fe5603a21e1af8b8256d32cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void MMM2D_add_far_force </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the actual long range force calculation </p>

<p>Definition at line <a class="el" href="mmm2d_8hpp_source.html#l00079">79</a> of file <a class="el" href="mmm2d_8hpp_source.html">mmm2d.hpp</a>.</p>

<p>References <a class="el" href="mmm2d_8cpp_source.html#l01295">MMM2D_add_far()</a>.</p>

<p>Referenced by <a class="el" href="forces_8cpp_source.html#l00152">calc_long_range_forces()</a>, and <a class="el" href="iccp3m_8cpp_source.html#l00569">calc_long_range_forces_iccp3m()</a>.</p>

</div>
</div>
<a class="anchor" id="abc855ae43ed6140feac9c9cdd695c3da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double mmm2d_coulomb_pair_energy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>charge_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dv</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>pairwise calculated parts of MMM2D force (near neighbors) </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01791">1791</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="mmm2d_8cpp_source.html#l01678">calc_mmm2d_copy_pair_energy()</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, and <a class="el" href="interaction__data_8hpp_source.html#l00524">Coulomb_parameters::prefactor</a>.</p>

<p>Referenced by <a class="el" href="energy__inline_8hpp_source.html#l00185">add_non_bonded_pair_energy()</a>, and <a class="el" href="mmm2d_8cpp_source.html#l02036">MMM2D_dielectric_layers_energy_contribution()</a>.</p>

</div>
</div>
<a class="anchor" id="a3cea2efea8875f9a4c8cfbe8013a1fc1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MMM2D_dielectric_layers_energy_contribution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>energy contribution from dielectric layers </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l02036">2036</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="mmm-common_8hpp_source.html#l00032">C_2PI</a>, <a class="el" href="cells_8cpp_source.html#l00048">cells</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mid_bot</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mid_top</a>, <a class="el" href="mmm2d_8hpp_source.html#l00052">MMM2D_struct::dielectric_contrast_on</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="layered_8cpp_source.html#l00088">layered_get_mi_vector()</a>, <a class="el" href="mmm2d_8cpp_source.html#l01791">mmm2d_coulomb_pair_energy()</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="layered_8cpp_source.html#l00083">n_layers</a>, <a class="el" href="communication_8cpp_source.html#l00076">n_nodes</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="interaction__data_8hpp_source.html#l00524">Coulomb_parameters::prefactor</a>, <a class="el" href="particle__data_8hpp_source.html#l00105">ParticleProperties::q</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="utils_8hpp_source.html#l00444">sqrlen()</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux</a>, and <a class="el" href="mmm2d_8cpp_source.html#l00116">uy</a>.</p>

<p>Referenced by <a class="el" href="energy_8cpp_source.html#l00173">calc_long_range_energies()</a>.</p>

</div>
</div>
<a class="anchor" id="a51c4cebc1d29309f546e806495dc0d0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MMM2D_dielectric_layers_force_contribution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>force contribution from dielectric layers </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01970">1970</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="mmm2d_8cpp_source.html#l01504">add_mmm2d_coulomb_pair_force()</a>, <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="mmm-common_8hpp_source.html#l00032">C_2PI</a>, <a class="el" href="cells_8cpp_source.html#l00048">cells</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mid_bot</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mid_top</a>, <a class="el" href="mmm2d_8hpp_source.html#l00052">MMM2D_struct::dielectric_contrast_on</a>, <a class="el" href="particle__data_8hpp_source.html#l00211">ParticleForce::f</a>, <a class="el" href="particle__data_8hpp_source.html#l00293">Particle::f</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="layered_8cpp_source.html#l00088">layered_get_mi_vector()</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="layered_8cpp_source.html#l00083">n_layers</a>, <a class="el" href="communication_8cpp_source.html#l00076">n_nodes</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="interaction__data_8hpp_source.html#l00524">Coulomb_parameters::prefactor</a>, <a class="el" href="particle__data_8hpp_source.html#l00105">ParticleProperties::q</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="utils_8hpp_source.html#l00444">sqrlen()</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux</a>, and <a class="el" href="mmm2d_8cpp_source.html#l00116">uy</a>.</p>

<p>Referenced by <a class="el" href="forces_8cpp_source.html#l00152">calc_long_range_forces()</a>, and <a class="el" href="iccp3m_8cpp_source.html#l00569">calc_long_range_forces_iccp3m()</a>.</p>

</div>
</div>
<a class="anchor" id="a914194ff3d0134fc30fc84a3318c5163"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double MMM2D_far_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the actual long range energy calculation </p>

<p>Definition at line <a class="el" href="mmm2d_8hpp_source.html#l00084">84</a> of file <a class="el" href="mmm2d_8hpp_source.html">mmm2d.hpp</a>.</p>

<p>References <a class="el" href="mmm2d_8cpp_source.html#l01295">MMM2D_add_far()</a>.</p>

<p>Referenced by <a class="el" href="energy_8cpp_source.html#l00173">calc_long_range_energies()</a>.</p>

</div>
</div>
<a class="anchor" id="afa25920576affb6fd9553c0738faf987"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MMM2D_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize the MMM2D constants </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01916">1916</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00081">CELL_STRUCTURE_LAYERED</a>, <a class="el" href="cells_8hpp_source.html#l00079">CELL_STRUCTURE_NSQUARE</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, <a class="el" href="interaction__data_8hpp_source.html#l00138">COULOMB_NONE</a>, <a class="el" href="mmm2d_8hpp_source.html#l00052">MMM2D_struct::dielectric_contrast_on</a>, <a class="el" href="cuda__common__cuda_8cu_source.html#l00058">err</a>, <a class="el" href="mmm2d_8hpp_source.html#l00050">MMM2D_struct::far_calculated</a>, <a class="el" href="mmm2d_8hpp_source.html#l00046">MMM2D_struct::far_cut</a>, <a class="el" href="mmm2d_8hpp_source.html#l00044">MMM2D_struct::maxPWerror</a>, <a class="el" href="interaction__data_8hpp_source.html#l00527">Coulomb_parameters::method</a>, <a class="el" href="mmm2d_8cpp_source.html#l00041">mmm2d_errors</a>, <a class="el" href="mmm2d_8cpp_source.html#l01896">MMM2D_sanity_checks()</a>, <a class="el" href="mmm2d_8cpp_source.html#l00262">MMM2D_setup_constants()</a>, <a class="el" href="mmm2d_8cpp_source.html#l01366">MMM2D_tune_far()</a>, <a class="el" href="mmm2d_8cpp_source.html#l01390">MMM2D_tune_near()</a>, <a class="el" href="communication_8cpp_source.html#l00076">n_nodes</a>, <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>, and <a class="el" href="cells_8hpp_source.html#l00132">CellStructure::type</a>.</p>

<p>Referenced by <a class="el" href="initialize_8cpp_source.html#l00423">on_boxl_change()</a>, <a class="el" href="initialize_8cpp_source.html#l00476">on_cell_structure_change()</a>, and <a class="el" href="initialize_8cpp_source.html#l00291">on_coulomb_change()</a>.</p>

</div>
</div>
<a class="anchor" id="ab0d52c129647a6b3c43610e575a23997"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MMM2D_on_resort_particles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>if the number of particles has changed (even per node), the particle buffers for the coefficients have to be resized. </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01952">1952</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00081">CELL_STRUCTURE_LAYERED</a>, <a class="el" href="cells_8cpp_source.html#l00275">cells_get_n_particles()</a>, <a class="el" href="mmm2d_8hpp_source.html#l00046">MMM2D_struct::far_cut</a>, <a class="el" href="mmm2d_8cpp_source.html#l00193">gblcblk</a>, <a class="el" href="mmm2d_8cpp_source.html#l00189">lclcblk</a>, <a class="el" href="mmm2d_8cpp_source.html#l01802">MMM2D_self_energy()</a>, <a class="el" href="cells_8cpp_source.html#l00050">n_cells</a>, <a class="el" href="mmm2d_8cpp_source.html#l00204">n_scxcache</a>, <a class="el" href="mmm2d_8cpp_source.html#l00207">n_scycache</a>, <a class="el" href="mmm2d_8cpp_source.html#l00187">partblk</a>, <a class="el" href="debug_8hpp_source.html#l00039">realloc</a>, <a class="el" href="mmm2d_8cpp_source.html#l00203">scxcache</a>, <a class="el" href="mmm2d_8cpp_source.html#l00206">scycache</a>, <a class="el" href="cells_8hpp_source.html#l00132">CellStructure::type</a>, <a class="el" href="mmm2d_8cpp_source.html#l00116">ux</a>, and <a class="el" href="mmm2d_8cpp_source.html#l00116">uy</a>.</p>

<p>Referenced by <a class="el" href="initialize_8cpp_source.html#l00400">on_resort_particles()</a>.</p>

</div>
</div>
<a class="anchor" id="a32dcb23ca7de8095375e6eb84a535730"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MMM2D_sanity_checks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check that MMM2D can run with the current parameters </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01896">1896</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00081">CELL_STRUCTURE_LAYERED</a>, <a class="el" href="cells_8hpp_source.html#l00079">CELL_STRUCTURE_NSQUARE</a>, <a class="el" href="grid_8hpp_source.html#l00054">PERIODIC</a>, <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>, and <a class="el" href="cells_8hpp_source.html#l00132">CellStructure::type</a>.</p>

<p>Referenced by <a class="el" href="interaction__data_8cpp_source.html#l00840">interactions_sanity_checks()</a>, and <a class="el" href="mmm2d_8cpp_source.html#l01916">MMM2D_init()</a>.</p>

</div>
</div>
<a class="anchor" id="afd0a18694d9f9773b18ee8e88ae7a40b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MMM2D_set_params </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxPWerror</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>far_cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta_top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta_bot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>const_pot_on</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pot_diff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set parameters for MMM2D. </p>
<p>This assumes that the particles do NOT leave the box. For the near formula (nsquared cell structure), precision might be lost, while the far formula might have problems with overflows. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maxPWerror</td><td>the maximal error for the pairwise interactions. Both for potential and force components. The potential is therefore always slightly more precise </td></tr>
    <tr><td class="paramname">far_cut</td><td>sets the cutoff for the far formula in inverse lengths. If -1, the far cutoff is determined by maxPWerror. Manual setting is probably only good for testing </td></tr>
    <tr><td class="paramname">delta_top</td><td>dielectric contrast at top of the simulation box </td></tr>
    <tr><td class="paramname">delta_mid</td><td>dielectric contrast in the middle of the simulation box </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l01830">1830</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>References <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00081">CELL_STRUCTURE_LAYERED</a>, <a class="el" href="cells_8hpp_source.html#l00079">CELL_STRUCTURE_NSQUARE</a>, <a class="el" href="mmm2d_8hpp_source.html#l00054">MMM2D_struct::const_pot_on</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, <a class="el" href="interaction__data_8hpp_source.html#l00142">COULOMB_MMM2D</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mid_bot</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mid_top</a>, <a class="el" href="mmm2d_8hpp_source.html#l00057">MMM2D_struct::delta_mult</a>, <a class="el" href="mmm2d_8hpp_source.html#l00052">MMM2D_struct::dielectric_contrast_on</a>, <a class="el" href="cuda__common__cuda_8cu_source.html#l00058">err</a>, <a class="el" href="mmm2d_8cpp_source.html#l00146">ERROR_ICL</a>, <a class="el" href="utils_8hpp_source.html#l00058">ES_ERROR</a>, <a class="el" href="utils_8hpp_source.html#l00056">ES_OK</a>, <a class="el" href="mmm2d_8hpp_source.html#l00050">MMM2D_struct::far_calculated</a>, <a class="el" href="mmm2d_8hpp_source.html#l00046">MMM2D_struct::far_cut</a>, <a class="el" href="mmm2d_8hpp_source.html#l00046">MMM2D_struct::far_cut2</a>, <a class="el" href="mmm2d_8hpp_source.html#l00044">MMM2D_struct::maxPWerror</a>, <a class="el" href="Mmm1dgpuForce__cuda_8cu_source.html#l00064">maxPWerror</a>, <a class="el" href="interaction__data_8hpp_source.html#l00527">Coulomb_parameters::method</a>, <a class="el" href="mmm2d_8cpp_source.html#l00262">MMM2D_setup_constants()</a>, <a class="el" href="mmm2d_8cpp_source.html#l01366">MMM2D_tune_far()</a>, <a class="el" href="mmm2d_8cpp_source.html#l01390">MMM2D_tune_near()</a>, <a class="el" href="communication_8cpp_source.html#l01873">mpi_bcast_coulomb_params()</a>, <a class="el" href="communication_8cpp_source.html#l00076">n_nodes</a>, <a class="el" href="mmm2d_8hpp_source.html#l00055">MMM2D_struct::pot_diff</a>, <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>, and <a class="el" href="cells_8hpp_source.html#l00132">CellStructure::type</a>.</p>

<p>Referenced by <a class="el" href="mmm2d__tcl_8cpp_source.html#l00065">tclcommand_inter_coulomb_parse_mmm2d()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="acd96db76bf1b25991251d86bfcba9163"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char const* mmm2d_errors[]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>error messages, see above </p>

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l00041">41</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>Referenced by <a class="el" href="mmm2d_8cpp_source.html#l01916">MMM2D_init()</a>, and <a class="el" href="mmm2d__tcl_8cpp_source.html#l00065">tclcommand_inter_coulomb_parse_mmm2d()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0d69d7a9e2ef89c11536a6e57f6afb8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMMM2D__struct.html">MMM2D_struct</a> mmm2d_params</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="mmm2d_8cpp_source.html#l00129">129</a> of file <a class="el" href="mmm2d_8cpp_source.html">mmm2d.cpp</a>.</p>

<p>Referenced by <a class="el" href="communication_8cpp_source.html#l01881">mpi_bcast_coulomb_params_slave()</a>, <a class="el" href="interaction__data__tcl_8cpp_source.html#l00899">tclcommand_print_efield_capacitors()</a>, and <a class="el" href="mmm2d__tcl_8cpp_source.html#l00042">tclprint_to_result_MMM2D()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="mmm2d_8hpp.html">mmm2d.hpp</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:42 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
