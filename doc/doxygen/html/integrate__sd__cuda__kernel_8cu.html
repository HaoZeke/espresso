<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: integrate_sd_cuda_kernel.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('integrate__sd__cuda__kernel_8cu.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">integrate_sd_cuda_kernel.cu File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="config_8hpp_source.html">config.hpp</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;cuda_runtime.h&quot;</code><br />
<code>#include &lt;device_functions.h&gt;</code><br />
<code>#include &quot;<a class="el" href="integrate__sd__cuda_8hpp_source.html">integrate_sd_cuda.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate__sd__cuda__device_8cu_source.html">integrate_sd_cuda_device.cu</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for integrate_sd_cuda_kernel.cu:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="integrate__sd__cuda__kernel_8cu__incl.svg" width="100%" height="552"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="integrate__sd__cuda__kernel_8cu_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abfb863fdf04edeee1fe4924f679782ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abfb863fdf04edeee1fe4924f679782ea">mydebug</a>(str, ...)</td></tr>
<tr class="memdesc:abfb863fdf04edeee1fe4924f679782ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned.  <a href="#abfb863fdf04edeee1fe4924f679782ea">More...</a><br /></td></tr>
<tr class="separator:abfb863fdf04edeee1fe4924f679782ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb863fdf04edeee1fe4924f679782ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abfb863fdf04edeee1fe4924f679782ea">mydebug</a>(str, ...)</td></tr>
<tr class="memdesc:abfb863fdf04edeee1fe4924f679782ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned.  <a href="#abfb863fdf04edeee1fe4924f679782ea">More...</a><br /></td></tr>
<tr class="separator:abfb863fdf04edeee1fe4924f679782ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb863fdf04edeee1fe4924f679782ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abfb863fdf04edeee1fe4924f679782ea">mydebug</a>(str, ...)</td></tr>
<tr class="memdesc:abfb863fdf04edeee1fe4924f679782ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned.  <a href="#abfb863fdf04edeee1fe4924f679782ea">More...</a><br /></td></tr>
<tr class="separator:abfb863fdf04edeee1fe4924f679782ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb863fdf04edeee1fe4924f679782ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abfb863fdf04edeee1fe4924f679782ea">mydebug</a>(str, ...)</td></tr>
<tr class="memdesc:abfb863fdf04edeee1fe4924f679782ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned.  <a href="#abfb863fdf04edeee1fe4924f679782ea">More...</a><br /></td></tr>
<tr class="separator:abfb863fdf04edeee1fe4924f679782ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4651264b1d44de656dc6903f7b742ab0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a4651264b1d44de656dc6903f7b742ab0">myCC</a>(pos)&#160;&#160;&#160;choleskyCache[threadIdx.x+ (pos)*numThreadsPerBlock]</td></tr>
<tr class="separator:a4651264b1d44de656dc6903f7b742ab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a17bd7aebfe396839620a814ec3e4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#ab8a17bd7aebfe396839620a814ec3e4d">DIST</a>&#160;&#160;&#160;(2+1e-1)</td></tr>
<tr class="separator:ab8a17bd7aebfe396839620a814ec3e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b2a0713bc6476c897cbf7730d3ae9e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a01b2a0713bc6476c897cbf7730d3ae9e">DISP_MAX</a>&#160;&#160;&#160;(1000)</td></tr>
<tr class="separator:a01b2a0713bc6476c897cbf7730d3ae9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abd2c126658d37ea367a9be385f2aeb29"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abd2c126658d37ea367a9be385f2aeb29">sd_compute_mobility_matrix</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r, int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> self_mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *mobility)</td></tr>
<tr class="separator:abd2c126658d37ea367a9be385f2aeb29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9829aa7331e317adc4e23d6520b58a12"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a9829aa7331e317adc4e23d6520b58a12">sd_compute_mobility_matrix_real_short</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r, int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> self_mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_g, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> cutoff, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> xi, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> xa, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> xa3)</td></tr>
<tr class="memdesc:a9829aa7331e317adc4e23d6520b58a12"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility with ewald summation this version assumes that the real-space cutoff is smaller than the boxlength.  <a href="#a9829aa7331e317adc4e23d6520b58a12">More...</a><br /></td></tr>
<tr class="separator:a9829aa7331e317adc4e23d6520b58a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a1540b4805cfaa7685402b20313065"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a38a1540b4805cfaa7685402b20313065">sd_compute_mobility_sines</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r, int N, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *vecs, int num, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *sines, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *cosines, int ldd)</td></tr>
<tr class="memdesc:a38a1540b4805cfaa7685402b20313065"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus.  <a href="#a38a1540b4805cfaa7685402b20313065">More...</a><br /></td></tr>
<tr class="separator:a38a1540b4805cfaa7685402b20313065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26479e159429ba36cf5f47eb5f0e7d5f"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a26479e159429ba36cf5f47eb5f0e7d5f">sd_wavepart_sum</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const forces, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const vecs, int num, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const matrices_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const sines, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const cosines, int ldd, int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *sin_sum, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *cos_sum, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> max)</td></tr>
<tr class="memdesc:a26479e159429ba36cf5f47eb5f0e7d5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the farfield contribution of the mobility with ewald summation this kernel computes the sum in eq. (3.34) and (3.35) in the master thesis "rotne-prager based hydrodynamics" by D. Schwoerer: M^{wave}  F_i cos / sin. The number of threads have to be a power of two e.g. 32, 64 or 128. forces is the input vector of form [fx_1, fy_1, fz_1, fx_2, fy_2, fz_2, ...].  <a href="#a26479e159429ba36cf5f47eb5f0e7d5f">More...</a><br /></td></tr>
<tr class="separator:a26479e159429ba36cf5f47eb5f0e7d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65174a661070a7b53b4a503683f11978"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a65174a661070a7b53b4a503683f11978">sd_wavepart_assemble</a> (const int num, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__ sines, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__ cosines, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__ sin_sum, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__ cos_sum, const int ldd, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *__restrict__ out, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> max, const int N, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> factor)</td></tr>
<tr class="memdesc:a65174a661070a7b53b4a503683f11978"><td class="mdescLeft">&#160;</td><td class="mdescRight">This computes the wave space contribution of the matrix vector product of the farfield. This uses the pre computed values from the kernel sd_wavepart_sum num : number of wave vectors sines : sinus of the scalar product of position and wave vector cosines : cosines of the scalar product of position and wave vector sin_sum : precomputed sum for sinus cos_sum : precomputed sum for cosinus ldd : leading dimension of the sin_sum and cos_sum arrays out : out vector upon which the result gets added max : maximal value of which the sin_sum and cos_sum can have N : number of particles factor : the scalar factor c of the matrix product c A  x.  <a href="#a65174a661070a7b53b4a503683f11978">More...</a><br /></td></tr>
<tr class="separator:a65174a661070a7b53b4a503683f11978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a81a7a052b423a0963bb5a7fb39e490"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a0a81a7a052b423a0963bb5a7fb39e490">sd_wavepart_addto_matrix</a> (const int num, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const matrices_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const sines, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const cosines, const int ldd, const int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const mobility_d, const int mat_ldd)</td></tr>
<tr class="memdesc:a0a81a7a052b423a0963bb5a7fb39e490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the wavepart contribution of the mobility to the matrix num : number of wave space vectors matrices_d : pointer to the matrices of the wave space contribution in the ewald sum sines : sines of the scalar product of wave space vector and particle positions cosines : cosines of the scalar product of wave space vector and particle positions ldd : leading dimension of sines/cosines N : number of particles mobility_d : mobility matrix to which the wave space contribution is added mat_ldd : leading dimension of the mobility matrix.  <a href="#a0a81a7a052b423a0963bb5a7fb39e490">More...</a><br /></td></tr>
<tr class="separator:a0a81a7a052b423a0963bb5a7fb39e490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5241d2140608a76bd9bb0337b2645e2"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#ad5241d2140608a76bd9bb0337b2645e2">sd_compute_resistance_matrix</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *pos, int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> self_mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_g, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *resistance, int *myInfo)</td></tr>
<tr class="memdesc:ad5241d2140608a76bd9bb0337b2645e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">this computes the near field as a ResistanceMatrix pos : is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : is the number of particles self_mobility : is 1./(6.*PI*eta*a) a : is the particle radius L_g : is the boxlength resistance : is the resistance matrix which will be retruned myInfo : contains infos about the operation: myInfo[0] : number of overlapping particles myInfo[1] : number of interacting particles (via nf) myInfo[2] : max number of interacting particles per particle  <a href="#ad5241d2140608a76bd9bb0337b2645e2">More...</a><br /></td></tr>
<tr class="separator:ad5241d2140608a76bd9bb0337b2645e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dbea56dbd0c51f077863a263e9ed71f"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a7dbea56dbd0c51f077863a263e9ed71f">sd_find_interacting_particles</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *pos, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_g, const int N, int *interacting, int *num_interacting, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> interaction_range)</td></tr>
<tr class="memdesc:a7dbea56dbd0c51f077863a263e9ed71f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find particle pairs which are within a certain cutoff range pos : is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] L_g : is the boxlength N : is the number of particles interacting : list of interaction particles. First entry is the first particle close enough to particle 1. Followed by the first one close enough to the second and so on. The second interaction particle of the first is at lda_short=((N+31)/32)*32 stored. num_interacting : for each particle the number of interacting particles. interaction_range : the cutoff range for interaction. Has to be smaller than half the boxlength.  <a href="#a7dbea56dbd0c51f077863a263e9ed71f">More...</a><br /></td></tr>
<tr class="separator:a7dbea56dbd0c51f077863a263e9ed71f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1ff7556b8e8bad35562d2ec76a41cf"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abc1ff7556b8e8bad35562d2ec76a41cf">sd_find_interacting_particles</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *pos, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *_L, const int N, int *interacting, int *num_interacting, const int *particle_count, const int *particle_sorted_list, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *bucket_size_, const int *bucket_num_, const int *particle_to_bucket_list, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> interaction_range, const int total_bucket_num)</td></tr>
<tr class="memdesc:abc1ff7556b8e8bad35562d2ec76a41cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find particle pairs which are within a certain cutoff range using buckets pos : the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] <em>L : the boxlength N : the number of particles interacting : list of interaction particles. First entry is the first particle close enough to particle 1. Followed by the first one close enough to the second and so on. The second interaction particle of the first is at lda_short=((N+31)/32)*32 stored. num_interacting : for each particle the number of interacting particles. particle_count : the number of particles within a certain bucket particle_sorted_list : the list of the particles in the buckets bucket_size</em> : real[3] array of the dimensions of a bucket bucket_num_ : int[3] array of the number of buckets in each direction particle_to_bucket_list : lookup table what particle is in what bucket interaction_range : the cutoff range for interaction. Has to be smaller than half the boxlength. total_bucket_num : number of buckets.  <a href="#abc1ff7556b8e8bad35562d2ec76a41cf">More...</a><br /></td></tr>
<tr class="separator:abc1ff7556b8e8bad35562d2ec76a41cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50c2213fdfc8db3302e094a84617c2fa"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a50c2213fdfc8db3302e094a84617c2fa">sd_compute_resistance_matrix_sparse</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *pos, const int N, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> self_mobility, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *_L, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *resistance, const int *col_idx, const int *row_l, int *myInfo)</td></tr>
<tr class="memdesc:a50c2213fdfc8db3302e094a84617c2fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the lubrication correction in the resistance formulation. pos : is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : is the number of particles self_mobility : is 1./(6.*PI*eta*a) a : is the particle radius _L : is the boxlength resistance : is the sparse resistance matrix which will be returned col_idx : list of interacting partilces row_l : number of col_idx entries per particle myInfo : contains infos about the operation: myInfo[0] : number of overlapping particles myInfo[1] : number of interacting particles (via nf) myInfo[2] : max number of interacting particles per particle.  <a href="#a50c2213fdfc8db3302e094a84617c2fa">More...</a><br /></td></tr>
<tr class="separator:a50c2213fdfc8db3302e094a84617c2fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01d4bde2763628a06a7edcc34bc75828"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a01d4bde2763628a06a7edcc34bc75828">sd_compute_brownian_force_nearfield</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *gaussian, int N, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_g, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> self_mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *brownian_force_nf)</td></tr>
<tr class="memdesc:a01d4bde2763628a06a7edcc34bc75828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computing the brownian forces which arise from the nearfield contribution of the mobility matrix r : position of the particles gaussian : pointer to a sufficent amount of gaussian distributed random numbers N : number of particles L_g : size of periodic box a : hydrodynamic particle radius self_mobility : is 1./(6.*PI*eta*a) brownian_force_nf : computed brownian force.  <a href="#a01d4bde2763628a06a7edcc34bc75828">More...</a><br /></td></tr>
<tr class="separator:a01d4bde2763628a06a7edcc34bc75828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ac6de900bf21e5d0a3de0c23d23fa43"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a0ac6de900bf21e5d0a3de0c23d23fa43">sd_multiply_sparse_matrix_vector</a> (const int size, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> factor, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *<a class="el" href="structmatrix.html">matrix</a>, const int ldd, const int ldd_short, const int *col_idx, const int *row_l, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *vec_in, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *vec_out)</td></tr>
<tr class="memdesc:a0ac6de900bf21e5d0a3de0c23d23fa43"><td class="mdescLeft">&#160;</td><td class="mdescRight">computing the matrix vector y = c * A * x product with a square sparse matrix A and a scalar factor c size : size of the matrix and of the input and output vectors factor : factor $c$ is the given prefactor matrix : data of the sparse matrix ldd : leading dimension of the matrix ldd_short : leading dimension of col_idx col_idx : indices of the entries in the matrix row_l : number of entris per row vec_in : the input vecor $x$ vec_out : the output vector $y$  <a href="#a0ac6de900bf21e5d0a3de0c23d23fa43">More...</a><br /></td></tr>
<tr class="separator:a0ac6de900bf21e5d0a3de0c23d23fa43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f5d9639c4856472ec53e4cc823578fa"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a4f5d9639c4856472ec53e4cc823578fa">sd_add_identity_matrix</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *<a class="el" href="structmatrix.html">matrix</a>, int size, int lda)</td></tr>
<tr class="memdesc:a4f5d9639c4856472ec53e4cc823578fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">this adds the identity matrix to a given matrix of ld=size matrix : pointer to the given matrix size : the size of the matrix (in the example below 3N) block : (ignored) the number of elements to process per thread if this is e.g. 3 and the matrix is 3Nx3N, than N threads have to be started  <a href="#a4f5d9639c4856472ec53e4cc823578fa">More...</a><br /></td></tr>
<tr class="separator:a4f5d9639c4856472ec53e4cc823578fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfdada18f0ec442070fc06eb6f1489b8"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#abfdada18f0ec442070fc06eb6f1489b8">sd_set_zero_matrix</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *<a class="el" href="structmatrix.html">matrix</a>, int size, int ldd)</td></tr>
<tr class="memdesc:abfdada18f0ec442070fc06eb6f1489b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">this sets a block to zero matrix : pointer to the given matrix size : the size of the matrix (in the example below 3N) ldd : the leading dimension of the matrix  <a href="#abfdada18f0ec442070fc06eb6f1489b8">More...</a><br /></td></tr>
<tr class="separator:abfdada18f0ec442070fc06eb6f1489b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bc178718e41326fe934b1fe177dd0d1"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a3bc178718e41326fe934b1fe177dd0d1">sd_set_zero</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *data, int size)</td></tr>
<tr class="memdesc:a3bc178718e41326fe934b1fe177dd0d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">this sets a block to zero data : pointer to the given data size : the size of the data  <a href="#a3bc178718e41326fe934b1fe177dd0d1">More...</a><br /></td></tr>
<tr class="separator:a3bc178718e41326fe934b1fe177dd0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6ba692a9b190f166aec5b90bcf5ca0"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a1e6ba692a9b190f166aec5b90bcf5ca0">sd_set_value</a> (int *data, int size, int value)</td></tr>
<tr class="memdesc:a1e6ba692a9b190f166aec5b90bcf5ca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">this sets a block to an given integer data : pointer to the given data size : the size of the data value : the value written to the data block  <a href="#a1e6ba692a9b190f166aec5b90bcf5ca0">More...</a><br /></td></tr>
<tr class="separator:a1e6ba692a9b190f166aec5b90bcf5ca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af118f7042127c8be0c3aa63858d07b7a"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#af118f7042127c8be0c3aa63858d07b7a">sd_set_value</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *data, int size, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> value)</td></tr>
<tr class="memdesc:af118f7042127c8be0c3aa63858d07b7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">this sets a block to an given real data : pointer to the given data size : the size of the data value : the value written to the data block  <a href="#af118f7042127c8be0c3aa63858d07b7a">More...</a><br /></td></tr>
<tr class="separator:af118f7042127c8be0c3aa63858d07b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c2dfd1d901a13b281fc6e275b37ac5"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#ab2c2dfd1d901a13b281fc6e275b37ac5">sd_real_integrate_prepare</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r_d, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *disp_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, int N)</td></tr>
<tr class="memdesc:ab2c2dfd1d901a13b281fc6e275b37ac5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checking before the actual integration whether any particles moves more than DISP_MAX and if so, reducing the displacement to DISP_MAX r_d : position of the particles disp_d : displacements of the particles L : box dimension a : particle radius N : number of particles.  <a href="#ab2c2dfd1d901a13b281fc6e275b37ac5">More...</a><br /></td></tr>
<tr class="separator:ab2c2dfd1d901a13b281fc6e275b37ac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c98144e9d8fb90ea68e292c68c33f0"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a76c98144e9d8fb90ea68e292c68c33f0">sd_real_integrate</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *disp_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, int N)</td></tr>
<tr class="memdesc:a76c98144e9d8fb90ea68e292c68c33f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">if SD_AVOID_COLLISION is set avoid that particles are overlapping after the displacement, else only perform the integration step r_d : position of the particles disp_d : displacement of the particles L : box dimensions a : particle radius N : number of particles  <a href="#a76c98144e9d8fb90ea68e292c68c33f0">More...</a><br /></td></tr>
<tr class="separator:a76c98144e9d8fb90ea68e292c68c33f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7803b38f82e601a5cdc0cfd234f698"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a4d7803b38f82e601a5cdc0cfd234f698">sd_bucket_sort</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *pos, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *bucketSize, const int *bucketNum, int N, int *particleCount, int *particleList, int maxParticlePerCell, int totalBucketNum, int *particleToBucketList)</td></tr>
<tr class="memdesc:a4d7803b38f82e601a5cdc0cfd234f698"><td class="mdescLeft">&#160;</td><td class="mdescRight">sorting the particles in buckets pos : position of the particles bucketSize : dimension of bucket bucketNum : number of buckets in each direction N : number of particles particleCount : number of particles within a bucket particleList : list of the particles within a given bucket totalBucketNum : number of buckets, product of the three values of bucketNum particleToBucketList : array containg the bucket number for each particle  <a href="#a4d7803b38f82e601a5cdc0cfd234f698">More...</a><br /></td></tr>
<tr class="separator:a4d7803b38f82e601a5cdc0cfd234f698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad684fa3c7bf17a37b486a4b344c9cfa"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#aad684fa3c7bf17a37b486a4b344c9cfa">sd_get_diag</a> (int size, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *mat_a, int lda, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *diag, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *diag_i)</td></tr>
<tr class="memdesc:aad684fa3c7bf17a37b486a4b344c9cfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads the diagonal element entries of a square matrix and stores them in the vector diag and the inverse of them in diag_i size : size of the matrix mat_a : the matrix lda : leading dimension of the matrix mat_a diag : the diagonal (OUT) diag_i : the inverse of the diagonal (OUT)  <a href="#aad684fa3c7bf17a37b486a4b344c9cfa">More...</a><br /></td></tr>
<tr class="separator:aad684fa3c7bf17a37b486a4b344c9cfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21586efc8a495f1f713fc4863f6d73a7"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a21586efc8a495f1f713fc4863f6d73a7">sd_nrm1</a> (const int size, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const vec, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *res)</td></tr>
<tr class="memdesc:a21586efc8a495f1f713fc4863f6d73a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">computing the 1 norm of a given vector size : size of the vector vec : data of the vector res : the 1 norm (OUT)  <a href="#a21586efc8a495f1f713fc4863f6d73a7">More...</a><br /></td></tr>
<tr class="separator:a21586efc8a495f1f713fc4863f6d73a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0b5d77fa7402964606f000c2859ddc"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda__kernel_8cu.html#a4e0b5d77fa7402964606f000c2859ddc">sd_nrm_inf</a> (const int size, const int *const vec, int *res)</td></tr>
<tr class="memdesc:a4e0b5d77fa7402964606f000c2859ddc"><td class="mdescLeft">&#160;</td><td class="mdescRight">computing the 1 norm of a given vector size : size of the vector vec : data of the vector res : the 1 norm (OUT)  <a href="#a4e0b5d77fa7402964606f000c2859ddc">More...</a><br /></td></tr>
<tr class="separator:a4e0b5d77fa7402964606f000c2859ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a01b2a0713bc6476c897cbf7730d3ae9e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DISP_MAX&#160;&#160;&#160;(1000)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01650">1650</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01658">sd_real_integrate_prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="ab8a17bd7aebfe396839620a814ec3e4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DIST&#160;&#160;&#160;(2+1e-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01649">1649</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01682">sd_real_integrate()</a>.</p>

</div>
</div>
<a class="anchor" id="a4651264b1d44de656dc6903f7b742ab0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define myCC</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pos</td><td>)</td>
          <td>&#160;&#160;&#160;choleskyCache[threadIdx.x+ (pos)*numThreadsPerBlock]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01314">sd_compute_brownian_force_nearfield()</a>.</p>

</div>
</div>
<a class="anchor" id="abfb863fdf04edeee1fe4924f679782ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mydebug</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">str, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned. </p>
<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus. r : the vector of positions [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : the number of particles vecs * : a pointer to the k-vectors num : number of k-vectors sines : the values for sin(pos_i k_j) cosines : the values for cos(pos_i k_j) ldd : the leading dimension of the sines and cosines array.</p>
<p>This computes the farfield contribution of the mobility with ewald summation this version assumes that the real-space cutoff is smaller than the boxlength r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius L_g is the boxlength mobility is the mobility matrix which will be retruned cutoff the realspace cutoff distance xi the splitting parameter as defined by Beenakker 1986 xa = xi * a xa3 = xa * xa * xa. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">649</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00048">sd_compute_mobility_matrix()</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00183">sd_compute_mobility_matrix_real_short()</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00317">sd_compute_mobility_sines()</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00662">sd_compute_resistance_matrix()</a>, and <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01103">sd_compute_resistance_matrix_sparse()</a>.</p>

</div>
</div>
<a class="anchor" id="abfb863fdf04edeee1fe4924f679782ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mydebug</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">str, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned. </p>
<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus. r : the vector of positions [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : the number of particles vecs * : a pointer to the k-vectors num : number of k-vectors sines : the values for sin(pos_i k_j) cosines : the values for cos(pos_i k_j) ldd : the leading dimension of the sines and cosines array.</p>
<p>This computes the farfield contribution of the mobility with ewald summation this version assumes that the real-space cutoff is smaller than the boxlength r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius L_g is the boxlength mobility is the mobility matrix which will be retruned cutoff the realspace cutoff distance xi the splitting parameter as defined by Beenakker 1986 xa = xi * a xa3 = xa * xa * xa. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">649</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

</div>
</div>
<a class="anchor" id="abfb863fdf04edeee1fe4924f679782ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mydebug</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">str, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned. </p>
<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus. r : the vector of positions [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : the number of particles vecs * : a pointer to the k-vectors num : number of k-vectors sines : the values for sin(pos_i k_j) cosines : the values for cos(pos_i k_j) ldd : the leading dimension of the sines and cosines array.</p>
<p>This computes the farfield contribution of the mobility with ewald summation this version assumes that the real-space cutoff is smaller than the boxlength r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius L_g is the boxlength mobility is the mobility matrix which will be retruned cutoff the realspace cutoff distance xi the splitting parameter as defined by Beenakker 1986 xa = xi * a xa3 = xa * xa * xa. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">649</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

</div>
</div>
<a class="anchor" id="abfb863fdf04edeee1fe4924f679782ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mydebug</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">str, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility in the case of no periodic boundary conditions. r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius mobility is the mobility matrix which will be retruned. </p>
<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus. r : the vector of positions [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : the number of particles vecs * : a pointer to the k-vectors num : number of k-vectors sines : the values for sin(pos_i k_j) cosines : the values for cos(pos_i k_j) ldd : the leading dimension of the sines and cosines array.</p>
<p>This computes the farfield contribution of the mobility with ewald summation this version assumes that the real-space cutoff is smaller than the boxlength r is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N is the number of particles self_mobility is 1./(6.*PI*eta*a) a is the particle radius L_g is the boxlength mobility is the mobility matrix which will be retruned cutoff the realspace cutoff distance xi the splitting parameter as defined by Beenakker 1986 xa = xi * a xa3 = xa * xa * xa. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">649</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4f5d9639c4856472ec53e4cc823578fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_add_identity_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this adds the identity matrix to a given matrix of ld=size matrix : pointer to the given matrix size : the size of the matrix (in the example below 3N) block : (ignored) the number of elements to process per thread if this is e.g. 3 and the matrix is 3Nx3N, than N threads have to be started </p>
<p>adds to each of the diagonal elemnts of the size*size matrix </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01591">1591</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a4d7803b38f82e601a5cdc0cfd234f698"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_bucket_sort </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>bucketSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>bucketNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>particleCount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>particleList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxParticlePerCell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>totalBucketNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>particleToBucketList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sorting the particles in buckets pos : position of the particles bucketSize : dimension of bucket bucketNum : number of buckets in each direction N : number of particles particleCount : number of particles within a bucket particleList : list of the particles within a given bucket totalBucketNum : number of buckets, product of the three values of bucketNum particleToBucketList : array containg the bucket number for each particle </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01769">1769</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00034">atomicAdd()</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a01d4bde2763628a06a7edcc34bc75828"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_compute_brownian_force_nearfield </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>gaussian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>self_mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>brownian_force_nf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computing the brownian forces which arise from the nearfield contribution of the mobility matrix r : position of the particles gaussian : pointer to a sufficent amount of gaussian distributed random numbers N : number of particles L_g : size of periodic box a : hydrodynamic particle radius self_mobility : is 1./(6.*PI*eta*a) brownian_force_nf : computed brownian force. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01314">1314</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00034">atomicAdd()</a>, <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="utils_8hpp_source.html#l00297">isnan</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu.html#a4651264b1d44de656dc6903f7b742ab0">myCC</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

</div>
</div>
<a class="anchor" id="abd2c126658d37ea367a9be385f2aeb29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_compute_mobility_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>self_mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>mobility</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00048">48</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">mydebug</a>.</p>

</div>
</div>
<a class="anchor" id="a9829aa7331e317adc4e23d6520b58a12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_compute_mobility_matrix_real_short </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>self_mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>cutoff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>xa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>xa3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility with ewald summation this version assumes that the real-space cutoff is smaller than the boxlength. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00183">183</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">mydebug</a>.</p>

</div>
</div>
<a class="anchor" id="a38a1540b4805cfaa7685402b20313065"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_compute_mobility_sines </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>vecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>sines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>cosines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ldd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00317">317</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">mydebug</a>.</p>

</div>
</div>
<a class="anchor" id="ad5241d2140608a76bd9bb0337b2645e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_compute_resistance_matrix </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>self_mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>resistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>myInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this computes the near field as a ResistanceMatrix pos : is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : is the number of particles self_mobility : is 1./(6.*PI*eta*a) a : is the particle radius L_g : is the boxlength resistance : is the resistance matrix which will be retruned myInfo : contains infos about the operation: myInfo[0] : number of overlapping particles myInfo[1] : number of interacting particles (via nf) myInfo[2] : max number of interacting particles per particle </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00662">662</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00034">atomicAdd()</a>, <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">mydebug</a>.</p>

</div>
</div>
<a class="anchor" id="a50c2213fdfc8db3302e094a84617c2fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_compute_resistance_matrix_sparse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>self_mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>resistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>col_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>row_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>myInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the lubrication correction in the resistance formulation. pos : is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] N : is the number of particles self_mobility : is 1./(6.*PI*eta*a) a : is the particle radius _L : is the boxlength resistance : is the sparse resistance matrix which will be returned col_idx : list of interacting partilces row_l : number of col_idx entries per particle myInfo : contains infos about the operation: myInfo[0] : number of overlapping particles myInfo[1] : number of interacting particles (via nf) myInfo[2] : max number of interacting particles per particle. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01103">1103</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00034">atomicAdd()</a>, <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00649">mydebug</a>.</p>

</div>
</div>
<a class="anchor" id="a7dbea56dbd0c51f077863a263e9ed71f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_find_interacting_particles </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>interacting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>num_interacting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>interaction_range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find particle pairs which are within a certain cutoff range pos : is the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] L_g : is the boxlength N : is the number of particles interacting : list of interaction particles. First entry is the first particle close enough to particle 1. Followed by the first one close enough to the second and so on. The second interaction particle of the first is at lda_short=((N+31)/32)*32 stored. num_interacting : for each particle the number of interacting particles. interaction_range : the cutoff range for interaction. Has to be smaller than half the boxlength. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00859">859</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

</div>
</div>
<a class="anchor" id="abc1ff7556b8e8bad35562d2ec76a41cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_find_interacting_particles </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>_L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>interacting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>num_interacting</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>particle_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>particle_sorted_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>bucket_size_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>bucket_num_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>particle_to_bucket_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>interaction_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>total_bucket_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find particle pairs which are within a certain cutoff range using buckets pos : the vector of [x_1, y_1, z_1, x_2, y_2, z_2, ...] <em>L : the boxlength N : the number of particles interacting : list of interaction particles. First entry is the first particle close enough to particle 1. Followed by the first one close enough to the second and so on. The second interaction particle of the first is at lda_short=((N+31)/32)*32 stored. num_interacting : for each particle the number of interacting particles. particle_count : the number of particles within a certain bucket particle_sorted_list : the list of the particles in the buckets bucket_size</em> : real[3] array of the dimensions of a bucket bucket_num_ : int[3] array of the number of buckets in each direction particle_to_bucket_list : lookup table what particle is in what bucket interaction_range : the cutoff range for interaction. Has to be smaller than half the boxlength. total_bucket_num : number of buckets. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00926">926</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

</div>
</div>
<a class="anchor" id="aad684fa3c7bf17a37b486a4b344c9cfa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_get_diag </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>mat_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>diag_i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads the diagonal element entries of a square matrix and stores them in the vector diag and the inverse of them in diag_i size : size of the matrix mat_a : the matrix lda : leading dimension of the matrix mat_a diag : the diagonal (OUT) diag_i : the inverse of the diagonal (OUT) </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01831">1831</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

</div>
</div>
<a class="anchor" id="a0ac6de900bf21e5d0a3de0c23d23fa43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_multiply_sparse_matrix_vector </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ldd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ldd_short</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>col_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>row_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>vec_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>vec_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computing the matrix vector y = c * A * x product with a square sparse matrix A and a scalar factor c size : size of the matrix and of the input and output vectors factor : factor $c$ is the given prefactor matrix : data of the sparse matrix ldd : leading dimension of the matrix ldd_short : leading dimension of col_idx col_idx : indices of the entries in the matrix row_l : number of entris per row vec_in : the input vecor $x$ vec_out : the output vector $y$ </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01566">1566</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00114">read_without_caching()</a>.</p>

</div>
</div>
<a class="anchor" id="a21586efc8a495f1f713fc4863f6d73a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_nrm1 </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computing the 1 norm of a given vector size : size of the vector vec : data of the vector res : the 1 norm (OUT) </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01845">1845</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00099">reduce_sum()</a>.</p>

</div>
</div>
<a class="anchor" id="a4e0b5d77fa7402964606f000c2859ddc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_nrm_inf </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *const&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computing the 1 norm of a given vector size : size of the vector vec : data of the vector res : the 1 norm (OUT) </p>
<p>computing the inf norm of a given vector (or in other words the largest value) if more than one block is used, this kernel does not perform the final reduction size : size of the vector vec : data of the vector res : the 1 norm (OUT) </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01864">1864</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00066">reduce_max()</a>.</p>

</div>
</div>
<a class="anchor" id="a76c98144e9d8fb90ea68e292c68c33f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_real_integrate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>disp_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>if SD_AVOID_COLLISION is set avoid that particles are overlapping after the displacement, else only perform the integration step r_d : position of the particles disp_d : displacement of the particles L : box dimensions a : particle radius N : number of particles </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01682">1682</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="ghmc_8cpp_source.html#l00054">beta</a>, <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01649">DIST</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="ab2c2dfd1d901a13b281fc6e275b37ac5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_real_integrate_prepare </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>disp_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checking before the actual integration whether any particles moves more than DISP_MAX and if so, reducing the displacement to DISP_MAX r_d : position of the particles disp_d : displacements of the particles L : box dimension a : particle radius N : number of particles. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01658">1658</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01650">DISP_MAX</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a1e6ba692a9b190f166aec5b90bcf5ca0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_set_value </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this sets a block to an given integer data : pointer to the given data size : the size of the data value : the value written to the data block </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01628">1628</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="af118f7042127c8be0c3aa63858d07b7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_set_value </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this sets a block to an given real data : pointer to the given data size : the size of the data value : the value written to the data block </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01639">1639</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a3bc178718e41326fe934b1fe177dd0d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_set_zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this sets a block to zero data : pointer to the given data size : the size of the data </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01617">1617</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="abfdada18f0ec442070fc06eb6f1489b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_set_zero_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ldd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this sets a block to zero matrix : pointer to the given matrix size : the size of the matrix (in the example below 3N) ldd : the leading dimension of the matrix </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l01604">1604</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a0a81a7a052b423a0963bb5a7fb39e490"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_wavepart_addto_matrix </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>matrices_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>sines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>cosines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ldd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>mobility_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>mat_ldd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the wavepart contribution of the mobility to the matrix num : number of wave space vectors matrices_d : pointer to the matrices of the wave space contribution in the ewald sum sines : sines of the scalar product of wave space vector and particle positions cosines : cosines of the scalar product of wave space vector and particle positions ldd : leading dimension of sines/cosines N : number of particles mobility_d : mobility matrix to which the wave space contribution is added mat_ldd : leading dimension of the mobility matrix. </p>
<p>Add the wavepart contribution of the mobility to the matrix. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00596">596</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>.</p>

</div>
</div>
<a class="anchor" id="a65174a661070a7b53b4a503683f11978"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_wavepart_assemble </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__&#160;</td>
          <td class="paramname"><em>sines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__&#160;</td>
          <td class="paramname"><em>cosines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__&#160;</td>
          <td class="paramname"><em>sin_sum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const __restrict__&#160;</td>
          <td class="paramname"><em>cos_sum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ldd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *__restrict__&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the wave space contribution of the matrix vector product of the farfield. This uses the pre computed values from the kernel sd_wavepart_sum num : number of wave vectors sines : sinus of the scalar product of position and wave vector cosines : cosines of the scalar product of position and wave vector sin_sum : precomputed sum for sinus cos_sum : precomputed sum for cosinus ldd : leading dimension of the sin_sum and cos_sum arrays out : out vector upon which the result gets added max : maximal value of which the sin_sum and cos_sum can have N : number of particles factor : the scalar factor c of the matrix product c A  x. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00484">484</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a26479e159429ba36cf5f47eb5f0e7d5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void sd_wavepart_sum </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>forces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>vecs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>matrices_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>sines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *const&#160;</td>
          <td class="paramname"><em>cosines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ldd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>sin_sum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>cos_sum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sum in eq. (3.34) and (3.35) in the master thesis "rotne-prager based hydrodynamics" by D. Schwoerer: M^{wave}  F_i cos / sin. The number of threads have to be a power of two e.g. 32, 64 or 128. forces is the input vector of form [fx_1, fy_1, fz_1, fx_2, fy_2, fz_2, ...]. </p>
<p>This computes the farfield contribution of the mobility with ewald summation this kernel computes the sines and cosinus. </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00370">370</a> of file <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html">integrate_sd_cuda_kernel.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda__device_8cu_source.html#l00099">reduce_sum()</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="integrate__sd__cuda__kernel_8cu.html">integrate_sd_cuda_kernel.cu</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:41 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
