<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: domain_decomposition.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('domain__decomposition_8hpp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a>  </div>
  <div class="headertitle">
<div class="title">domain_decomposition.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains everything related to the cell system: domain decomposition.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="utils_8hpp_source.html">utils.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cells_8hpp_source.html">cells.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate_8hpp_source.html">integrate.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="verlet_8hpp_source.html">verlet.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thermostat_8hpp_source.html">thermostat.hpp</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for domain_decomposition.hpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="domain__decomposition_8hpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="domain__decomposition_8hpp__dep__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="domain__decomposition_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structIA__Neighbor.html">IA_Neighbor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing information about non bonded interactions with particles in a neighbor cell.  <a href="structIA__Neighbor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structIA__Neighbor__List.html">IA_Neighbor_List</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDomainDecomposition.html">DomainDecomposition</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing the information about the cell grid used for domain decomposition.  <a href="structDomainDecomposition.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Exported Functions</div></td></tr>
<tr class="memitem:af9ac7edf794cbf704801b22ba706e51a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#af9ac7edf794cbf704801b22ba706e51a">dd_on_geometry_change</a> (int flags)</td></tr>
<tr class="memdesc:af9ac7edf794cbf704801b22ba706e51a"><td class="mdescLeft">&#160;</td><td class="mdescRight">adjust the domain decomposition to a change in the geometry.  <a href="#af9ac7edf794cbf704801b22ba706e51a">More...</a><br /></td></tr>
<tr class="separator:af9ac7edf794cbf704801b22ba706e51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf1f9909d24bed0309435417f3b834d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#acf1f9909d24bed0309435417f3b834d9">dd_topology_init</a> (<a class="el" href="structCellPList.html">CellPList</a> *cl)</td></tr>
<tr class="memdesc:acf1f9909d24bed0309435417f3b834d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the topology.  <a href="#acf1f9909d24bed0309435417f3b834d9">More...</a><br /></td></tr>
<tr class="separator:acf1f9909d24bed0309435417f3b834d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54d98068056011155d9fa519d44b2f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#aa54d98068056011155d9fa519d44b2f3">dd_topology_release</a> ()</td></tr>
<tr class="memdesc:aa54d98068056011155d9fa519d44b2f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when the current cell structure is invalidated because for example the box length has changed.  <a href="#aa54d98068056011155d9fa519d44b2f3">More...</a><br /></td></tr>
<tr class="separator:aa54d98068056011155d9fa519d44b2f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6cc29e99f31c3f3c19558f01bbad5a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#ab6cc29e99f31c3f3c19558f01bbad5a8">dd_exchange_and_sort_particles</a> (int global_flag)</td></tr>
<tr class="memdesc:ab6cc29e99f31c3f3c19558f01bbad5a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Just resort the particles.  <a href="#ab6cc29e99f31c3f3c19558f01bbad5a8">More...</a><br /></td></tr>
<tr class="separator:ab6cc29e99f31c3f3c19558f01bbad5a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eccce6119f1d3d64754c72b674c9009"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cells_8hpp.html#ab56e99d3478fae31e65ae78989a2ce89">Cell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#a3eccce6119f1d3d64754c72b674c9009">dd_position_to_cell</a> (double pos[3])</td></tr>
<tr class="memdesc:a3eccce6119f1d3d64754c72b674c9009"><td class="mdescLeft">&#160;</td><td class="mdescRight">implements <a class="el" href="structCellStructure.html#a16ef08fec33ec287fd2fecebb2a4e8a4">CellStructure::position_to_cell</a>.  <a href="#a3eccce6119f1d3d64754c72b674c9009">More...</a><br /></td></tr>
<tr class="separator:a3eccce6119f1d3d64754c72b674c9009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1410c4a98d8dc44ff1d2533c3ee36b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#aad1410c4a98d8dc44ff1d2533c3ee36b">calc_processor_min_num_cells</a> ()</td></tr>
<tr class="memdesc:aad1410c4a98d8dc44ff1d2533c3ee36b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate physical (processor) minimal number of cells  <a href="#aad1410c4a98d8dc44ff1d2533c3ee36b">More...</a><br /></td></tr>
<tr class="separator:aad1410c4a98d8dc44ff1d2533c3ee36b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae187bb42b2e81f238c7edac6f800fefc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#ae187bb42b2e81f238c7edac6f800fefc">calc_link_cell</a> ()</td></tr>
<tr class="memdesc:ae187bb42b2e81f238c7edac6f800fefc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate nonbonded and bonded forces with link-cell method (without Verlet lists)  <a href="#ae187bb42b2e81f238c7edac6f800fefc">More...</a><br /></td></tr>
<tr class="separator:ae187bb42b2e81f238c7edac6f800fefc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae352f483ebdf497612d8e3d892c4342d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#ae352f483ebdf497612d8e3d892c4342d">calculate_link_cell_energies</a> ()</td></tr>
<tr class="memdesc:ae352f483ebdf497612d8e3d892c4342d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nonbonded and bonded energy calculation using link-cell method.  <a href="#ae352f483ebdf497612d8e3d892c4342d">More...</a><br /></td></tr>
<tr class="separator:ae352f483ebdf497612d8e3d892c4342d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7386e3ccc9009ad5fe62d5876beda487"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#a7386e3ccc9009ad5fe62d5876beda487">calculate_link_cell_virials</a> (int v_comp)</td></tr>
<tr class="memdesc:a7386e3ccc9009ad5fe62d5876beda487"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nonbonded and bonded virials calculation using link-cell method.  <a href="#a7386e3ccc9009ad5fe62d5876beda487">More...</a><br /></td></tr>
<tr class="separator:a7386e3ccc9009ad5fe62d5876beda487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4e8f92e948271c97760592a54327579"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#ac4e8f92e948271c97760592a54327579">dd_fill_comm_cell_lists</a> (<a class="el" href="cells_8hpp.html#ab56e99d3478fae31e65ae78989a2ce89">Cell</a> **part_lists, int lc[3], int hc[3])</td></tr>
<tr class="memdesc:ac4e8f92e948271c97760592a54327579"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a communication cell pointer list.  <a href="#ac4e8f92e948271c97760592a54327579">More...</a><br /></td></tr>
<tr class="separator:ac4e8f92e948271c97760592a54327579"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32300628195f95ee2dbaf021f4e501eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cells_8hpp.html#ab56e99d3478fae31e65ae78989a2ce89">Cell</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#a32300628195f95ee2dbaf021f4e501eb">dd_save_position_to_cell</a> (double pos[3])</td></tr>
<tr class="memdesc:a32300628195f95ee2dbaf021f4e501eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns pointer to the cell which corresponds to the position if the position is in the nodes spatial domain otherwise a NULL pointer.  <a href="#a32300628195f95ee2dbaf021f4e501eb">More...</a><br /></td></tr>
<tr class="separator:a32300628195f95ee2dbaf021f4e501eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4101ea25e1ef19cf3c2f50d875c3960f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#a4101ea25e1ef19cf3c2f50d875c3960f">dd_assign_prefetches</a> (<a class="el" href="structGhostCommunicator.html">GhostCommunicator</a> *comm)</td></tr>
<tr class="memdesc:a4101ea25e1ef19cf3c2f50d875c3960f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Of every two communication rounds, set the first receivers to prefetch and poststore.  <a href="#a4101ea25e1ef19cf3c2f50d875c3960f">More...</a><br /></td></tr>
<tr class="separator:a4101ea25e1ef19cf3c2f50d875c3960f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Exported Variables</div></td></tr>
<tr class="memitem:a3d049536fb2ac4c226a769ab2a975f07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDomainDecomposition.html">DomainDecomposition</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#a3d049536fb2ac4c226a769ab2a975f07">dd</a></td></tr>
<tr class="memdesc:a3d049536fb2ac4c226a769ab2a975f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about the domain decomposition.  <a href="#a3d049536fb2ac4c226a769ab2a975f07">More...</a><br /></td></tr>
<tr class="separator:a3d049536fb2ac4c226a769ab2a975f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee68a321ae0f7079fdf80670e16e303d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#aee68a321ae0f7079fdf80670e16e303d">max_skin</a></td></tr>
<tr class="memdesc:aee68a321ae0f7079fdf80670e16e303d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximal skin size.  <a href="#aee68a321ae0f7079fdf80670e16e303d">More...</a><br /></td></tr>
<tr class="separator:aee68a321ae0f7079fdf80670e16e303d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec7cd0f14b18a8eaf1b738e493cc7cb1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#aec7cd0f14b18a8eaf1b738e493cc7cb1">max_num_cells</a></td></tr>
<tr class="memdesc:aec7cd0f14b18a8eaf1b738e493cc7cb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximal number of cells per node.  <a href="#aec7cd0f14b18a8eaf1b738e493cc7cb1">More...</a><br /></td></tr>
<tr class="separator:aec7cd0f14b18a8eaf1b738e493cc7cb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfea52e26b6262bf2b71f94e50c21975"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="domain__decomposition_8hpp.html#acfea52e26b6262bf2b71f94e50c21975">min_num_cells</a></td></tr>
<tr class="memdesc:acfea52e26b6262bf2b71f94e50c21975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimal number of cells per node.  <a href="#acfea52e26b6262bf2b71f94e50c21975">More...</a><br /></td></tr>
<tr class="separator:acfea52e26b6262bf2b71f94e50c21975"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains everything related to the cell system: domain decomposition. </p>
<p>The simulation box is split into spatial domains for each node according to a cartesian node grid (<a class="el" href="grid_8hpp.html#a0875bfa868b3432ea7e7d18c7a86094d">node_grid</a>).</p>
<p>The domain of a node is split into a 3D cell grid with dimension <a class="el" href="structDomainDecomposition.html#a22cd8ea41d8a223caf5e2af4232f7b69">DomainDecomposition::cell_grid</a>. Together with one ghost cell layer on each side the overall dimension of the ghost cell grid is <a class="el" href="structDomainDecomposition.html#abacbb5466ab74ac6b5209adce8de5ec6">DomainDecomposition::ghost_cell_grid</a>. The domain decomposition enables one the use of the linked cell algorithm which is in turn used for setting up the verlet list for the system. You can see a 2D graphical representation of the linked cell grid below.</p>
<div class="image">
<img src="linked_cells.gif" alt="linked_cells.gif"/>
<div class="caption">
Linked cells structure</div></div>
<p> 2D representation of a linked cell grid: cell_grid = {4,4}, ghost_cell_grid = {6,6}</p>
<p>Each cell has 3^D neighbor cells (For cell 14 they are marked). Since we deal with pair forces, it is sufficient to calculate only half of the interactions (Newtons law: actio = reactio). We have chosen the upper half e.g. all neighbor cells with a higher linear index (For cell 14 they are marked in light blue). Caution: This implementation needs double sided ghost communication! For single sided ghost communication one would need some ghost-ghost cell interaction as well, which we do not need!</p>
<p>For more information on cells, see <a class="el" href="cells_8hpp.html">cells.hpp</a> </p>

<p>Definition in file <a class="el" href="domain__decomposition_8hpp_source.html">domain_decomposition.hpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae187bb42b2e81f238c7edac6f800fefc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calc_link_cell </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate nonbonded and bonded forces with link-cell method (without Verlet lists) </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l01135">1135</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="forces__inline_8hpp_source.html#l00608">add_bonded_force()</a>, <a class="el" href="constraint_8cpp_source.html#l02308">add_constraints_forces()</a>, <a class="el" href="external__potential_8cpp_source.html#l00265">add_external_potential_forces()</a>, <a class="el" href="forces__inline_8hpp_source.html#l00452">add_non_bonded_pair_force()</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00119">DomainDecomposition::cell_inter</a>, <a class="el" href="utils_8hpp_source.html#l00888">distance2vec()</a>, <a class="el" href="particle__data_8hpp_source.html#l00826">do_nonbonded()</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00100">IA_Neighbor_List::n_neighbors</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00102">IA_Neighbor_List::nList</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00070">IA_Neighbor::pList</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, and <a class="el" href="cells_8cpp_source.html#l00061">rebuild_verletlist</a>.</p>

<p>Referenced by <a class="el" href="forces__inline_8hpp_source.html#l00205">force_calc()</a>.</p>

</div>
</div>
<a class="anchor" id="aad1410c4a98d8dc44ff1d2533c3ee36b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calc_processor_min_num_cells </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate physical (processor) minimal number of cells </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l01123">1123</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>.</p>

<p>Referenced by <a class="el" href="initialize_8cpp_source.html#l00082">on_program_start()</a>, and <a class="el" href="domain__decomposition__tcl_8cpp_source.html#l00060">tclcallback_min_num_cells()</a>.</p>

</div>
</div>
<a class="anchor" id="ae352f483ebdf497612d8e3d892c4342d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_link_cell_energies </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nonbonded and bonded energy calculation using link-cell method. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l01188">1188</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="energy__inline_8hpp_source.html#l00264">add_bonded_energy()</a>, <a class="el" href="constraint_8cpp_source.html#l02639">add_constraints_energy()</a>, <a class="el" href="external__potential_8cpp_source.html#l00294">add_external_potential_energy()</a>, <a class="el" href="energy__inline_8hpp_source.html#l00491">add_kinetic_energy()</a>, <a class="el" href="energy__inline_8hpp_source.html#l00185">add_non_bonded_pair_energy()</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00119">DomainDecomposition::cell_inter</a>, <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="utils_8hpp_source.html#l00888">distance2vec()</a>, <a class="el" href="particle__data_8hpp_source.html#l00826">do_nonbonded()</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00100">IA_Neighbor_List::n_neighbors</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00102">IA_Neighbor_List::nList</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00070">IA_Neighbor::pList</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="cells_8cpp_source.html#l00061">rebuild_verletlist</a>, and <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>.</p>

<p>Referenced by <a class="el" href="energy_8cpp_source.html#l00102">energy_calc()</a>.</p>

</div>
</div>
<a class="anchor" id="a7386e3ccc9009ad5fe62d5876beda487"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_link_cell_virials </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v_comp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nonbonded and bonded virials calculation using link-cell method. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l01244">1244</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="pressure_8hpp_source.html#l00303">add_bonded_virials()</a>, <a class="el" href="pressure_8hpp_source.html#l00505">add_kinetic_virials()</a>, <a class="el" href="pressure_8hpp_source.html#l00072">add_non_bonded_pair_virials()</a>, <a class="el" href="pressure_8hpp_source.html#l00347">add_three_body_bonded_stress()</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00119">DomainDecomposition::cell_inter</a>, <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="utils_8hpp_source.html#l00888">distance2vec()</a>, <a class="el" href="particle__data_8hpp_source.html#l00826">do_nonbonded()</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00100">IA_Neighbor_List::n_neighbors</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00102">IA_Neighbor_List::nList</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00070">IA_Neighbor::pList</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="cells_8cpp_source.html#l00061">rebuild_verletlist</a>, and <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>.</p>

<p>Referenced by <a class="el" href="pressure_8cpp_source.html#l00083">pressure_calc()</a>.</p>

</div>
</div>
<a class="anchor" id="a4101ea25e1ef19cf3c2f50d875c3960f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_assign_prefetches </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGhostCommunicator.html">GhostCommunicator</a> *&#160;</td>
          <td class="paramname"><em>comm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Of every two communication rounds, set the first receivers to prefetch and poststore. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00441">441</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="ghosts_8hpp_source.html#l00177">GhostCommunicator::comm</a>, <a class="el" href="ghosts_8hpp_source.html#l00109">GHOST_PREFETCH</a>, <a class="el" href="ghosts_8hpp_source.html#l00111">GHOST_PSTSTORE</a>, <a class="el" href="ghosts_8hpp_source.html#l00098">GHOST_RECV</a>, <a class="el" href="ghosts_8hpp_source.html#l00096">GHOST_SEND</a>, <a class="el" href="ghosts_8hpp_source.html#l00174">GhostCommunicator::num</a>, and <a class="el" href="ghosts_8hpp_source.html#l00151">GhostCommunication::type</a>.</p>

<p>Referenced by <a class="el" href="domain__decomposition_8cpp_source.html#l00697">dd_on_geometry_change()</a>, and <a class="el" href="domain__decomposition_8cpp_source.html#l00794">dd_topology_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ab6cc29e99f31c3f3c19558f01bbad5a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_exchange_and_sort_particles </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>global_flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Just resort the particles. </p>
<p>Used during integration. The particles are stored in the cell structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">global_flag</td><td>Use DD_GLOBAL_EXCHANGE for global exchange and DD_NEIGHBOR_EXCHANGE for neighbor exchange (recommended for use within Molecular dynamics, or any other integration scheme using only local particle moves) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00918">918</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="grid_8cpp_source.html#l00059">boundary</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="cells_8hpp_source.html#l00090">CELL_GLOBAL_EXCHANGE</a>, <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="debug_8cpp_source.html#l00100">check_particle_consistency()</a>, <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00653">dd_append_particles()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00581">dd_save_position_to_cell()</a>, <a class="el" href="grid_8hpp_source.html#l00211">fold_coordinate()</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="particle__data_8hpp_source.html#l00245">ParticleLocal::i</a>, <a class="el" href="particle__data_8hpp_source.html#l00077">ParticleProperties::identity</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l00425">init_particlelist()</a>, <a class="el" href="particle__data_8hpp_source.html#l00295">Particle::l</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l00072">local_particles</a>, <a class="el" href="particle__data_8hpp_source.html#l00291">Particle::m</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l00521">move_indexed_particle()</a>, <a class="el" href="mpi_8h_source.html#l00155">MPI_Bcast()</a>, <a class="el" href="mpi_8h_source.html#l00113">MPI_INT</a>, <a class="el" href="mpi_8h_source.html#l00203">MPI_Reduce()</a>, <a class="el" href="mpi_8h_source.html#l00089">MPI_SUM</a>, <a class="el" href="grid_8cpp_source.html#l00067">my_left</a>, <a class="el" href="grid_8cpp_source.html#l00068">my_right</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="communication_8cpp_source.html#l00076">n_nodes</a>, <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="grid_8cpp_source.html#l00054">node_neighbor_lr</a>, <a class="el" href="grid_8cpp_source.html#l00052">node_neighbors</a>, <a class="el" href="grid_8cpp_source.html#l00050">node_pos</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="grid_8hpp_source.html#l00054">PERIODIC</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l00432">realloc_particlelist()</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l01554">recv_particles()</a>, <a class="el" href="config_8hpp_source.html#l00103">ROUND_ERROR_PREC</a>, <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l01510">send_particles()</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, and <a class="el" href="particle__data_8hpp_source.html#l00228">ParticleMomentum::v</a>.</p>

<p>Referenced by <a class="el" href="cells_8cpp_source.html#l00331">cells_resort_particles()</a>.</p>

</div>
</div>
<a class="anchor" id="ac4e8f92e948271c97760592a54327579"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dd_fill_comm_cell_lists </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cells_8hpp.html#ab56e99d3478fae31e65ae78989a2ce89">Cell</a> **&#160;</td>
          <td class="paramname"><em>part_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lc</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hc</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill a communication cell pointer list. </p>
<p>Fill the cell pointers of all cells which are inside a rectangular subgrid of the 3D cell grid (<a class="el" href="structDomainDecomposition.html#abacbb5466ab74ac6b5209adce8de5ec6">DomainDecomposition::ghost_cell_grid</a>) starting from the lower left corner lc up to the high top corner hc. The cell pointer list part_lists must already be large enough. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">part_lists</td><td>List of cell pointers to store the result. </td></tr>
    <tr><td class="paramname">lc</td><td>lower left corner of the subgrid. </td></tr>
    <tr><td class="paramname">hc</td><td>high up corner of the subgrid. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00273">273</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="cells_8cpp_source.html#l00048">cells</a>, <a class="el" href="utils_8hpp_source.html#l00771">get_linear_index()</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00112">DomainDecomposition::ghost_cell_grid</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>.</p>

<p>Referenced by <a class="el" href="domain__decomposition_8cpp_source.html#l00295">dd_prepare_comm()</a>, and <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00340">le_dd_prepare_comm()</a>.</p>

</div>
</div>
<a class="anchor" id="af9ac7edf794cbf704801b22ba706e51a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_on_geometry_change </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>adjust the domain decomposition to a change in the geometry. </p>
<p>Tries to speed up things if possible.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>a combination of <a class="el" href="cells_8hpp.html#a9866a97e62f14804fd381f9b659d802f">CELL_FLAG_FAST</a> and <a class="el" href="cells_8hpp.html#ad02a549fbd34993bad05a5340baf042c">CELL_FLAG_GRIDCHANGED</a>, see documentation of <a class="el" href="cells_8hpp.html#a07480164090da559d8d3903a8dace50a">cells_on_geometry_change</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00697">697</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00100">CELL_FLAG_FAST</a>, <a class="el" href="cells_8hpp_source.html#l00098">CELL_FLAG_GRIDCHANGED</a>, <a class="el" href="cells_8hpp_source.html#l00102">CELL_FLAG_LEES_EDWARDS</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00110">DomainDecomposition::cell_grid</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00115">DomainDecomposition::cell_size</a>, <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00075">CELL_STRUCTURE_CURRENT</a>, <a class="el" href="cells_8hpp_source.html#l00077">CELL_STRUCTURE_DOMDEC</a>, <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="cells_8cpp_source.html#l00176">cells_re_init()</a>, <a class="el" href="cells_8hpp_source.html#l00141">CellStructure::collect_ghost_force_comm</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00441">dd_assign_prefetches()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00458">dd_update_communicators_w_boxl()</a>, <a class="el" href="utils_8hpp_source.html#l00287">dmin()</a>, <a class="el" href="cells_8hpp_source.html#l00137">CellStructure::exchange_ghosts_comm</a>, <a class="el" href="cells_8hpp_source.html#l00135">CellStructure::ghost_cells_comm</a>, <a class="el" href="cells_8hpp_source.html#l00144">CellStructure::ghost_lbcoupling_comm</a>, <a class="el" href="ghosts_8hpp_source.html#l00132">GHOSTTRANS_COUPLING</a>, <a class="el" href="ghosts_8hpp_source.html#l00128">GHOSTTRANS_FORCE</a>, <a class="el" href="ghosts_8hpp_source.html#l00136">GHOSTTRANS_PARTNUM</a>, <a class="el" href="ghosts_8hpp_source.html#l00121">GHOSTTRANS_POSITION</a>, <a class="el" href="ghosts_8hpp_source.html#l00124">GHOSTTRANS_POSSHFTD</a>, <a class="el" href="ghosts_8hpp_source.html#l00119">GHOSTTRANS_PROPRTS</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00117">DomainDecomposition::inv_cell_size</a>, <a class="el" href="lees__edwards__comms__manager_8hpp_source.html#l00038">LE_COMM_BACKWARDS</a>, <a class="el" href="lees__edwards__comms__manager_8hpp_source.html#l00037">LE_COMM_FORWARDS</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00681">le_dd_dynamic_update_comm()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00148">le_dd_update_communicators_w_boxl()</a>, <a class="el" href="grid_8cpp_source.html#l00065">local_box_l</a>, <a class="el" href="interaction__data_8cpp_source.html#l00100">max_cut</a>, <a class="el" href="cells_8cpp_source.html#l00059">max_range</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00061">max_skin</a>, <a class="el" href="initialize_8cpp_source.html#l00423">on_boxl_change()</a>, <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, <a class="el" href="cells_8hpp_source.html#l00139">CellStructure::update_ghost_pos_comm</a>, and <a class="el" href="lees__edwards__comms__manager_8cpp_source.html#l00077">le_dd_comms_manager::update_on_le_offset_change()</a>.</p>

<p>Referenced by <a class="el" href="cells_8cpp_source.html#l00412">cells_on_geometry_change()</a>.</p>

</div>
</div>
<a class="anchor" id="a3eccce6119f1d3d64754c72b674c9009"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cells_8hpp.html#ab56e99d3478fae31e65ae78989a2ce89">Cell</a>* dd_position_to_cell </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pos</em>[3]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implements <a class="el" href="structCellStructure.html#a16ef08fec33ec287fd2fecebb2a4e8a4">CellStructure::position_to_cell</a>. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00614">614</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="domain__decomposition_8hpp_source.html#l00110">DomainDecomposition::cell_grid</a>, <a class="el" href="cells_8cpp_source.html#l00048">cells</a>, <a class="el" href="utils_8hpp_source.html#l00771">get_linear_index()</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00112">DomainDecomposition::ghost_cell_grid</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00117">DomainDecomposition::inv_cell_size</a>, <a class="el" href="grid_8cpp_source.html#l00065">local_box_l</a>, <a class="el" href="grid_8cpp_source.html#l00067">my_left</a>, <a class="el" href="grid_8hpp_source.html#l00054">PERIODIC</a>, <a class="el" href="config_8hpp_source.html#l00103">ROUND_ERROR_PREC</a>, and <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>.</p>

<p>Referenced by <a class="el" href="domain__decomposition_8cpp_source.html#l00794">dd_topology_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a32300628195f95ee2dbaf021f4e501eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cells_8hpp.html#ab56e99d3478fae31e65ae78989a2ce89">Cell</a>* dd_save_position_to_cell </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>pos</em>[3]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns pointer to the cell which corresponds to the position if the position is in the nodes spatial domain otherwise a NULL pointer. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00581">581</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="grid_8cpp_source.html#l00059">boundary</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00110">DomainDecomposition::cell_grid</a>, <a class="el" href="cells_8cpp_source.html#l00048">cells</a>, <a class="el" href="utils_8hpp_source.html#l00771">get_linear_index()</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00112">DomainDecomposition::ghost_cell_grid</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00117">DomainDecomposition::inv_cell_size</a>, <a class="el" href="grid_8cpp_source.html#l00065">local_box_l</a>, <a class="el" href="grid_8cpp_source.html#l00067">my_left</a>, <a class="el" href="grid_8hpp_source.html#l00054">PERIODIC</a>, and <a class="el" href="config_8hpp_source.html#l00103">ROUND_ERROR_PREC</a>.</p>

<p>Referenced by <a class="el" href="domain__decomposition_8cpp_source.html#l00918">dd_exchange_and_sort_particles()</a>, and <a class="el" href="domain__decomposition_8cpp_source.html#l00794">dd_topology_init()</a>.</p>

</div>
</div>
<a class="anchor" id="acf1f9909d24bed0309435417f3b834d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_topology_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCellPList.html">CellPList</a> *&#160;</td>
          <td class="paramname"><em>cl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the topology. </p>
<p>The argument is a list of cell pointers, containing particles that have to be sorted into new cells. The particles might not belong to this node. This procedure is used when particle data or cell structure has changed and the cell structure has to be reinitialized. This also includes setting up the cell_structure array. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cl</td><td>List of cell pointers with particles to be stored in the new cell system. </td></tr>
  </table>
  </dd>
</dl>
<p>broadcast the flag for using verlet list </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00794">794</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="core_2particle__data_8cpp_source.html#l00477">append_unindexed_particle()</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00077">CELL_STRUCTURE_DOMDEC</a>, <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="cells_8hpp_source.html#l00141">CellStructure::collect_ghost_force_comm</a>, <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00441">dd_assign_prefetches()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00118">dd_create_cell_grid()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00504">dd_init_cell_interactions()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00245">dd_mark_cells()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00614">dd_position_to_cell()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00295">dd_prepare_comm()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00411">dd_revert_comm_order()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00581">dd_save_position_to_cell()</a>, <a class="el" href="cells_8hpp_source.html#l00137">CellStructure::exchange_ghosts_comm</a>, <a class="el" href="cells_8hpp_source.html#l00135">CellStructure::ghost_cells_comm</a>, <a class="el" href="cells_8hpp_source.html#l00144">CellStructure::ghost_lbcoupling_comm</a>, <a class="el" href="cells_8hpp_source.html#l00148">CellStructure::ghost_swimming_comm</a>, <a class="el" href="ghosts_8hpp_source.html#l00132">GHOSTTRANS_COUPLING</a>, <a class="el" href="ghosts_8hpp_source.html#l00128">GHOSTTRANS_FORCE</a>, <a class="el" href="ghosts_8hpp_source.html#l00136">GHOSTTRANS_PARTNUM</a>, <a class="el" href="ghosts_8hpp_source.html#l00121">GHOSTTRANS_POSITION</a>, <a class="el" href="ghosts_8hpp_source.html#l00124">GHOSTTRANS_POSSHFTD</a>, <a class="el" href="ghosts_8hpp_source.html#l00119">GHOSTTRANS_PROPRTS</a>, <a class="el" href="ghosts_8hpp_source.html#l00140">GHOSTTRANS_SWIMMING</a>, <a class="el" href="cells_8hpp_source.html#l00151">CellStructure::ibm_ghost_force_comm</a>, <a class="el" href="lees__edwards__comms__manager_8cpp_source.html#l00047">le_dd_comms_manager::init()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00053">le_dd_init_cell_interactions()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00340">le_dd_prepare_comm()</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="grid_8cpp_source.html#l00083">map_position_node_array()</a>, <a class="el" href="mpi_8h_source.html#l00155">MPI_Bcast()</a>, <a class="el" href="mpi_8h_source.html#l00113">MPI_INT</a>, <a class="el" href="grid_8cpp_source.html#l00055">my_neighbor_count</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="cells_8hpp_source.html#l00165">CellStructure::position_to_cell</a>, <a class="el" href="cells_8hpp_source.html#l00159">CellStructure::position_to_node</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, <a class="el" href="cells_8hpp_source.html#l00132">CellStructure::type</a>, <a class="el" href="cells_8hpp_source.html#l00139">CellStructure::update_ghost_pos_comm</a>, <a class="el" href="core_2particle__data_8cpp_source.html#l00457">update_local_particles()</a>, and <a class="el" href="domain__decomposition_8hpp_source.html#l00108">DomainDecomposition::use_vList</a>.</p>

<p>Referenced by <a class="el" href="initialize_8cpp_source.html#l00082">on_program_start()</a>, and <a class="el" href="cells_8cpp_source.html#l00146">topology_init()</a>.</p>

</div>
</div>
<a class="anchor" id="aa54d98068056011155d9fa519d44b2f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dd_topology_release </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called when the current cell structure is invalidated because for example the box length has changed. </p>
<p>This procedure may NOT destroy the old inner and ghost cells, but it should free all other organizational data. Note that parameters like the box length or the node_grid may already have changed. Therefore organizational data has to be stored independently from variables that may be changed from outside. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00888">888</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>References <a class="el" href="domain__decomposition_8hpp_source.html#l00119">DomainDecomposition::cell_inter</a>, <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="debug_8hpp_source.html#l00112">CELL_TRACE</a>, <a class="el" href="cells_8hpp_source.html#l00141">CellStructure::collect_ghost_force_comm</a>, <a class="el" href="cells_8hpp_source.html#l00137">CellStructure::exchange_ghosts_comm</a>, <a class="el" href="ghosts_8cpp_source.html#l00085">free_comm()</a>, <a class="el" href="verlet_8cpp_source.html#l00088">free_pairList()</a>, <a class="el" href="cells_8cpp_source.html#l00054">ghost_cells</a>, <a class="el" href="cells_8hpp_source.html#l00135">CellStructure::ghost_cells_comm</a>, <a class="el" href="cells_8hpp_source.html#l00144">CellStructure::ghost_lbcoupling_comm</a>, <a class="el" href="cells_8hpp_source.html#l00148">CellStructure::ghost_swimming_comm</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8hpp_source.html#l00151">CellStructure::ibm_ghost_force_comm</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00100">IA_Neighbor_List::n_neighbors</a>, <a class="el" href="domain__decomposition_8hpp_source.html#l00102">IA_Neighbor_List::nList</a>, <a class="el" href="debug_8hpp_source.html#l00039">realloc</a>, <a class="el" href="cells_8hpp_source.html#l00222">realloc_cellplist()</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, <a class="el" href="cells_8hpp_source.html#l00139">CellStructure::update_ghost_pos_comm</a>, and <a class="el" href="domain__decomposition_8hpp_source.html#l00072">IA_Neighbor::vList</a>.</p>

<p>Referenced by <a class="el" href="cells_8cpp_source.html#l00122">topology_release()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a3d049536fb2ac4c226a769ab2a975f07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDomainDecomposition.html">DomainDecomposition</a> dd</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Information about the domain decomposition. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00057">57</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

<p>Referenced by <a class="el" href="statistics_8cpp_source.html#l00125">aggregation()</a>, <a class="el" href="verlet_8cpp_source.html#l00095">build_verlet_lists()</a>, <a class="el" href="verlet_8cpp_source.html#l00213">build_verlet_lists_and_calc_verlet_ia()</a>, <a class="el" href="iccp3m_8cpp_source.html#l00336">build_verlet_lists_and_calc_verlet_ia_iccp3m()</a>, <a class="el" href="iccp3m_8cpp_source.html#l00436">calc_link_cell_iccp3m()</a>, <a class="el" href="verlet_8cpp_source.html#l00313">calculate_verlet_energies()</a>, <a class="el" href="verlet_8cpp_source.html#l00165">calculate_verlet_ia()</a>, <a class="el" href="iccp3m_8cpp_source.html#l00409">calculate_verlet_ia_iccp3m()</a>, <a class="el" href="verlet_8cpp_source.html#l00362">calculate_verlet_virials()</a>, <a class="el" href="ghosts_8cpp_source.html#l00424">cell_cell_transfer()</a>, <a class="el" href="cells_8cpp_source.html#l00461">cells_update_ghosts()</a>, <a class="el" href="energy_8cpp_source.html#l00102">energy_calc()</a>, <a class="el" href="polynom_8hpp_source.html#l00047">evaluateAsChebychevSeriesAt()</a>, <a class="el" href="forces__inline_8hpp_source.html#l00205">force_calc()</a>, <a class="el" href="iccp3m_8cpp_source.html#l00245">force_calc_iccp3m()</a>, <a class="el" href="reaction_8cpp_source.html#l00089">integrate_reaction()</a>, <a class="el" href="lb_8cpp_source.html#l01705">lb_sanity_checks()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00681">le_dd_dynamic_update_comm()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00053">le_dd_init_cell_interactions()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00340">le_dd_prepare_comm()</a>, <a class="el" href="pressure_8cpp_source.html#l00910">local_stress_tensor_calc()</a>, <a class="el" href="maggs_8cpp_source.html#l00403">maggs_sanity_checks()</a>, <a class="el" href="pressure_8cpp_source.html#l00083">pressure_calc()</a>, <a class="el" href="lees__edwards__domain__decomposition_8cpp_source.html#l00199">printAllComms()</a>, <a class="el" href="ghosts_8cpp_source.html#l00285">put_recv_buffer()</a>, <a class="el" href="reaction_8cpp_source.html#l00037">reactions_sanity_checks()</a>, <a class="el" href="cells__tcl_8cpp_source.html#l00042">tclcommand_cellsystem()</a>, <a class="el" href="lees__edwards__comms__manager_8cpp_source.html#l00077">le_dd_comms_manager::update_on_le_offset_change()</a>, and <a class="el" href="lees__edwards__comms__manager_8cpp_source.html#l00116">le_dd_comms_manager::wrap_fill_comm_cell_lists()</a>.</p>

</div>
</div>
<a class="anchor" id="aec7cd0f14b18a8eaf1b738e493cc7cb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int max_num_cells</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximal number of cells per node. </p>
<p>In order to avoid memory problems due to the cell grid one has to specify the maximal number of <a class="el" href="cells_8hpp.html#a4b2f78a0197c8d34d405912888acfe7c">cells::cells</a> . The corresponding callback function is <a class="el" href="domain__decomposition__tcl_8hpp.html#abfd5873b6610116d5deea3f95b1ba0c1">tclcallback_max_num_cells</a>. If the number of cells <a class="el" href="cells_8hpp.html#a7c0ae149169f30e421fd5ff657cbecbe">n_cells</a>, is larger than max_num_cells the cell grid is reduced. max_num_cells has to be larger than 27, e.g one inner cell. max_num_cells is initialized with the default value specified in <a class="el" href="config_8hpp.html">config.hpp</a> as <a class="el" href="config_8hpp.html#a6490be0eb5a9c33cfe7326874c996f20">CELLS_MAX_NUM_CELLS</a>. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00059">59</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aee68a321ae0f7079fdf80670e16e303d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double max_skin</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximal skin size. </p>
<p>This is a global variable wwhich can be read out by the user via the TCL command setmd in order to optimize the cell grid </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00061">61</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acfea52e26b6262bf2b71f94e50c21975"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int min_num_cells</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimal number of cells per node. </p>
<p>This is mainly to avoid excessively large numbers of particles per cell, which will result in really large Verlet lists and eventually crash Espresso. </p>

<p>Definition at line <a class="el" href="domain__decomposition_8cpp_source.html#l00060">60</a> of file <a class="el" href="domain__decomposition_8cpp_source.html">domain_decomposition.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="domain__decomposition_8hpp.html">domain_decomposition.hpp</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:41 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
