<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: ibm_triel.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ibm__triel_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">ibm_triel.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ibm__triel_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8hpp.html">config.hpp</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifdef IMMERSED_BOUNDARY</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="particle__data_8hpp.html">particle_data.hpp</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="interaction__data_8hpp.html">interaction_data.hpp</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="grid_8hpp.html">grid.hpp</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="communication_8hpp.html">communication.hpp</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ibm__triel_8hpp.html">immersed_boundary/ibm_triel.hpp</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// Internal function</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keywordtype">void</span> <a class="code" href="ibm__triel_8cpp.html#ab3d824b50e6bd7cccdc37d9be8c8c2b1">RotateForces</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> f1_rot[2], <span class="keyword">const</span> <span class="keywordtype">double</span> f2_rot[2], <span class="keywordtype">double</span> f1[3], <span class="keywordtype">double</span> f2[3], <span class="keywordtype">double</span> v12[3], <span class="keywordtype">double</span> v13[3]);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/*************</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   IBM_Triel_CalcForce</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">Calculate the repulsion and add it to the particle</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> **************/</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="ibm__triel_8hpp.html#a3f5d1ad98e4c38541c3dcec152b7e1d4">   20</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="ibm__triel_8cpp.html#a3f5d1ad98e4c38541c3dcec152b7e1d4">IBM_Triel_CalcForce</a>(<a class="code" href="structParticle.html">Particle</a> *p1,<a class="code" href="structParticle.html">Particle</a> *p2, <a class="code" href="structParticle.html">Particle</a> *p3, <a class="code" href="structBonded__ia__parameters.html">Bonded_ia_parameters</a> *iaparams)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">// Calculate the current shape of the triangle (l,lp,cos(phi),sin(phi));</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">// l = length between 1 and 3</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="comment">// get_mi_vector is an Espresso function which considers PBC</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">double</span> vec2[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(vec2, p3-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> l = sqrt (<a class="code" href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a>(vec2));</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">// lp = lenght between 1 and 2</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordtype">double</span> vec1[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(vec1, p2-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> lp = sqrt (<a class="code" href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a>(vec1));</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// angles between these vectors; calculated directly via the products</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cosPhi = <a class="code" href="utils_8hpp.html#a90ccb5e50581bbbbf40733366d387719">scalar</a>(vec1,vec2)/(lp*l);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">double</span> vecpro[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="utils_8hpp.html#a5de5cdcc6fb6fcb456100aca88e5809e">vector_product</a>(vec1, vec2, vecpro);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> sinPhi = sqrt(<a class="code" href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a>(vecpro))/(l*lp);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// Check for sanity</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span>(    (lp-iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a2ca33014402c39b941c2cccc2aad3ab1">lp0</a> &gt; iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a094dd5557c8c30f43ca66480f0722cc7">maxdist</a>)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;     ||  (l-iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a7bcc5afdfd92071062f498c6c4284315">l0</a> &gt; iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a094dd5557c8c30f43ca66480f0722cc7">maxdist</a>))</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// Variables in the reference state</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> l0 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a7bcc5afdfd92071062f498c6c4284315">l0</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> lp0 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a2ca33014402c39b941c2cccc2aad3ab1">lp0</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cosPhi0 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#ac4c44dd308ae90478a2667d389c219f7">cosPhi0</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> sinPhi0 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a7b27e19eb96a41f9d203af0449f55328">sinPhi0</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a1 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#ac7a4a3962f768f3ba897eedb4e634a89">a1</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a2 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aeadecb6b78193d391b3153802b9d601d">a2</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b1 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aebb08f745351b02633abea0d0b5347b7">b1</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b2 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afa5a71f758fea216c414afff5fa4c972">b2</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> A0 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a74f5132a5c2a4703ac9b863ab8cba456">area0</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">// Displacement gradient tensor D: Eq. (C.9) Krüger thesis</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Dxx = lp/lp0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Dxy = ((l/l0*cosPhi) - (lp/lp0*cosPhi0)) / sinPhi0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Dyx = 0.0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Dyy = l/l0*sinPhi / sinPhi0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// Tensor G: (C.12)</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Gxx = <a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(Dxx)+<a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(Dyx);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Gxy = Dxx*Dxy + Dyx*Dyy;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Gyx = Dxx*Dxy + Dyy*Dyx;   <span class="comment">// = Gxy because of symmetry</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> Gyy = <a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(Dxy) + <a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(Dyy);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// Strain invariants, C.11 and C.12</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> i1 = (Gxx + Gyy) - 2;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> i2 = ((Gxx * Gyy) - (Gxy * Gyx)) - 1;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// Derivatives of energy density E used in chain rule below: Eq. (C.14)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">double</span> dEdI1;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">double</span> dEdI2;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> ( iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a14e7c7301c79859c2c96343e404eb138">elasticLaw</a> == <a class="code" href="interaction__data_8hpp.html#ab5d405da34ec641ed15bb99749a6a368a5d92573ba9b42c4665773f00d1f23716">NeoHookean</a> )</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// Neo-Hookean</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    dEdI1 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afc3203db443a97f5932b99b03e139a13">k1</a>/6.0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    dEdI2 = (-1)*iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afc3203db443a97f5932b99b03e139a13">k1</a>/(6.0*(i2+1.0)*(i2+1.0));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">//Skalak</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    dEdI1 = iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afc3203db443a97f5932b99b03e139a13">k1</a>*(i1+1)/6.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    dEdI2 = (-1)*iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afc3203db443a97f5932b99b03e139a13">k1</a>/6.0 + iaparams-&gt;<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aff0b0c6347e448f01137e996764cb3fb">k2</a>*i2/6.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">// ******** Achim&#39;s version *****************</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// Derivatives of Is (C.15)</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI1dGxx = 1;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI1dGxy = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI1dGyx = 0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI1dGyy = 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI2dGxx = Gyy;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI2dGxy = -Gyx; <span class="comment">// Note: Krueger has a factor 2 here, because he uses the symmetry of the G-matrix.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI2dGyx = -Gxy; <span class="comment">//                       But we don&#39;t use it. So, Krueger is missing the yx term, whereas we have it.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dI2dGyy = Gxx;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// Derivatives of G (C.16)</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxxdV1x = 2*a1*Dxx;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxxdV1y = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxxdV2x = 2*a2*Dxx;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxxdV2y = 0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxydV1x = a1*Dxy + b1*Dxx;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxydV1y = a1*Dyy;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxydV2x = a2*Dxy + b2*Dxx;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGxydV2y = a2*Dyy;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyxdV1x = a1*Dxy + b1*Dxx;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyxdV1y = a1*Dyy;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyxdV2x = a2*Dxy + b2*Dxx;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyxdV2y = a2*Dyy;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyydV1x = 2*b1*Dxy;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyydV1y = 2*b1*Dyy;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyydV2x = 2*b2*Dxy;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dGyydV2y = 2*b2*Dyy;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// Calculate forces per area in rotated system: chain rule as in appendix C of Krüger (chain rule applied in eq. (C.13), but for the energy density).</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// Only two nodes are needed, third one is calcualted from momentum conservation</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// Note: If you calculate the derivatives in a straightforward manner, you get 8 terms (done here). Krueger exploits the symmetry of the G-matrix,</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">//            which results in 6 elements, but with an additional factor 2 for the xy-elements (see also above at the definition of dI2dGxy).</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordtype">double</span> f1_rot[2] = {0., 0.};</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordtype">double</span> f2_rot[2] = {0., 0.};</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  f1_rot[0] = - (dEdI1 * dI1dGxx * dGxxdV1x) - (dEdI1 * dI1dGxy * dGxydV1x) - (dEdI1 * dI1dGyx * dGyxdV1x) - (dEdI1 * dI1dGyy * dGyydV1x)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  - (dEdI2 * dI2dGxx * dGxxdV1x) - (dEdI2 * dI2dGxy * dGxydV1x) - (dEdI2 * dI2dGyx * dGyxdV1x) - (dEdI2 * dI2dGyy * dGyydV1x);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  f1_rot[1] = - (dEdI1 * dI1dGxx * dGxxdV1y) - (dEdI1 * dI1dGxy * dGxydV1y) - (dEdI1 * dI1dGyx * dGyxdV1y) - (dEdI1 * dI1dGyy * dGyydV1y)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  - (dEdI2 * dI2dGxx * dGxxdV1y) - (dEdI2 * dI2dGxy * dGxydV1y) - (dEdI2 * dI2dGyx * dGyxdV1y) - (dEdI2 * dI2dGyy * dGyydV1y);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  f2_rot[0] = - (dEdI1 * dI1dGxx * dGxxdV2x) - (dEdI1 * dI1dGxy * dGxydV2x) - (dEdI1 * dI1dGyx * dGyxdV2x) - (dEdI1 * dI1dGyy * dGyydV2x)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  - (dEdI2 * dI2dGxx * dGxxdV2x) - (dEdI2 * dI2dGxy * dGxydV2x) - (dEdI2 * dI2dGyx * dGyxdV2x) - (dEdI2 * dI2dGyy * dGyydV2x);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  f2_rot[1] = - (dEdI1 * dI1dGxx * dGxxdV2y) - (dEdI1 * dI1dGxy * dGxydV2y) - (dEdI1 * dI1dGyx * dGyxdV2y) - (dEdI1 * dI1dGyy * dGyydV2y)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  - (dEdI2 * dI2dGxx * dGxxdV2y) - (dEdI2 * dI2dGxy * dGxydV2y) - (dEdI2 * dI2dGyx * dGyxdV2y) - (dEdI2 * dI2dGyy * dGyydV2y);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Multiply by undeformed area</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  f1_rot[0] *= A0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  f1_rot[1] *= A0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  f2_rot[0] *= A0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  f2_rot[1] *= A0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// ****************** Wolfgang&#39;s version ***********</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; <span class="comment">/*</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">  // Left here for checking, but should be identical to the version above</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">  const double i11 = 1.0;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">  const double i12 = 1.0;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">  const double i21 = Gyy;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">  const double i22 = -Gyx;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">  const double i23 = i22;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">  const double i24 = Gxx;</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  //For sake of better readability shorten the call for the triangle&#39;s constants:</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">  A0 = iaparams-&gt;p.stretching_force_ibm.Area0;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">  a1 = iaparams-&gt;p.stretching_force_ibm.a1;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">  a2 = iaparams-&gt;p.stretching_force_ibm.a2;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">  b1 = iaparams-&gt;p.stretching_force_ibm.b1;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">  b2 = iaparams-&gt;p.stretching_force_ibm.b2;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">  f1_rot[0] = A0*((-1)*e1*((i11*2*a1*dxx)+(i12*2*b1*dxy))+ (-1)*e2*((i21*2*a1*dxx)+(i22*(a1*dxy+b1*dxx))+(i23*(a1*dxy+b1*dxx))+(i24*2*b1*dxy)));</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">  f1_rot[1] = A0*((-1)*e1*((i11*0.0)+(i12*2*b1*dyy))+ (-1)*e2*((i21*0.0)+(i22*a1*dyy)+(i23*a1*dyy)+(i24*2*b1*dyy)));</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">  f2_rot[0] = A0*((-1)*e1*((i11*2*a2*dxx)+(i12*2*b2*dxy))+ (-1)*e2*((i21*2*a2*dxx)+(i22*(a2*dxy+b2*dxx))+(i23*(a2*dxy+b2*dxx))+(i24*2*b2*dxy)));</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">  f2_rot[1] = A0*((-1)*e1*((i11*0.0)+(i12*2*b2*dyy))+ (-1)*e2*((i21*0.0)+(i22*a2*dyy)+(i23*a2*dyy)+(i24*2*b2*dyy)));</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// Rotate forces back into original position of triangle</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">double</span> force1[3] = {0,0,0};</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">double</span> force2[3] = {0,0,0};</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="ibm__triel_8cpp.html#ab3d824b50e6bd7cccdc37d9be8c8c2b1">RotateForces</a>(f1_rot,f2_rot, force1,force2, vec1, vec2);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// Calculate f3 from equilibrium and add</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    p1-&gt;<a class="code" href="structParticle.html#aac8a0eeef67af8ae707f56de87de08e6">f</a>.<a class="code" href="structParticleForce.html#a196495c0b11ee16acfd25a7efde6e465">f</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += force1[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    p2-&gt;<a class="code" href="structParticle.html#aac8a0eeef67af8ae707f56de87de08e6">f</a>.<a class="code" href="structParticleForce.html#a196495c0b11ee16acfd25a7efde6e465">f</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += force2[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    p3-&gt;<a class="code" href="structParticle.html#aac8a0eeef67af8ae707f56de87de08e6">f</a>.<a class="code" href="structParticleForce.html#a196495c0b11ee16acfd25a7efde6e465">f</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += -force1[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - force2[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/****************</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">  IBM_Triel_ResetParams</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> *****************/</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="ibm__triel_8hpp.html#a1c359dcc25234fdc2da4b1216153612e">  194</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="ibm__triel_8cpp.html#a1c359dcc25234fdc2da4b1216153612e">IBM_Triel_ResetParams</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> bond_type, <span class="keyword">const</span> <span class="keywordtype">double</span> k1, <span class="keyword">const</span> <span class="keywordtype">double</span> l0)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;{</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// Check if bond exists and is of correct type</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">if</span> ( bond_type &gt;= <a class="code" href="interaction__data_8cpp.html#aae05a6fe1a1afecdedd013c330e42d56">n_bonded_ia</a> ) { printf(<span class="stringliteral">&quot;bond does not exist while reading triel checkpoint\n&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a>; }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].type != <a class="code" href="interaction__data_8hpp.html#adb890a9ae4ae4a81d76d603fd739a0bfaf99a96176d729592b54d1a8c215d2900">BONDED_IA_IBM_TRIEL</a> ) { printf(<span class="stringliteral">&quot;interaction type does not match while reading triel checkpoint!\n&quot;</span>);<span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a>; }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">// Check if k1 is correct</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span> ( fabs( <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].p.ibm_triel.k1 - k1) &gt; 1e-9 ) { printf(<span class="stringliteral">&quot;k1 does not match while reading triel checkpoint!\n&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a>; }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Check if l0 is correct</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span> ( fabs( <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].p.ibm_triel.l0 - l0) &gt; 1e-9 ) { printf(<span class="stringliteral">&quot;l0 does not match while reading triel checkpoint!\n&quot;</span>); <span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a>; }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">// Compute cache values a1, a2, b1, b2</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> area0 = <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a74f5132a5c2a4703ac9b863ab8cba456">area0</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> lp0 = <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a2ca33014402c39b941c2cccc2aad3ab1">lp0</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> sinPhi0 = <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a7b27e19eb96a41f9d203af0449f55328">sinPhi0</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cosPhi0 = <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#ac4c44dd308ae90478a2667d389c219f7">cosPhi0</a>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> area2 = 2.0 * area0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a1 = -(l0*sinPhi0)/area2;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a2 = - a1;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b1 = (l0*cosPhi0 - lp0)/area2;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b2 = -(l0*cosPhi0)/area2;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// Hand these values over to parameter structure</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#ac7a4a3962f768f3ba897eedb4e634a89">a1</a> = a1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aeadecb6b78193d391b3153802b9d601d">a2</a> = a2;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aebb08f745351b02633abea0d0b5347b7">b1</a> = b1;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afa5a71f758fea216c414afff5fa4c972">b2</a> = b2;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">//Communicate this to whoever is interested</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="communication_8cpp.html#a43222bf32059b4969c1a3d779c660171">mpi_bcast_ia_params</a>(bond_type, -1);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a37474faad5e05ca5d6c2464f2f4aa27d">ES_OK</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/***********</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">   IBM_Triel_SetParams</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">************/</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="ibm__triel_8hpp.html#a7e638037bd387ef8746cea67f87ea934">  235</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="ibm__triel_8cpp.html#a7e638037bd387ef8746cea67f87ea934">IBM_Triel_SetParams</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> bond_type, <span class="keyword">const</span> <span class="keywordtype">int</span> ind1, <span class="keyword">const</span> <span class="keywordtype">int</span> ind2, <span class="keyword">const</span> <span class="keywordtype">int</span> ind3, <span class="keyword">const</span> <span class="keywordtype">double</span> max, <span class="keyword">const</span> <a class="code" href="interaction__data_8hpp.html#ab5d405da34ec641ed15bb99749a6a368">tElasticLaw</a> elasticLaw, <span class="keyword">const</span> <span class="keywordtype">double</span> k1, <span class="keyword">const</span> <span class="keywordtype">double</span> k2)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="comment">// Create bond</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a6909946dc6a462b1da523a8b2fa525a1">make_bond_type_exist</a>(bond_type);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">//Get data (especially location) of three particles</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="structParticle.html">Particle</a> part1, part2, part3;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="core_2particle__data_8cpp.html#a71312b94465020e032771804e4bd1283">get_particle_data</a>(ind1,&amp;part1);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="core_2particle__data_8cpp.html#a71312b94465020e032771804e4bd1283">get_particle_data</a>(ind2,&amp;part2);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="core_2particle__data_8cpp.html#a71312b94465020e032771804e4bd1283">get_particle_data</a>(ind3,&amp;part3);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// Calculate equilibrium lenghts and angle; Note the sequence of the points!</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// lo = lenght between 1 and 3</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordtype">double</span> templo[3];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(templo, part3.<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, part1.<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> l0 = sqrt (<a class="code" href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a>(templo));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// lpo = lenght between 1 and 2</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordtype">double</span> templpo[3];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(templpo, part2.<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, part1.<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> lp0 = sqrt (<a class="code" href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a>(templpo));</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// cospo / sinpo angle functions between these vectors; calculated directly via the products</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> cosPhi0 = <a class="code" href="utils_8hpp.html#a90ccb5e50581bbbbf40733366d387719">scalar</a>(templo,templpo)/(l0*lp0);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">double</span> vecpro[3];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="utils_8hpp.html#a5de5cdcc6fb6fcb456100aca88e5809e">vector_product</a>(templo, templpo, vecpro);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> sinPhi0 = sqrt(<a class="code" href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a>(vecpro))/(l0*lp0);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">// Use the values determined above for further constants of the stretch-force calculation</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> area2 = l0 * lp0 * sinPhi0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a1 = -(l0*sinPhi0)/area2;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> a2 = - a1;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b1 = (l0*cosPhi0 - lp0)/area2;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> b2 = -(l0*cosPhi0)/area2;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// General stuff</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#a87b9b6608f3191fa29cc0d53517dac9a">type</a> = <a class="code" href="interaction__data_8hpp.html#adb890a9ae4ae4a81d76d603fd739a0bfaf99a96176d729592b54d1a8c215d2900">BONDED_IA_IBM_TRIEL</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#aa37e9af030e3b31ce239ef83641cf4d3">num</a> = 2;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Specific stuff</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#ac7a4a3962f768f3ba897eedb4e634a89">a1</a> = a1;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aeadecb6b78193d391b3153802b9d601d">a2</a> = a2;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aebb08f745351b02633abea0d0b5347b7">b1</a> = b1;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afa5a71f758fea216c414afff5fa4c972">b2</a> = b2;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a7bcc5afdfd92071062f498c6c4284315">l0</a> = l0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a2ca33014402c39b941c2cccc2aad3ab1">lp0</a> = lp0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a7b27e19eb96a41f9d203af0449f55328">sinPhi0</a> = sinPhi0;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#ac4c44dd308ae90478a2667d389c219f7">cosPhi0</a> = cosPhi0;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a74f5132a5c2a4703ac9b863ab8cba456">area0</a> = 0.5*area2;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a094dd5557c8c30f43ca66480f0722cc7">maxdist</a> = max;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#a14e7c7301c79859c2c96343e404eb138">elasticLaw</a> = elasticLaw;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// Always store two constants, for NeoHookean only k1 is used</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#afc3203db443a97f5932b99b03e139a13">k1</a> = k1;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[bond_type].<a class="code" href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">p</a>.<a class="code" href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">ibm_triel</a>.<a class="code" href="structIBM__Triel__Parameters.html#aff0b0c6347e448f01137e996764cb3fb">k2</a> = k2;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">//Communicate this to whoever is interested</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="communication_8cpp.html#a43222bf32059b4969c1a3d779c660171">mpi_bcast_ia_params</a>(bond_type, -1);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// Free particles&#39;s allocated memory</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// This was in Wolfgang&#39;s code, but probably should not be here since particles are local variables</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">//  free_particle(&amp;part1);</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">//  free_particle(&amp;part2);</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">//  free_particle(&amp;part3);</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a37474faad5e05ca5d6c2464f2f4aa27d">ES_OK</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">/** Rotate calculated trielastic forces in the 2d plane back to the 3d plane</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> *Use knowledge that the x-axis in rotated system is parallel to r(p1-&gt;p2) in original system;</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> *To find the corresponding unit vector to y in the rotated system, construct vector perpendicular to r(p1-&gt;p2);</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> * note that f3 is not calculated here but is implicitly calculated by f3 = -(f1+f2) which is consistent with the literature</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="ibm__triel_8cpp.html#ab3d824b50e6bd7cccdc37d9be8c8c2b1">  306</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="ibm__triel_8cpp.html#ab3d824b50e6bd7cccdc37d9be8c8c2b1">RotateForces</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> f1_rot[2], <span class="keyword">const</span> <span class="keywordtype">double</span> f2_rot[2], <span class="keywordtype">double</span> f1[3], <span class="keywordtype">double</span> f2[3], <span class="keywordtype">double</span> v12[3], <span class="keywordtype">double</span> v13[3])</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// fRot is in the rotated system, i.e. in a system where the side lPrime of the triangle (i.e. v12) is parallel to the x-axis, and the y-axis is perpendicular to the x-axis (cf. Krueger, Fig. 7.1c).</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">//            I.e. fRot[XX] is the component parallel to the x-axis, fRot[YY]] the component parallel to the y-axis.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">// Now, the idea is to get these unit vectors for the x- and y-axis in the real coordinate system. They are named xu and yu below.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">//            The x-component of the force in the real coordinate system is therefore: fRot[XX]*xu</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// xu is simple: The x-axis in the rotated system is parallel to v12 --&gt; xu = v12 (+ normalization)</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">double</span> xu[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="utils_8hpp.html#acaeef773f057c7cb7a8272c586a3c5cd">unit_vector</a>(v12,xu);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// yu needs to be orthogonal to xu, and point in the direction of node 3 in Krueger, Fig. 7.1b. Therefore:</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">//            First get the projection of v13 onto v12: The direction is definied by xu, the length by the scalar product (scalar product can be interpreted as a projection, after all).</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">//                                    --&gt; sca * xu</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">//            Then: v13 - sca * xu gives the component of v13 orthogonal to v12, i..e. perpendicular to the x-axis --&gt; yu</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">//            Last: Normalize yu.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> sca = <a class="code" href="utils_8hpp.html#a90ccb5e50581bbbbf40733366d387719">scalar</a>(v13,xu);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">double</span> y[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 3; <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    y[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = v13[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - (sca * xu[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">double</span> yu[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="utils_8hpp.html#acaeef773f057c7cb7a8272c586a3c5cd">unit_vector</a>(y,yu);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// Calculate forces in 3D</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  f1[0] = (f1_rot[0] * xu[0]) + (f1_rot[1] * yu[0]);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  f1[1] = (f1_rot[0] * xu[1]) + (f1_rot[1] * yu[1]);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  f1[2] = (f1_rot[0] * xu[2]) + (f1_rot[1] * yu[2]);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  f2[0] = (f2_rot[0] * xu[0]) + (f2_rot[1] * yu[0]);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  f2[1] = (f2_rot[0] * xu[1]) + (f2_rot[1] * yu[1]);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  f2[2] = (f2_rot[0] * xu[2]) + (f2_rot[1] * yu[2]);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="structBonded__ia__parameters_html_a87b9b6608f3191fa29cc0d53517dac9a"><div class="ttname"><a href="structBonded__ia__parameters.html#a87b9b6608f3191fa29cc0d53517dac9a">Bonded_ia_parameters::type</a></div><div class="ttdeci">BondedInteraction type</div><div class="ttdoc">bonded interaction type. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00885">interaction_data.hpp:885</a></div></div>
<div class="ttc" id="structParticlePosition_html_a1859189b20ddc6a4f92529e4cfcdc9fb"><div class="ttname"><a href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">ParticlePosition::p</a></div><div class="ttdeci">double p[3]</div><div class="ttdoc">periodically folded position. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00182">particle_data.hpp:182</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_ab5d405da34ec641ed15bb99749a6a368"><div class="ttname"><a href="interaction__data_8hpp.html#ab5d405da34ec641ed15bb99749a6a368">tElasticLaw</a></div><div class="ttdeci">tElasticLaw</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00789">interaction_data.hpp:789</a></div></div>
<div class="ttc" id="utils_8hpp_html_aa52a04b297388c4ff41ee124e2e60a5c"><div class="ttname"><a href="utils_8hpp.html#aa52a04b297388c4ff41ee124e2e60a5c">sqrlen</a></div><div class="ttdeci">double sqrlen(double v[3])</div><div class="ttdoc">calculates the squared length of a vector </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00444">utils.hpp:444</a></div></div>
<div class="ttc" id="structBonded__ia__parameters_html_ab67eb08936d1c37a983d34376e47bcb6"><div class="ttname"><a href="structBonded__ia__parameters.html#ab67eb08936d1c37a983d34376e47bcb6">Bonded_ia_parameters::p</a></div><div class="ttdeci">Bond_parameters p</div><div class="ttdoc">union to store the different bonded interaction parameters. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00889">interaction_data.hpp:889</a></div></div>
<div class="ttc" id="utils_8hpp_html_a5de5cdcc6fb6fcb456100aca88e5809e"><div class="ttname"><a href="utils_8hpp.html#a5de5cdcc6fb6fcb456100aca88e5809e">vector_product</a></div><div class="ttdeci">void vector_product(double a[3], double b[3], double c[3])</div><div class="ttdoc">calculates the vector product c of two vectors a and b </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00474">utils.hpp:474</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_a14e7c7301c79859c2c96343e404eb138"><div class="ttname"><a href="structIBM__Triel__Parameters.html#a14e7c7301c79859c2c96343e404eb138">IBM_Triel_Parameters::elasticLaw</a></div><div class="ttdeci">tElasticLaw elasticLaw</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00810">interaction_data.hpp:810</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_afc3203db443a97f5932b99b03e139a13"><div class="ttname"><a href="structIBM__Triel__Parameters.html#afc3203db443a97f5932b99b03e139a13">IBM_Triel_Parameters::k1</a></div><div class="ttdeci">double k1</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00811">interaction_data.hpp:811</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_aeadecb6b78193d391b3153802b9d601d"><div class="ttname"><a href="structIBM__Triel__Parameters.html#aeadecb6b78193d391b3153802b9d601d">IBM_Triel_Parameters::a2</a></div><div class="ttdeci">double a2</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00802">interaction_data.hpp:802</a></div></div>
<div class="ttc" id="core_2particle__data_8cpp_html_a71312b94465020e032771804e4bd1283"><div class="ttname"><a href="core_2particle__data_8cpp.html#a71312b94465020e032771804e4bd1283">get_particle_data</a></div><div class="ttdeci">int get_particle_data(int part, Particle *data)</div><div class="ttdoc">Get particle data. </div><div class="ttdef"><b>Definition:</b> <a href="core_2particle__data_8cpp_source.html#l00550">core/particle_data.cpp:550</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_ac7a4a3962f768f3ba897eedb4e634a89"><div class="ttname"><a href="structIBM__Triel__Parameters.html#ac7a4a3962f768f3ba897eedb4e634a89">IBM_Triel_Parameters::a1</a></div><div class="ttdeci">double a1</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00801">interaction_data.hpp:801</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_a094dd5557c8c30f43ca66480f0722cc7"><div class="ttname"><a href="structIBM__Triel__Parameters.html#a094dd5557c8c30f43ca66480f0722cc7">IBM_Triel_Parameters::maxdist</a></div><div class="ttdeci">double maxdist</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00809">interaction_data.hpp:809</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_a6909946dc6a462b1da523a8b2fa525a1"><div class="ttname"><a href="interaction__data_8cpp.html#a6909946dc6a462b1da523a8b2fa525a1">make_bond_type_exist</a></div><div class="ttdeci">void make_bond_type_exist(int type)</div><div class="ttdoc">Makes sure that bonded_ia_params is large enough to cover the parameters for the bonded interaction t...</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00808">interaction_data.cpp:808</a></div></div>
<div class="ttc" id="structBonded__ia__parameters_html_aa37e9af030e3b31ce239ef83641cf4d3"><div class="ttname"><a href="structBonded__ia__parameters.html#aa37e9af030e3b31ce239ef83641cf4d3">Bonded_ia_parameters::num</a></div><div class="ttdeci">int num</div><div class="ttdoc">(Number of particles - 1) interacting for that type </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00887">interaction_data.hpp:887</a></div></div>
<div class="ttc" id="lbgpu_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="lbgpu_8cpp_source.html#l00161">lbgpu.cpp:161</a></div></div>
<div class="ttc" id="ibm__triel_8cpp_html_a1c359dcc25234fdc2da4b1216153612e"><div class="ttname"><a href="ibm__triel_8cpp.html#a1c359dcc25234fdc2da4b1216153612e">IBM_Triel_ResetParams</a></div><div class="ttdeci">int IBM_Triel_ResetParams(const int bond_type, const double k1, const double l0)</div><div class="ttdef"><b>Definition:</b> <a href="ibm__triel_8cpp_source.html#l00194">ibm_triel.cpp:194</a></div></div>
<div class="ttc" id="utils_8hpp_html_a008137b55395036613fb97c40e7ba8b5"><div class="ttname"><a href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a></div><div class="ttdeci">double SQR(double x)</div><div class="ttdoc">Calculates the SQuaRe of &#39;double&#39; x, returning &#39;double&#39;. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00346">utils.hpp:346</a></div></div>
<div class="ttc" id="utils_8hpp_html_a90ccb5e50581bbbbf40733366d387719"><div class="ttname"><a href="utils_8hpp.html#a90ccb5e50581bbbbf40733366d387719">scalar</a></div><div class="ttdeci">double scalar(double a[3], double b[3])</div><div class="ttdoc">calculates the scalar product of two vectors a nd b </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00465">utils.hpp:465</a></div></div>
<div class="ttc" id="config_8hpp_html"><div class="ttname"><a href="config_8hpp.html">config.hpp</a></div><div class="ttdoc">This file contains the defaults for Espresso. </div></div>
<div class="ttc" id="structParticle_html_aac8a0eeef67af8ae707f56de87de08e6"><div class="ttname"><a href="structParticle.html#aac8a0eeef67af8ae707f56de87de08e6">Particle::f</a></div><div class="ttdeci">ParticleForce f</div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00293">particle_data.hpp:293</a></div></div>
<div class="ttc" id="ibm__triel_8cpp_html_a7e638037bd387ef8746cea67f87ea934"><div class="ttname"><a href="ibm__triel_8cpp.html#a7e638037bd387ef8746cea67f87ea934">IBM_Triel_SetParams</a></div><div class="ttdeci">int IBM_Triel_SetParams(const int bond_type, const int ind1, const int ind2, const int ind3, const double max, const tElasticLaw elasticLaw, const double k1, const double k2)</div><div class="ttdef"><b>Definition:</b> <a href="ibm__triel_8cpp_source.html#l00235">ibm_triel.cpp:235</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_ac4c44dd308ae90478a2667d389c219f7"><div class="ttname"><a href="structIBM__Triel__Parameters.html#ac4c44dd308ae90478a2667d389c219f7">IBM_Triel_Parameters::cosPhi0</a></div><div class="ttdeci">double cosPhi0</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00797">interaction_data.hpp:797</a></div></div>
<div class="ttc" id="grid_8hpp_html_a2d8075c3dfa4364a1dcb28c4a4835067"><div class="ttname"><a href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a></div><div class="ttdeci">void get_mi_vector(double res[3], double a[3], double b[3])</div><div class="ttdoc">get the minimal distance vector of two vectors in the current bc. </div><div class="ttdef"><b>Definition:</b> <a href="grid_8hpp_source.html#l00190">grid.hpp:190</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_adb890a9ae4ae4a81d76d603fd739a0bfaf99a96176d729592b54d1a8c215d2900"><div class="ttname"><a href="interaction__data_8hpp.html#adb890a9ae4ae4a81d76d603fd739a0bfaf99a96176d729592b54d1a8c215d2900">BONDED_IA_IBM_TRIEL</a></div><div class="ttdoc">Type of bonded interaction is a wall repulsion (immersed boundary). </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00098">interaction_data.hpp:98</a></div></div>
<div class="ttc" id="structBonded__ia__parameters_html"><div class="ttname"><a href="structBonded__ia__parameters.html">Bonded_ia_parameters</a></div><div class="ttdoc">Defines parameters for a bonded interaction. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00883">interaction_data.hpp:883</a></div></div>
<div class="ttc" id="communication_8cpp_html_a43222bf32059b4969c1a3d779c660171"><div class="ttname"><a href="communication_8cpp.html#a43222bf32059b4969c1a3d779c660171">mpi_bcast_ia_params</a></div><div class="ttdeci">void mpi_bcast_ia_params(int i, int j)</div><div class="ttdoc">Issue REQ_BCAST_IA: send new ia params. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l01288">communication.cpp:1288</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_a7bcc5afdfd92071062f498c6c4284315"><div class="ttname"><a href="structIBM__Triel__Parameters.html#a7bcc5afdfd92071062f498c6c4284315">IBM_Triel_Parameters::l0</a></div><div class="ttdeci">double l0</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00794">interaction_data.hpp:794</a></div></div>
<div class="ttc" id="structParticle_html"><div class="ttname"><a href="structParticle.html">Particle</a></div><div class="ttdoc">Struct holding all information for one particle. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00285">particle_data.hpp:285</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_aebb08f745351b02633abea0d0b5347b7"><div class="ttname"><a href="structIBM__Triel__Parameters.html#aebb08f745351b02633abea0d0b5347b7">IBM_Triel_Parameters::b1</a></div><div class="ttdeci">double b1</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00803">interaction_data.hpp:803</a></div></div>
<div class="ttc" id="ibm__triel_8cpp_html_a3f5d1ad98e4c38541c3dcec152b7e1d4"><div class="ttname"><a href="ibm__triel_8cpp.html#a3f5d1ad98e4c38541c3dcec152b7e1d4">IBM_Triel_CalcForce</a></div><div class="ttdeci">int IBM_Triel_CalcForce(Particle *p1, Particle *p2, Particle *p3, Bonded_ia_parameters *iaparams)</div><div class="ttdef"><b>Definition:</b> <a href="ibm__triel_8cpp_source.html#l00020">ibm_triel.cpp:20</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_ab5d405da34ec641ed15bb99749a6a368a5d92573ba9b42c4665773f00d1f23716"><div class="ttname"><a href="interaction__data_8hpp.html#ab5d405da34ec641ed15bb99749a6a368a5d92573ba9b42c4665773f00d1f23716">NeoHookean</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00789">interaction_data.hpp:789</a></div></div>
<div class="ttc" id="grid_8hpp_html"><div class="ttname"><a href="grid_8hpp.html">grid.hpp</a></div><div class="ttdoc">Domain decomposition for parallel computing. </div></div>
<div class="ttc" id="interaction__data_8cpp_html_a45b6a7c36597d364e43177dada980db2"><div class="ttname"><a href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a></div><div class="ttdeci">Bonded_ia_parameters * bonded_ia_params</div><div class="ttdoc">Field containing the paramters of the bonded ia types. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00096">interaction_data.cpp:96</a></div></div>
<div class="ttc" id="ibm__triel_8hpp_html"><div class="ttname"><a href="ibm__triel_8hpp.html">ibm_triel.hpp</a></div></div>
<div class="ttc" id="particle__data_8hpp_html"><div class="ttname"><a href="particle__data_8hpp.html">particle_data.hpp</a></div><div class="ttdoc">For more information on particle_data, see particle_data.c. </div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_a2ca33014402c39b941c2cccc2aad3ab1"><div class="ttname"><a href="structIBM__Triel__Parameters.html#a2ca33014402c39b941c2cccc2aad3ab1">IBM_Triel_Parameters::lp0</a></div><div class="ttdeci">double lp0</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00795">interaction_data.hpp:795</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_afa5a71f758fea216c414afff5fa4c972"><div class="ttname"><a href="structIBM__Triel__Parameters.html#afa5a71f758fea216c414afff5fa4c972">IBM_Triel_Parameters::b2</a></div><div class="ttdeci">double b2</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00804">interaction_data.hpp:804</a></div></div>
<div class="ttc" id="structParticle_html_aeb172f49293421e3d0f03277453e320b"><div class="ttname"><a href="structParticle.html#aeb172f49293421e3d0f03277453e320b">Particle::r</a></div><div class="ttdeci">ParticlePosition r</div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00289">particle_data.hpp:289</a></div></div>
<div class="ttc" id="unionBond__parameters_html_ad2bae63d27f39112bef152fe0565e341"><div class="ttname"><a href="unionBond__parameters.html#ad2bae63d27f39112bef152fe0565e341">Bond_parameters::ibm_triel</a></div><div class="ttdeci">IBM_Triel_Parameters ibm_triel</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00877">interaction_data.hpp:877</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_a7b27e19eb96a41f9d203af0449f55328"><div class="ttname"><a href="structIBM__Triel__Parameters.html#a7b27e19eb96a41f9d203af0449f55328">IBM_Triel_Parameters::sinPhi0</a></div><div class="ttdeci">double sinPhi0</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00796">interaction_data.hpp:796</a></div></div>
<div class="ttc" id="communication_8hpp_html"><div class="ttname"><a href="communication_8hpp.html">communication.hpp</a></div><div class="ttdoc">This file contains the asynchronous MPI communication. </div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_aff0b0c6347e448f01137e996764cb3fb"><div class="ttname"><a href="structIBM__Triel__Parameters.html#aff0b0c6347e448f01137e996764cb3fb">IBM_Triel_Parameters::k2</a></div><div class="ttdeci">double k2</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00812">interaction_data.hpp:812</a></div></div>
<div class="ttc" id="utils_8hpp_html_a6d4566915e747bc257792d3b3967a181"><div class="ttname"><a href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a></div><div class="ttdeci">#define ES_ERROR</div><div class="ttdoc">error code if an error occured </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00058">utils.hpp:58</a></div></div>
<div class="ttc" id="structIBM__Triel__Parameters_html_a74f5132a5c2a4703ac9b863ab8cba456"><div class="ttname"><a href="structIBM__Triel__Parameters.html#a74f5132a5c2a4703ac9b863ab8cba456">IBM_Triel_Parameters::area0</a></div><div class="ttdeci">double area0</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00798">interaction_data.hpp:798</a></div></div>
<div class="ttc" id="utils_8hpp_html_a37474faad5e05ca5d6c2464f2f4aa27d"><div class="ttname"><a href="utils_8hpp.html#a37474faad5e05ca5d6c2464f2f4aa27d">ES_OK</a></div><div class="ttdeci">#define ES_OK</div><div class="ttdoc">error code if no error occured </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00056">utils.hpp:56</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_aae05a6fe1a1afecdedd013c330e42d56"><div class="ttname"><a href="interaction__data_8cpp.html#aae05a6fe1a1afecdedd013c330e42d56">n_bonded_ia</a></div><div class="ttdeci">int n_bonded_ia</div><div class="ttdoc">number of bonded interactions. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00095">interaction_data.cpp:95</a></div></div>
<div class="ttc" id="utils_8hpp_html_acaeef773f057c7cb7a8272c586a3c5cd"><div class="ttname"><a href="utils_8hpp.html#acaeef773f057c7cb7a8272c586a3c5cd">unit_vector</a></div><div class="ttdeci">void unit_vector(double v[3], double y[3])</div><div class="ttdoc">calculates unit vector </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00453">utils.hpp:453</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html"><div class="ttname"><a href="interaction__data_8hpp.html">interaction_data.hpp</a></div><div class="ttdoc">Various procedures concerning interactions between particles. </div></div>
<div class="ttc" id="structParticleForce_html_a196495c0b11ee16acfd25a7efde6e465"><div class="ttname"><a href="structParticleForce.html#a196495c0b11ee16acfd25a7efde6e465">ParticleForce::f</a></div><div class="ttdeci">double f[3]</div><div class="ttdoc">force. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00211">particle_data.hpp:211</a></div></div>
<div class="ttc" id="ibm__triel_8cpp_html_ab3d824b50e6bd7cccdc37d9be8c8c2b1"><div class="ttname"><a href="ibm__triel_8cpp.html#ab3d824b50e6bd7cccdc37d9be8c8c2b1">RotateForces</a></div><div class="ttdeci">void RotateForces(const double f1_rot[2], const double f2_rot[2], double f1[3], double f2[3], double v12[3], double v13[3])</div><div class="ttdoc">Rotate calculated trielastic forces in the 2d plane back to the 3d plane Use knowledge that the x-axi...</div><div class="ttdef"><b>Definition:</b> <a href="ibm__triel_8cpp_source.html#l00306">ibm_triel.cpp:306</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="dir_e2b24987bc33c075693c8e95c89d3efb.html">immersed_boundary</a></li><li class="navelem"><a class="el" href="ibm__triel_8cpp.html">ibm_triel.cpp</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:17 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
