<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: pressure.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pressure_8cpp_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">pressure.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pressure_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  Copyright (C) 2010,2011,2012,2013,2014 The ESPResSo project</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  Copyright (C) 2002,2003,2004,2005,2006,2007,2008,2009,2010 </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">    Max-Planck-Institute for Polymer Research, Theory Group</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  This file is part of ESPResSo.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">  ESPResSo is free software: you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">  it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">  ESPResSo is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">  GNU General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">  You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;. </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">*/</span><span class="comment"></span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/** \file pressure.cpp</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">    Implementation of \ref pressure.hpp &quot;pressure.h&quot;.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pressure_8hpp.html">pressure.hpp</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cells_8hpp.html">cells.hpp</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="integrate_8hpp.html">integrate.hpp</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="initialize_8hpp.html">initialize.hpp</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="domain__decomposition_8hpp.html">domain_decomposition.hpp</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="nsquare_8hpp.html">nsquare.hpp</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="layered_8hpp.html">layered.hpp</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="virtual__sites__relative_8hpp.html">virtual_sites_relative.hpp</a>&quot;</span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#ad568113942dba4c44d094998cb173659">   33</a></span>&#160;<a class="code" href="structObservable__stat.html">Observable_stat</a> <a class="code" href="pressure_8cpp.html#ad568113942dba4c44d094998cb173659">virials</a>  = {0, {NULL,0,0}, 0,0,0,0,0};</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a824b43a2a1f32840f5ba28457a464d7e">   34</a></span>&#160;<a class="code" href="structObservable__stat.html">Observable_stat</a> <a class="code" href="pressure_8cpp.html#a824b43a2a1f32840f5ba28457a464d7e">total_pressure</a> = {0, {NULL,0,0}, 0,0,0,0,0};</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#aa3cead5da74a7621c1d7b6da7f0d77b9">   35</a></span>&#160;<a class="code" href="structObservable__stat.html">Observable_stat</a> <a class="code" href="pressure_8cpp.html#aa3cead5da74a7621c1d7b6da7f0d77b9">p_tensor</a> = {0, {NULL,0,0},0,0,0,0,0};</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#ab385f4cd4eb00c54d24562d28643823a">   36</a></span>&#160;<a class="code" href="structObservable__stat.html">Observable_stat</a> <a class="code" href="pressure_8cpp.html#ab385f4cd4eb00c54d24562d28643823a">total_p_tensor</a> = {0, {NULL,0,0},0,0,0,0,0};</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/* Observables used in the calculation of intra- and inter- molecular</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">   non-bonded contributions to pressure and to stress tensor */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a549dfcf24c7ae9a096808c3b032a9a80">   40</a></span>&#160;<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> <a class="code" href="pressure_8cpp.html#a549dfcf24c7ae9a096808c3b032a9a80">virials_non_bonded</a>  = {0, {NULL,0,0}, 0,0,0};</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#ab4c6c64a8963c5f8cf0d2be205a380d8">   41</a></span>&#160;<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> <a class="code" href="pressure_8cpp.html#ab4c6c64a8963c5f8cf0d2be205a380d8">total_pressure_non_bonded</a> = {0, {NULL,0,0}, 0,0,0};</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a4e633be467e779cb5828994c8c7d373c">   42</a></span>&#160;<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> <a class="code" href="pressure_8cpp.html#a4e633be467e779cb5828994c8c7d373c">p_tensor_non_bonded</a> = {0, {NULL,0,0},0,0,0};</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a825c6d4e7a14e8b23ff57844dc749ee5">   43</a></span>&#160;<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> <a class="code" href="pressure_8cpp.html#a825c6d4e7a14e8b23ff57844dc749ee5">total_p_tensor_non_bonded</a> = {0, {NULL,0,0},0,0,0};</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#ae6eeaf48657a74e6fe79dd91528c0da5">   45</a></span>&#160;<a class="code" href="structnptiso__struct.html">nptiso_struct</a>   <a class="code" href="pressure_8cpp.html#ae6eeaf48657a74e6fe79dd91528c0da5">nptiso</a>   = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,{0.0,0.0,0.0},{0.0,0.0,0.0},1, 0 ,{<a class="code" href="npt_8hpp.html#ad668c3a70323bb182cca9c9e4e15485c">NPTGEOM_XDIR</a>, <a class="code" href="npt_8hpp.html#af9a2b98b46732b97cb93d9cea69b6ad9">NPTGEOM_YDIR</a>, <a class="code" href="npt_8hpp.html#a10ec55a2cc0f0c2ea6b56b6286aa2db9">NPTGEOM_ZDIR</a>},0,0,0};</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/* callbacks for setmd                                      */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/* local prototypes                                         */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">/** Calculate long range virials (P3M, MMM2d...). */</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#a7dd5df122d1aa72dc2e48aa7f4ff77d7">calc_long_range_virials</a>();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">/** Initializes a virials Observable stat. */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#ab3e42f91592a3720bc84158dcd829438">init_virials</a>(<a class="code" href="structObservable__stat.html">Observable_stat</a> *stat);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/** Initializes a virials Observable stat. */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#a0b54f0b700f60999a5885ffc339fe2e4">init_virials_non_bonded</a>(<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> *stat_nb);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">/** on the master node: calc energies only if necessary</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    @param v_comp flag which enables (1) compensation of the velocities required </span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">                  for deriving a pressure reflecting \ref nptiso_struct::p_inst</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">                  (hence it only works with domain decomposition); naturally it</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">                  therefore doesn&#39;t make sense to use it without NpT. */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a>(<span class="keywordtype">int</span> v_comp);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/** Initializes stat to be used by \ref pressure_calc. */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#aa0789ed045d218aa6f34f4cfda6070c4">init_p_tensor</a>(<a class="code" href="structObservable__stat.html">Observable_stat</a> *stat);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/** Initializes stat_nb to be used by \ref pressure_calc. */</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#af72e1f4e076399cde1454da1ab661b83">init_p_tensor_non_bonded</a>(<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> *stat_nb);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">/*********************************/</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/* Scalar and Tensorial Pressure */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/*********************************/</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#aab16a20eb8e566f45c340d94e727b7be">   83</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#aab16a20eb8e566f45c340d94e727b7be">pressure_calc</a>(<span class="keywordtype">double</span> *result, <span class="keywordtype">double</span> *result_t, <span class="keywordtype">double</span> *result_nb, <span class="keywordtype">double</span> *result_t_nb, <span class="keywordtype">int</span> v_comp)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordtype">int</span> n, <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keywordtype">double</span> volume = <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[0]*<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[1]*<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[2];</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="interaction__data_8cpp.html#a5891bbcf7de795d9716d0aee88f72fce">interactions_sanity_checks</a>())</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="pressure_8cpp.html#ab3e42f91592a3720bc84158dcd829438">init_virials</a>(&amp;virials);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="pressure_8cpp.html#aa0789ed045d218aa6f34f4cfda6070c4">init_p_tensor</a>(&amp;p_tensor);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="pressure_8cpp.html#a0b54f0b700f60999a5885ffc339fe2e4">init_virials_non_bonded</a>(&amp;virials_non_bonded);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="pressure_8cpp.html#af72e1f4e076399cde1454da1ab661b83">init_p_tensor_non_bonded</a>(&amp;p_tensor_non_bonded);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="initialize_8cpp.html#a026c91016cfec2d7a602a3e705712107">on_observable_calc</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="cells_8cpp.html#a90d2b85cd831c48d6b2e211eabadadd7">cell_structure</a>.<a class="code" href="structCellStructure.html#a900f4f83cd2d54b9f393f92995694ded">type</a>) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="cells_8hpp.html#a1a57771fcddf625920ffe20eb9bd5357">CELL_STRUCTURE_LAYERED</a>:</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="layered_8cpp.html#a15f01bcfbdbb2713b8f123980a700de7">layered_calculate_virials</a>(v_comp);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="cells_8hpp.html#af72b653af537e1e36b4b816d82b3ba7c">CELL_STRUCTURE_DOMDEC</a>:</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="domain__decomposition_8cpp.html#a3d049536fb2ac4c226a769ab2a975f07">dd</a>.<a class="code" href="structDomainDecomposition.html#a5fc123c6c4569b6d75eb38d52813e555">use_vList</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="cells_8cpp.html#a91f5f9cfd42c359d9244c32629c5bde4">rebuild_verletlist</a>)  </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="verlet_8cpp.html#a41114956599ffa747f472804e7372739">build_verlet_lists</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="verlet_8cpp.html#a4e15d173b2cb6acd20c43c353a32e5b5">calculate_verlet_virials</a>(v_comp);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="domain__decomposition_8cpp.html#a7386e3ccc9009ad5fe62d5876beda487">calculate_link_cell_virials</a>(v_comp);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="cells_8hpp.html#a5a7ff12df067824e6a37604b74d75f62">CELL_STRUCTURE_NSQUARE</a>:</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="nsquare_8cpp.html#ae1fac23183565ffb72748e3fc9e0b66e">nsq_calculate_virials</a>(v_comp);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">/* rescale kinetic energy (=ideal contribution) */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#ifdef ROTATION_PER_PARTICLE</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;Switching rotation per particle (#define ROTATION_PER_PARTICLE) and pressure calculation are incompatible.\n&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  virials.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] /= (3.0*volume*<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>*<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="pressure_8cpp.html#a7dd5df122d1aa72dc2e48aa7f4ff77d7">calc_long_range_virials</a>();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#ifdef VIRTUAL_SITES_RELATIVE  </span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="virtual__sites__relative_8cpp.html#a2f3248e72062244478a8bfa3bd40987d">vs_relative_pressure_and_stress_tensor</a>(virials.<a class="code" href="structObservable__stat.html#adb45b31dc632ae073a9d0569f60ee7f0">vs_relative</a>,p_tensor.<a class="code" href="structObservable__stat.html#adb45b31dc632ae073a9d0569f60ee7f0">vs_relative</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">for</span> (n = 1; n &lt; virials.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>; n++)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    virials.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[n] /= 3.0*volume;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt;9; i++)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] /= (volume*<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>*<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">for</span>(i=9; i&lt;p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>; i++)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[i]  /= volume;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">/* Intra- and Inter- part of nonbonded interaction */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  for (n = 0; n &lt; virials_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>; n++)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    virials_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[n] /= 3.0*volume;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span>(i=0; i&lt;p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>; i++)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]  /= volume;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">/* gather data */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a>(virials.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, result, virials.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>, <a class="code" href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, 0, <a class="code" href="communication_8cpp.html#afca28e25889e44c4b080c8cc173800ea">comm_cart</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a>(p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, result_t, p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>, <a class="code" href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, 0, <a class="code" href="communication_8cpp.html#afca28e25889e44c4b080c8cc173800ea">comm_cart</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a>(virials_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, result_nb, virials_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>, <a class="code" href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, 0, <a class="code" href="communication_8cpp.html#afca28e25889e44c4b080c8cc173800ea">comm_cart</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a>(p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, result_t_nb, p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>, <a class="code" href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, 0, <a class="code" href="communication_8cpp.html#afca28e25889e44c4b080c8cc173800ea">comm_cart</a>); </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#a7dd5df122d1aa72dc2e48aa7f4ff77d7">  158</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#a7dd5df122d1aa72dc2e48aa7f4ff77d7">calc_long_range_virials</a>()</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#ifdef ELECTROSTATICS</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="comment">/* calculate k-space part of electrostatic interaction. */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#a91e49bd10162ccc14beff4a244d905ec">method</a>) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#ifdef P3M</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a894cae385bba4318094c3ee3b9d1906b">COULOMB_ELC_P3M</a>:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but ELC pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af61ff343849d5de6d0637dfb7e347e7d">COULOMB_P3M_GPU</a>:</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but GPU P3M pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a57749426446c1fa84ed774089d735a5f">COULOMB_P3M</a>: {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    p3m_charge_assign();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    virials.<a class="code" href="structObservable__stat.html#af774c0aa4f73922554ec0d57630cc17c">coulomb</a>[1] = p3m_calc_kspace_forces(0,1);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">for</span>(k=0;k&lt;3;k++)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      p_tensor.<a class="code" href="structObservable__stat.html#af774c0aa4f73922554ec0d57630cc17c">coulomb</a>[9+ k*3 + k] = virials.<a class="code" href="structObservable__stat.html#af774c0aa4f73922554ec0d57630cc17c">coulomb</a>[1]/3.;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    p3m_calc_kspace_stress(p_tensor.<a class="code" href="structObservable__stat.html#af774c0aa4f73922554ec0d57630cc17c">coulomb</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a1c457699b1ca8747a52abcae380492b3">COULOMB_MMM2D</a>:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but MMM2D pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96aced9f662b92362c64980251d3d9f429d">COULOMB_MMM1D</a>:</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af540dbc00e6ca3d796715665beb13826">COULOMB_MMM1D_GPU</a>:</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but MMM1D pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a67772df29a4e767ec0ad6f2ae56ce2cb">COULOMB_EWALD_GPU</a>:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but Ewald pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*ifdef ELECTROSTATICS */</span><span class="preprocessor">  </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#ifdef DIPOLES</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">/* calculate k-space part of magnetostatic interaction. */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#af20ba286b510d86e358153664da69172">Dmethod</a>) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;     <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa24204fef27dc4cd941ebeb09234199b9">DIPOLAR_ALL_WITH_ALL_AND_NO_REPLICA</a>:</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but DAWAANR pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aaca7aa93cfe4c45f1da0a5a68cf5f47bb">DIPOLAR_MDLC_DS</a>:</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but DLC pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa62626c97d5ce90cac665d76112d1a961">DIPOLAR_DS</a>:</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but  MAGNETIC DIRECT SUM pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">#ifdef DP3M</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa27fdc96df11103ae1bf66629aec7ab78">DIPOLAR_MDLC_P3M</a>:</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: pressure calculated, but DLC pressure not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa706a967eb8a0cbe56e7d0d7f7098e405">DIPOLAR_P3M</a>: {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    dp3m_dipole_assign();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    virials.<a class="code" href="structObservable__stat.html#a9c3a374d1da3eec1a681467b2dcdb275">dipolar</a>[1] = dp3m_calc_kspace_forces(0,1);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;     </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span>(k=0;k&lt;3;k++)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      p_tensor.<a class="code" href="structObservable__stat.html#af774c0aa4f73922554ec0d57630cc17c">coulomb</a>[9+ k*3 + k] = virials.<a class="code" href="structObservable__stat.html#a9c3a374d1da3eec1a681467b2dcdb275">dipolar</a>[1]/3.;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: stress tensor calculated, but dipolar P3M stress tensor not implemented\n&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    fprintf(stderr, <span class="stringliteral">&quot;WARNING: things have been added to the coulomb virial and p_tensor arrays !!!!!!!\n&quot;</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; } </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*ifdef DIPOLES */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">/* Initialize the virials used in the calculation of the scalar pressure */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#ab3e42f91592a3720bc84158dcd829438">  235</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#ab3e42f91592a3720bc84158dcd829438">init_virials</a>(<a class="code" href="structObservable__stat.html">Observable_stat</a> *stat)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// Determine number of contribution for different interaction types</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// bonded, nonbonded, coulomb, dipolar, rigid bodies</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordtype">int</span> n_pre, n_non_bonded, n_coulomb, n_dipolar,n_vsr;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  n_pre        = 1;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  n_non_bonded = (<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>*(<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>+1))/2;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  n_coulomb    = 0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  n_dipolar    = 0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  n_vsr=0;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor">#ifdef ELECTROSTATICS</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#a91e49bd10162ccc14beff4a244d905ec">method</a>) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a6d759c803e5563dd9a238e5780e1a17e">COULOMB_NONE</a>: n_coulomb = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af61ff343849d5de6d0637dfb7e347e7d">COULOMB_P3M_GPU</a>:</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a57749426446c1fa84ed774089d735a5f">COULOMB_P3M</a>:  n_coulomb = 2; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">default</span>: n_coulomb  = 1;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#ifdef DIPOLES</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#af20ba286b510d86e358153664da69172">Dmethod</a>) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa6a8537a6d2a194c2216a8718ad709379">DIPOLAR_NONE</a>:  n_dipolar = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa24204fef27dc4cd941ebeb09234199b9">DIPOLAR_ALL_WITH_ALL_AND_NO_REPLICA</a>:  n_dipolar = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa62626c97d5ce90cac665d76112d1a961">DIPOLAR_DS</a>:  n_dipolar = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa706a967eb8a0cbe56e7d0d7f7098e405">DIPOLAR_P3M</a>:   n_dipolar = 2; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      n_dipolar = 0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#ifdef VIRTUAL_SITES_RELATIVE</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">// rigid bodies </span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  n_vsr=1;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Allocate memory for the data</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="statistics_8cpp.html#ad0eaf09a8021efab1a1cc80aa93ac38d">obsstat_realloc_and_clear</a>(stat, n_pre, <a class="code" href="interaction__data_8cpp.html#aae05a6fe1a1afecdedd013c330e42d56">n_bonded_ia</a>, n_non_bonded, n_coulomb, n_dipolar, n_vsr, 1);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  stat-&gt;<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> = 0;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a0b54f0b700f60999a5885ffc339fe2e4">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#a0b54f0b700f60999a5885ffc339fe2e4">init_virials_non_bonded</a>(<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> *stat_nb)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">int</span> n_non_bonded;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  n_non_bonded = (<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>*(<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>+1))/2;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="statistics_8cpp.html#a7e48544751e562cabfefc56b7987ed70">obsstat_realloc_and_clear_non_bonded</a>(stat_nb, n_non_bonded, 1);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  stat_nb-&gt;<a class="code" href="structObservable__stat__non__bonded.html#a204ad2e299a086f57d9b4fbb0e28c304">init_status_nb</a> = 0;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">/* Initialize the p_tensor */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">/***************************/</span></div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#aa0789ed045d218aa6f34f4cfda6070c4">  291</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#aa0789ed045d218aa6f34f4cfda6070c4">init_p_tensor</a>(<a class="code" href="structObservable__stat.html">Observable_stat</a> *stat)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;{</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// Determine number of contribution for different interaction types</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// bonded, nonbonded, coulomb, dipolar, rigid bodies</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> n_pre, n_non_bonded, n_coulomb, n_dipolar,n_vsr;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  n_pre        = 1;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  n_non_bonded = (<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>*(<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>+1))/2;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  n_coulomb = 0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  n_dipolar = 0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  n_vsr=0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#ifdef ELECTROSTATICS</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#a91e49bd10162ccc14beff4a244d905ec">method</a>) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a6d759c803e5563dd9a238e5780e1a17e">COULOMB_NONE</a>: n_coulomb = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af61ff343849d5de6d0637dfb7e347e7d">COULOMB_P3M_GPU</a>:</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a57749426446c1fa84ed774089d735a5f">COULOMB_P3M</a>:  n_coulomb = 2; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">default</span>: n_coulomb  = 1;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#ifdef DIPOLES</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#af20ba286b510d86e358153664da69172">Dmethod</a>) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa6a8537a6d2a194c2216a8718ad709379">DIPOLAR_NONE</a>: n_dipolar = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa24204fef27dc4cd941ebeb09234199b9">DIPOLAR_ALL_WITH_ALL_AND_NO_REPLICA</a>:  n_dipolar = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa62626c97d5ce90cac665d76112d1a961">DIPOLAR_DS</a>:  n_dipolar = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa706a967eb8a0cbe56e7d0d7f7098e405">DIPOLAR_P3M</a>:  n_dipolar = 2; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">default</span>: n_dipolar = 0;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#ifdef VIRTUAL_SITES_RELATIVE</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="comment">// rigid bodies </span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  n_vsr=1;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="statistics_8cpp.html#ad0eaf09a8021efab1a1cc80aa93ac38d">obsstat_realloc_and_clear</a>(stat, n_pre, <a class="code" href="interaction__data_8cpp.html#aae05a6fe1a1afecdedd013c330e42d56">n_bonded_ia</a>, n_non_bonded, n_coulomb, n_dipolar, n_vsr, 9);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  stat-&gt;<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> = 0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/***************************/</span></div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#af72e1f4e076399cde1454da1ab661b83">  333</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#af72e1f4e076399cde1454da1ab661b83">init_p_tensor_non_bonded</a>(<a class="code" href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a> *stat_nb)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordtype">int</span> n_nonbonded;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  n_nonbonded = (<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>*(<a class="code" href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a>+1))/2;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="statistics_8cpp.html#a7e48544751e562cabfefc56b7987ed70">obsstat_realloc_and_clear_non_bonded</a>(stat_nb, n_nonbonded, 9);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  stat_nb-&gt;<a class="code" href="structObservable__stat__non__bonded.html#a204ad2e299a086f57d9b4fbb0e28c304">init_status_nb</a> = 0;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#af9f3959e330453e3c6fff5f4f0255bd0">  343</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a>(<span class="keywordtype">int</span> v_comp) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">if</span>(v_comp)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="communication_8cpp.html#ae37b67ec3433cd14074b4dd29daa1c7a">mpi_gather_stats</a>(3, total_pressure.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, total_p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, total_pressure_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, total_p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="communication_8cpp.html#ae37b67ec3433cd14074b4dd29daa1c7a">mpi_gather_stats</a>(2, total_pressure.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, total_p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, total_pressure_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>, total_p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">data_nb</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> = 1+v_comp;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  total_p_tensor.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> = 1+v_comp;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  total_pressure_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#a204ad2e299a086f57d9b4fbb0e28c304">init_status_nb</a> = 1+v_comp;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  total_p_tensor_non_bonded.<a class="code" href="structObservable__stat__non__bonded.html#a204ad2e299a086f57d9b4fbb0e28c304">init_status_nb</a> = 1+v_comp;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">/*****************************************************/</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">/* Routines for Local Stress Tensor                  */</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">/*****************************************************/</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">  360</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(<span class="keywordtype">double</span> pos1[3], <span class="keywordtype">double</span> pos2[3],<span class="keywordtype">int</span> given, <span class="keywordtype">int</span> <span class="keyword">get</span>, <span class="keywordtype">double</span> value, <span class="keywordtype">double</span> *answer, <span class="keywordtype">double</span> box_size[3])</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">/*pos1 and pos2 are two particle positions.                                                  */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="comment">/*given and get are integers from 0 to 2. 0 = x direction. 1 = y direction. 2 = z direction  */</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">/*there is a point on the line between the two particles p1 and p2 such that r[given]=value  */</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">/*this procedure returns the value of r[get] at that point                                   */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordtype">double</span> p2r[3];</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    p2r[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>((pos2[i]-pos1[i])+box_size[i]/2.0,box_size[i])-box_size[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  value = <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>((value-pos1[given])+box_size[given]/2.0,box_size[given])-box_size[given]/2.0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">//PTENSOR_TRACE(fprintf(stderr,&quot;%d: getintersection: p1 is %f %f %f p2 is %f %f %f p2r is %f %f %f newvalue is %f\n&quot;,this_node,pos1[0],pos1[1],pos1[2],pos2[0],pos2[1],pos2[2],p2r[0],p2r[1],p2r[2],value););</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> ((value)*(p2r[given]) &lt; -0.0001) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      ostringstream msg;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      msg &lt;&lt;<span class="stringliteral">&quot;analyze stress_profile: getintersection: intersection is not between the two given particles - &quot;</span> &lt;&lt; value &lt;&lt; <span class="stringliteral">&quot; is not between &quot;</span> &lt;&lt; 0.0 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; p2r[given] &lt;&lt; <span class="stringliteral">&quot; and box size is &quot;</span> &lt;&lt; box_size[given] &lt;&lt; <span class="stringliteral">&quot;, given is &quot;</span> &lt;&lt; given &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <a class="code" href="errorhandling_8hpp.html#a62b07981730ac486dfb20b915e6b3047">runtimeError</a>(msg);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">return</span> 0; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (given == <span class="keyword">get</span>) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    *answer =  <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>(value + pos1[given],box_size[given]);;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0==p2r[given]) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      ostringstream msg;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      msg &lt;&lt;<span class="stringliteral">&quot;analyze stress_profile: getintersection: intersection is a line, not a point - value is &quot;</span> &lt;&lt; value &lt;&lt; <span class="stringliteral">&quot; same as &quot;</span> &lt;&lt; 0.0 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; p2r[given] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="errorhandling_8hpp.html#a62b07981730ac486dfb20b915e6b3047">runtimeError</a>(msg);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">return</span> 0;   </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    *answer =  <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>(pos1[<span class="keyword">get</span>]+p2r[<span class="keyword">get</span>]/p2r[given]*value,box_size[<span class="keyword">get</span>]);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#aeee2dc2fd6274ff5573a23dba7e7d0fc">  394</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#aeee2dc2fd6274ff5573a23dba7e7d0fc">getlength</a>(<span class="keywordtype">double</span> pos1[3], <span class="keywordtype">double</span> pos2[3], <span class="keywordtype">int</span> d1, <span class="keywordtype">double</span> val1, <span class="keywordtype">int</span> d2, <span class="keywordtype">double</span> val2, <span class="keywordtype">int</span> l, <span class="keywordtype">double</span> *answer)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;{</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">/*p1 and p2 are two particles positions                                                          </span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">    d1 and d2 are integers between 0 and 2 denoting an axis (x, y, or z)                        </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">    l and k are integers between 0 and 2 denoting an axis (x, y, or z)                          </span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">    two points on the line connecting these particles are defined by r[d1]=val1 and r[d2]=val2  </span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">    call these two points p3 and p4 (not program variables)                                     </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">    this program returns the distance between p3 and p4 in the l direction</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">double</span> intersect1, intersect2;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  *answer = 0;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span>  (! <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(pos1,pos2,d2,l,val2,&amp;intersect1,<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>) || ! <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(pos1,pos2,d1,l,val1,&amp;intersect2,<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>)) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    *answer = <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>(intersect2 - intersect1 + <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[l]/2.0, <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[l]) - <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[l]/2.0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#a93de7ce3dee66c458e50911c1fcd3139">  416</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#a93de7ce3dee66c458e50911c1fcd3139">does_line_go_through_cube</a>(<span class="keywordtype">double</span> pos1[3], <span class="keywordtype">double</span> pos2[3], <span class="keywordtype">double</span> range_start[3], <span class="keywordtype">double</span> range[3], <span class="keywordtype">int</span> <a class="code" href="constraint_8cpp.html#a08874f3ecb3cab16c1e7a0c743eebff4">sign</a>[3], <span class="keywordtype">double</span> entry[3], <span class="keywordtype">double</span> exit[3],<span class="keywordtype">int</span> *facein, <span class="keywordtype">int</span> *faceout)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;     <span class="comment">/* p1 and p2 are two particle positions</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">        there is a cube in the simulation box with one vertex at range_start and the opposite vertex at range_start + range</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">        this routine calculates where the line connecting p1 and p2 enters and exits this cube</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">        these points are returned in the variables entry and exit</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">        the function returns a 0 if the line does not pass through the cube and 1 if it does</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keywordtype">double</span> centre[3];             <span class="comment">/* centre of the cube */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordtype">double</span> vect2centre1[3];       <span class="comment">/* vectors from centre of cube to pos1 and pos2 */</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordtype">double</span> vect2centre2[3];</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordtype">int</span> doesntenter = 0;          <span class="comment">/* boolean that indicates whether we have already determined that the line does not enter the cube at all */</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordtype">double</span> intersection1 = 0.0, intersection2 = 0.0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">int</span> found_entry = 0;          <span class="comment">/* boolean that indicates whether we have determined where the line enters */</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">int</span> found_exit = 0;           <span class="comment">/* boolean that indicates whether we have determined where the line exits */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">int</span> i1, i2;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">int</span> inside1, inside2;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   <span class="comment">/* find centre of analyzed cube */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    centre[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = range_start[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">/* find vectors connecting two particles to centre */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(vect2centre1,pos1,centre);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(vect2centre2,pos2,centre);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  *facein = -1;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  *faceout = -1;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">/* check if particles are inside cube */</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  inside1 = 1;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  inside2 = 1;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (fabs(vect2centre1[i])&gt;range[i]/2.0) inside1 = 0;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (fabs(vect2centre2[i])&gt;range[i]/2.0) inside2 = 0;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: does_line_go_through_cube: Particle1 inside cube = %d Particle2 inside cube = %d \n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,inside1,inside2););</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">/* work out which face connecting line enters through */</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span> (! inside1) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      i1 = (i+1)%3;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      i2 = (i+2)%3;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="comment">/*does the line start outside the cube in direction i?*/</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">if</span> ( (! doesntenter ) &amp;&amp; (! found_entry) &amp;&amp; fabs(vect2centre1[i])&gt;range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0 ) { </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;         <span class="comment">/*does the bond heads away from the cube or is part2 is before the cube in direction i? */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">if</span> ((vect2centre1[i] * sign[i] &gt; 0) ||  (vect2centre2[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*sign[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt; -range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0)) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;          doesntenter = 1;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(vect2centre1, vect2centre2, i, i1, -range[i]/2.0*sign[i],&amp;intersection1,<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="keywordflow">if</span> (intersection1 &gt; <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i1]/2) intersection1 -= <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i1];</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          <span class="keywordflow">if</span> (fabs(intersection1) &lt; range[i1]/2.0) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(vect2centre1, vect2centre2, i, i2, -range[i]/2.0*sign[i],&amp;intersection2,<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">if</span> (intersection2 &gt; <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i2]/2) intersection2 -= <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i2];</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">if</span> (fabs(intersection2) &lt; range[i2]/2.0) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              found_entry = 1;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;              entry[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = centre[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] -range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0*sign[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;              entry[i1] = centre[i1] + intersection1;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;              entry[i2] = centre[i2] + intersection2;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;              *facein = <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    entry[0] = pos1[0];</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    entry[1] = pos1[1];</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    entry[2] = pos1[2];</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordflow">if</span> (! (found_entry) &amp;&amp; ! (inside1)) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: does_line_go_through_cube: Line does not pass through cube \n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>););</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: does_line_go_through_cube: Entry is %f %f %f \n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,entry[0], entry[1], entry[2]););</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (! inside2) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="comment">/*check which outside faces of box the line exits through */</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        i1 = (i+1)%3;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        i2 = (i+2)%3;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">/* does it enter into the box through the i face */</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">if</span> ((found_exit == 0) &amp;&amp; (fabs(vect2centre2[i]) &gt; range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0)) {  <span class="comment">/*starts outside cube in i direction */</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(vect2centre1, vect2centre2, i, i1, range[i]/2.0*sign[i],&amp;intersection1,<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          <span class="keywordflow">if</span> (intersection1 &gt; <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i1]/2) intersection1 -= <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i1];</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          <span class="keywordflow">if</span> (fabs(intersection1) &lt; range[i1]/2.0) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(vect2centre1, vect2centre2, i, i2, range[i]/2.0*sign[i],&amp;intersection2,<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">if</span> (intersection2 &gt; <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i2]/2) intersection2 -= <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i2];</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">if</span> (fabs(intersection2) &lt; range[i2]/2.0) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;              found_exit = 1;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;              exit[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = centre[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]   + range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0*sign[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;              exit[i1] = centre[i1] + intersection1;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;              exit[i2] = centre[i2] + intersection2;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              *faceout = <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;          }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      exit[0] = pos2[0];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      exit[1] = pos2[1];</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      exit[2] = pos2[2];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: does_line_go_through_cube: Exit is %f %f %f\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,exit[0], exit[1], exit[2]););</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: does_line_go_through_cube: facein is %d faceout is %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,*facein,*faceout););</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;}</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#adf55314b6e2da67f5735e2d3d26de133">  528</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#adf55314b6e2da67f5735e2d3d26de133">distribute_tensors</a>(<a class="code" href="structDoubleList.html">DoubleList</a> *TensorInBin, <span class="keywordtype">double</span> *force, <span class="keywordtype">int</span> bins[3], <span class="keywordtype">double</span> range_start[3], <span class="keywordtype">double</span> range[3], <span class="keywordtype">double</span> pos1[3], <span class="keywordtype">double</span> pos2[3])</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">/*calculates how to distribute a force tensor between two particles between various bins</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">    the amount distributed to a bin is proportional to the length of the line between the</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">      two particles p1 and p2 that passes through the bin volume</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">    we consider a cube of space starting with a corner at {x_range_start, y_range_start, z_range_start} extending to </span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">      {x_range_start+x_range, y_range_start+y_range, z_range_start+z_range}</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">    this cube is split into x_bins bins in the x direction - we refer to these as x-bins</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">    each x-bin into y_bins bins in the y direction - we refer to these as y-bins</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">    each y_bin into z_bins bins in the z direction - we refer to these as z-bins</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="constraint_8cpp.html#a08874f3ecb3cab16c1e7a0c743eebff4">sign</a>[3],sign10[3];    <span class="comment">/* indicates whether the line goes in the positive or negative direction in each dimension */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keywordtype">double</span> entry[3], exit[3]; <span class="comment">/* the positions at which the line enters and exits the cube */</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordtype">int</span> startx, endx;         <span class="comment">/* x-bins in which the line starts and ends in */</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordtype">int</span> occupiedxbins;        <span class="comment">/* number of x-bins occuped by the line */</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordtype">int</span> *starty;              <span class="comment">/* y-bins in which the line starts in for each x-bin.  This array has dimension occupiedxbins+1. */</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keywordtype">int</span> totoccupiedybins;     <span class="comment">/* total number of y-bins through which the line passes  */</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordtype">int</span> *occupiedybins;       <span class="comment">/* number of occupied y-bins for each x-bin */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">int</span> *occupiedzbins;       <span class="comment">/* number of occupied z-bins for each y-bin */</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordtype">int</span> *startz;              <span class="comment">/* z-bins in which the line starts in for each y_bin.  This array has dimension totaloccupiedybins. */</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="keywordtype">int</span> xbin, ybin, zbin;     <span class="comment">/* counters to keep track of bins x_bin goes from 0 to x_bins-1, y_bins from 0 to y_bins-1, z_bins from 0 to Z-bins-1 */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a> ,k, l;    </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordtype">int</span> counter;              <span class="comment">/* keeps track of where we are in the startz array */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">int</span> zi;                           </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="keywordtype">double</span> length;            <span class="comment">/* length of line between the two points */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordtype">int</span> d1,d2;                <span class="comment">/* for each z-bin d1 and d2 are calculated.  they indicate through which faces of the bin the line enters and leaves the bin.  i.e. if the line enters through the face corresponding to y = 0.34 then d1 = 1 (y-direction) and val1 = 0.34 */</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="keywordtype">double</span> val1, val2;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordtype">double</span> intersect;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordtype">double</span> segment,segment2;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordtype">double</span> calclength;        </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordtype">int</span> xa, ya, za;           <span class="comment">/* counters for bins */</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordtype">double</span> temp[3];</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordtype">double</span> redentry[3], redexit[3];  <span class="comment">/* like entry and exit but using a coordinate system where range_start corresponds to (0,0,0) and the length scale in each direction is the bin width */</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordtype">double</span> redbox_l[3];       <span class="comment">/* box size is reduced units */</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keywordtype">int</span> facein,faceout;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: Distributing tensors for particle p1 %f %f %f and p2 %f %f %f\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,pos1[0],pos1[1],pos1[2],pos2[0],pos2[1],pos2[2]););</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: range_start is %f %f %f range is %f %f %f bins is %d %d %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,range_start[0],range_start[1],range_start[2],range[0],range[1],range[2],bins[0],bins[1],bins[2]););</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">/* work out what direction the line joining the particles goes in */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  length = 0;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(temp, pos2, pos1);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    sign[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (temp[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt; 0)*2-1;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    sign10[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]  = (sign[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]+1)/2.0;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: sign is %d %d %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,sign[0],sign[1],sign[2]););</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  calclength = 0;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">/* check if the line passes through the cube and if so where it enters and exits it */</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#a93de7ce3dee66c458e50911c1fcd3139">does_line_go_through_cube</a>(pos1, pos2, range_start, range, sign, entry, exit,&amp;facein,&amp;faceout)) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">/* calculate reduced coordinates */</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">/* range_start becomes (0,0,0) and range_start + range becomes (bins[0],bins[1],bins[2]) */</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(redentry, entry, range_start);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(redexit, exit, range_start);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      redentry[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>(redentry[i]+<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i],<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i]);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      redexit[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>(redexit[i]+<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i],<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i]);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    length = 0;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(temp, exit, entry);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      redentry[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = redentry[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*bins[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      redexit[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = redexit[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*bins[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      length += pow(temp[i],2);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    length = pow(length,0.5);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: Reduced Entry is %f %f %f Reduced Exit is %f %f %f \n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,redentry[0],redentry[1],redentry[2],redexit[0], redexit[1], redexit[2]););</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      redbox_l[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]*bins[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">/* find in which x-bins the line starts and stops */</span> </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">if</span> (facein == 0) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      startx = <a class="code" href="utils_8hpp.html#ac110bac59d287179e3c5436056a083aa">dround</a>(redentry[0]) - 1 + sign10[0];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      startx = floor(redentry[0]);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">if</span> ((startx &lt; 0) &amp;&amp; (range[0]==<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[0])) startx += bins[0];</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (faceout == 0) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      endx = <a class="code" href="utils_8hpp.html#ac110bac59d287179e3c5436056a083aa">dround</a>(redexit[0] - sign10[0]);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      endx = floor(redexit[0]);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> ((endx &lt; 0) &amp;&amp; (range[0]==<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[0])) startx += bins[0];</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    occupiedxbins = (sign[0]*(endx-startx) + bins[0])%bins[0] +1;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: x goes from %d to %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,startx, endx);)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">/* Initialise starty array */</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    starty = (<span class="keywordtype">int</span> *)<a class="code" href="debug_8hpp.html#a6bb12c9cae32ecd32a4584a86c4c6c99">malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(occupiedxbins+1));</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    occupiedybins = (<span class="keywordtype">int</span> *)<a class="code" href="debug_8hpp.html#a6bb12c9cae32ecd32a4584a86c4c6c99">malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*occupiedxbins);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">/* find in which y-bins the line starts and stops for each x-bin */</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">/* in xbin the line starts in y-bin number starty[xbin-startx] and ends in starty[xbin-startx+1] */</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    totoccupiedybins = 0;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (facein == 1) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      starty[0] = <a class="code" href="utils_8hpp.html#ac110bac59d287179e3c5436056a083aa">dround</a>(redentry[1]) - 1 + sign10[1];</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      starty[0] = floor(redentry[1]);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">if</span> ((starty[0] &lt; 0) &amp;&amp; (range[1]==<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[1])) starty[0] += bins[1];</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">for</span> (xa=0; xa &lt; occupiedxbins; xa++) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      xbin = (startx + xa*sign[0]+bins[0])%bins[0];</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">if</span> (xbin == endx) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        intersect  = redexit[1];</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> (faceout == 1) intersect -= sign10[1];</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordflow">if</span> (( intersect &lt; 0) &amp;&amp; (range[1]==<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[1])) intersect += bins[1];</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(redentry,redexit,0,1,xbin+sign10[0],&amp;intersect,redbox_l) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      starty[xa+1]=floor(intersect);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      occupiedybins[xa] = ((starty[xa+1]-starty[xa])*sign[1]+bins[1])%bins[1]+1;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      totoccupiedybins += occupiedybins[xa];</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: in xbin %d y goes from %d to %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>, xbin, starty[xa],starty[xa+1]););</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">/* Initialise startz array */</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    occupiedzbins = (<span class="keywordtype">int</span> *)<a class="code" href="debug_8hpp.html#a6bb12c9cae32ecd32a4584a86c4c6c99">malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*totoccupiedybins);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    startz = (<span class="keywordtype">int</span> *)<a class="code" href="debug_8hpp.html#a6bb12c9cae32ecd32a4584a86c4c6c99">malloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*(totoccupiedybins+1));</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">/* find in which z-bins the line starts and stops for each y-bin*/</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    counter = 0;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (facein == 2) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      zi = <a class="code" href="utils_8hpp.html#ac110bac59d287179e3c5436056a083aa">dround</a>(redentry[2]) - 1 + sign10[2];</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      zi = floor(redentry[2]);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">if</span> (( zi &lt; 0) &amp;&amp; (range[2]==<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[2])) zi += bins[2];</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    startz[counter] = zi;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">for</span> (xa=0; xa &lt; occupiedxbins; xa++) {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      xbin = (startx + xa*sign[0]+bins[0])%bins[0];</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">for</span> (ya = 0; ya &lt; occupiedybins[xa]-1; ya++) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        ybin = (starty[xa] + ya*sign[1] + bins[1])%bins[1];</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: xbin is %d ya is %d, occupiedybins[xa] is %d, ybin is %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ya,occupiedybins[xa],ybin););</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(redentry,redexit,1,2,ybin+sign10[1],&amp;intersect,redbox_l) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        zi = floor(intersect);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        startz[counter+1] = zi;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        occupiedzbins[counter]= (sign[2]*(startz[counter+1]-startz[counter]) + bins[2])%bins[2] +1;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: in xbin %d ybin %d zbin goes from %d to %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,startz[counter],startz[counter+1]););</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        counter ++;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      ybin = starty[xa+1];</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span> (xbin == endx) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">if</span> (faceout == 2) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          zi = <a class="code" href="utils_8hpp.html#ac110bac59d287179e3c5436056a083aa">dround</a>(redexit[2] -sign10[2]);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          zi = floor(redexit[2]);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">if</span> (( zi &lt; 0) &amp;&amp; (range[2]==<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[2])) zi += bins[2];</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a>(redentry,redexit,0,2,xbin+sign10[0], &amp;intersect, redbox_l) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        zi = floor(intersect);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      startz[counter+1]=zi;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      occupiedzbins[counter]= (sign[2]*(startz[counter+1]-startz[counter]) + bins[2])%bins[2] +1;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: in xbin %d ybin %d zbin goes from %d to %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,startz[counter],startz[counter+1]););</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      counter ++;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: occupiedxbins is %d,occupiedybins[0] is %d, occupiedzbins[0] is %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,occupiedxbins,occupiedybins[0],occupiedzbins[0]););</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">/* find out what length of the line passes through each z-bin */</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    counter = 0;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">for</span> (xa = 0; xa &lt; occupiedxbins; xa ++) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      xbin = (startx + xa*sign[0]+bins[0])%bins[0];</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="keywordflow">for</span> (ya = 0; ya &lt; occupiedybins[xa]; ya++) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        ybin = (starty[xa] + ya*sign[1] + bins[1])%bins[1];</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordflow">for</span> (za = 0; za &lt; occupiedzbins[counter]; za++) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;          zbin = (startz[counter] + za*sign[2] +bins[2])%bins[2];</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          <span class="keywordflow">if</span> (zbin == startz[counter]) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="keywordflow">if</span> (ybin == starty[xa]) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;              <span class="keywordflow">if</span> (xbin == startx) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">if</span> (entry[0]-exit[0] != 0) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                  d1 = 0;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                  val1 = redentry[0];</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry[1]-exit[1] != 0){</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                  d1 = 1;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                  val1 = redentry[1];</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                  d1 = 2;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                  val1 = redentry[2];</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                }                                                        </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line starts at point p1 inside bin\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin););</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                d1 = 0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                val1  = xbin+1-sign10[0];</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line enters through x = %e face of box\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin,val1););</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;              }  </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;              d1 = 1;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;              val1 = ybin+1-sign10[1];        </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;              <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line enters through y = %e face of box\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin,val1););</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            d1 = 2;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            val1 = zbin+1-sign10[2]; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line enters through z = %e face of box zbin is %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin,val1,zbin););</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;          <span class="keywordflow">if</span> (zbin == startz[counter+1]) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">if</span> (ybin == starty[xa+1]) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;              <span class="keywordflow">if</span> (xbin == endx) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="keywordflow">if</span> (entry[0]-exit[0] != 0) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                  d2 = 0;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                  val2 = redexit[0];</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry[1]-exit[1]!= 0){</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                  d2 = 1;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                  val2 = redexit[1];</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                  d2 = 2;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                  val2 = redexit[2];</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                }                                                      </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line ends at p2 inside bin\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin););</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;              }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                d2 = 0;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                val2 = xbin+sign10[0];</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line leaves through x = %e face of box\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin,val2););</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;              }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;              d2 = 1;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              val2 = ybin+sign10[1]; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;              <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line leaves through y = %e face of box direction %d\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin,val2,sign[1]););</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;          d2= 2;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          val2 = zbin+sign10[2];</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: %d %d %d line leaves through z = %e face of box\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,xbin,ybin,zbin,val2););</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;          segment2 = 0;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: entry %f %f %f exit %f %f %f d1 %d val1 %f d2 %d val2 %f\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,entry[0],entry[1],entry[2],exit[0],exit[1],exit[2],d1,range_start[d1]+val1*range[d1]/(<span class="keywordtype">double</span>)bins[d1],d2,range_start[d2]+val2*range[d2]/(<span class="keywordtype">double</span>)bins[d2]););</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;          <span class="keywordflow">for</span> (l=0;l&lt;3;l++) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#aeee2dc2fd6274ff5573a23dba7e7d0fc">getlength</a>(entry,exit,d1,range_start[d1]+val1*range[d1]/(<span class="keywordtype">double</span>)bins[d1],d2,range_start[d2]+val2*range[d2]/(<span class="keywordtype">double</span>)bins[d2],l,&amp;segment) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            segment2 += pow(segment,2);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            <span class="keywordflow">for</span> (k=0;k&lt;3;k++) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;              TensorInBin[xbin*bins[1]*bins[2]+ybin*bins[2]+zbin].<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[3*k+l] += force[k] * segment;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;          }</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;          calclength += pow(segment2,0.5);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        counter ++;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: distribute_tensors: calclength is %e and length is %e\n}&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,calclength,length););</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> (calclength - length &gt;0.0000000001) {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        ostringstream msg;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        msg &lt;&lt; <a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a> &lt;&lt; <span class="stringliteral">&quot;: analyze stress_profile: bug in distribute tensor code - calclength is &quot;</span> &lt;&lt; calclength &lt;&lt; <span class="stringliteral">&quot; and length is &quot;</span> &lt;&lt; length;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <a class="code" href="errorhandling_8hpp.html#a62b07981730ac486dfb20b915e6b3047">runtimeError</a>(msg);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <a class="code" href="debug_8hpp.html#a2f68dcdf04325fdf10c5acfb7fb7b184">free</a>(occupiedzbins);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="debug_8hpp.html#a2f68dcdf04325fdf10c5acfb7fb7b184">free</a>(occupiedybins);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="debug_8hpp.html#a2f68dcdf04325fdf10c5acfb7fb7b184">free</a>(starty);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="debug_8hpp.html#a2f68dcdf04325fdf10c5acfb7fb7b184">free</a>(startz);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;} </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#aab066004d9c353859414feb568539e89">  791</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#aab066004d9c353859414feb568539e89">reducepos</a>(<span class="keywordtype">double</span> pos[3], <span class="keywordtype">int</span> bins[3], <span class="keywordtype">double</span> centre[3], <span class="keywordtype">double</span> range[3], <span class="keywordtype">int</span> reducedpos[3]) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordtype">double</span> working[3];</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(working, pos, centre);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    reducedpos[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = floor((working[i]+range[i]/2.0)*(<span class="keywordtype">double</span>)bins[i]/range[i]);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keywordflow">return</span> 1; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#a47fafd818e7c52776203aa86aeff2d97">  801</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#a47fafd818e7c52776203aa86aeff2d97">incubewithskin</a>(<span class="keywordtype">double</span> pos[3], <span class="keywordtype">double</span> centre[3], <span class="keywordtype">double</span> range[3])</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;{</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="keywordtype">double</span> working[3];</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(working, pos, centre);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">for</span> (i=0; i &lt;3; i++) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (fabs(working[i]) &gt; range[i]/2.0 + <a class="code" href="core_2integrate_8cpp.html#a1fad9813185ba0cb89981455e59b1408">skin</a>+<a class="code" href="integrate_8hpp.html#a15cf595e04616281674463717a3d1000">max_cut</a>) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">return</span> 1; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#ad44a2f2828031534357e913f39d582ea">  812</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#ad44a2f2828031534357e913f39d582ea">whichbin</a>(<span class="keywordtype">double</span> pos[3], <span class="keywordtype">int</span> bins[3], <span class="keywordtype">double</span> centre[3], <span class="keywordtype">double</span> range[3], <span class="keywordtype">int</span> *bin)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">/*calculates which bin a particle is in for local_stress_tensor */</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;{</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordtype">int</span> reducedpos[3];</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <a class="code" href="pressure_8cpp.html#aab066004d9c353859414feb568539e89">reducepos</a>(pos, bins, centre, range, reducedpos);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordflow">if</span> ((reducedpos[i] &lt; 0) || (reducedpos[i] &gt;= bins[i])) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      *bin = -1;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  *bin = reducedpos[0]*bins[1]*bins[2] + reducedpos[1]*bins[2] + reducedpos[2];</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;}</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="pressure_8cpp.html#a338a7afac824c7e16dc819761e0e6afb">  828</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#a338a7afac824c7e16dc819761e0e6afb">get_nonbonded_interaction</a>(<a class="code" href="structParticle.html">Particle</a> *p1, <a class="code" href="structParticle.html">Particle</a> *p2, <span class="keywordtype">double</span> *force)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;{</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">/* returns the non_bonded interaction between two particles */</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordtype">double</span> dist2, dist;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordtype">double</span> d[3];</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="preprocessor">#ifdef ELECTROSTATICS</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="keywordtype">double</span> eforce[3];</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  force[0]=0; force[1]=0; force[2]=0; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">if</span> ((p1-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">identity</a> != p2-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">identity</a>)&amp;&amp;(<a class="code" href="interaction__data_8hpp.html#af33076101f612338df49016fa60b8d0a">checkIfParticlesInteract</a>(p1-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#aff59dca9a266f6720196cf06ac7a00d3">type</a>, p2-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#aff59dca9a266f6720196cf06ac7a00d3">type</a>))) {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="comment">/* distance calculation */</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(d, p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, p2-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    dist2 = <a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(d[0]) + <a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(d[1]) + <a class="code" href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a>(d[2]);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    dist  = sqrt(dist2);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <a class="code" href="forces__inline_8hpp.html#a0f7bdcddc16cc3c5cbcb744a996099c8">calc_non_bonded_pair_force</a>(p1,p2,d,dist,dist2,force);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">#ifdef ELECTROSTATICS</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#a91e49bd10162ccc14beff4a244d905ec">method</a> != <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a6d759c803e5563dd9a238e5780e1a17e">COULOMB_NONE</a>) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#a91e49bd10162ccc14beff4a244d905ec">method</a>) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#ifdef P3M</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af61ff343849d5de6d0637dfb7e347e7d">COULOMB_P3M_GPU</a>:</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation cannot handle GPU P3M electrostatics so it is left out\n&quot;</span>);  </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a57749426446c1fa84ed774089d735a5f">COULOMB_P3M</a>:</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation cannot handle P3M electrostatics so it is left out\n&quot;</span>);  </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a98db3a3951cc30178873115d8be68fc3">COULOMB_DH</a>:</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          eforce[i] = 0;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <a class="code" href="debye__hueckel_8hpp.html#a7cf6993716ebf0e66ecbe72b876cb9c1">add_dh_coulomb_pair_force</a>(p1,p2,d,dist, eforce);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;3;i++)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          force[i] += eforce[i];</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a78e53a0529d64f84379014a79b0d0b22">COULOMB_RF</a>:</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          eforce[i] = 0;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="reaction__field_8hpp.html#af9a0d4b7fc39860d587ef27b2f690555">add_rf_coulomb_pair_force</a>(p1,p2,d,dist, eforce);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">for</span>(i=0;i&lt;3;i++)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            force[i] += eforce[i];</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a0ce43e74c2f61c6e954e2d124649dc5b">COULOMB_INTER_RF</a>:</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="comment">// this is done elsewhere</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96aced9f662b92362c64980251d3d9f429d">COULOMB_MMM1D</a>:</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation cannot handle MMM1D electrostatics so it is left out\n&quot;</span>);  </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation does not recognise this electrostatic interaction\n&quot;</span>);  </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*ifdef ELECTROSTATICS */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">#ifdef DIPOLES</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#af20ba286b510d86e358153664da69172">Dmethod</a> != <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa6a8537a6d2a194c2216a8718ad709379">DIPOLAR_NONE</a>) {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a>.<a class="code" href="structCoulomb__parameters.html#af20ba286b510d86e358153664da69172">Dmethod</a>) {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="preprocessor">#ifdef DP3M</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa706a967eb8a0cbe56e7d0d7f7098e405">DIPOLAR_P3M</a>:</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation cannot handle P3M magnetostatics so it is left out\n&quot;</span>);  </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa24204fef27dc4cd941ebeb09234199b9">DIPOLAR_ALL_WITH_ALL_AND_NO_REPLICA</a>:</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation cannot handle DAWAANR magnetostatics so it is left out\n&quot;</span>);  </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa62626c97d5ce90cac665d76112d1a961">DIPOLAR_DS</a>:</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation cannot handle MAGNETIC DIPOLAR SUM magnetostatics so it is left out\n&quot;</span>);  </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        fprintf(stderr,<span class="stringliteral">&quot;WARNING: Local stress tensor calculation does not recognise this magnetostatic interaction\n&quot;</span>);  </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*ifdef DIPOLES */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  } <span class="comment">/*if p1-&gt; ... */</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;}</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a26086c6865b7d69f8b395b6c7e5e3f93">  910</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#a26086c6865b7d69f8b395b6c7e5e3f93">local_stress_tensor_calc</a>(<a class="code" href="structDoubleList.html">DoubleList</a> *TensorInBin, <span class="keywordtype">int</span> bins[3], <span class="keywordtype">int</span> <a class="code" href="grid_8cpp.html#a071976c64226ce571f994f68f8b8a13f">periodic</a>[3], <span class="keywordtype">double</span> range_start[3], <span class="keywordtype">double</span> range[3])</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;{</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">/*calculates local stress tensors in cuboid bins</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">    uses Irving Kirkwood method</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">    we consider a cube of space starting with a corner at position range_start extending to </span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">      range_start + range</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">    if the variable periodic is set to 1 in dimension i then the cube is assumed to span the periodic box</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">    this cube is divided into bins[0] bins in the x direction bins[1] in the y direction, and bins[2] in the z direction</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j;                       <span class="comment">/*counter for dimension */</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordtype">double</span> binvolume;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordtype">int</span> c, np, n, bin;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keywordtype">double</span> centre[3];</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="structParticleList.html">Cell</a> *cell;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <a class="code" href="structParticle.html">Particle</a> *p1, *p2, **pairs;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="structParticle.html">Particle</a> *particles;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordtype">double</span> force[3];</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="keywordtype">int</span> k,l;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordtype">int</span> type_num;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <a class="code" href="structBonded__ia__parameters.html">Bonded_ia_parameters</a> *iaparams;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordtype">double</span> dx[3];</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 3; i ++) {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (periodic[i]) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      range_start[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">/* find centre of analyzed cube */</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    centre[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = range_start[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] + range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]/2.0;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">/* We consider all particles that are within a certain distance of the cube. The skin is used as this distance.  If the</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">     skin from on opposite sides of the box overlaps then we produce an error message.  To code dround this would be</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">     creating unnecessary work since I can&#39;t imagine when we might want that */</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;3;i++) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span> ((! periodic[i]) &amp;&amp; (range[i] + 2*<a class="code" href="core_2integrate_8cpp.html#a1fad9813185ba0cb89981455e59b1408">skin</a> +2*<a class="code" href="integrate_8hpp.html#a15cf595e04616281674463717a3d1000">max_cut</a> &gt; <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i])) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        ostringstream msg;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        msg &lt;&lt;<span class="stringliteral">&quot;analyze stress_profile: Analyzed box (&quot;</span> &lt;&lt; range[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;) with skin+max_cut(&quot;</span> &lt;&lt; <a class="code" href="core_2integrate_8cpp.html#a1fad9813185ba0cb89981455e59b1408">skin</a>+<a class="code" href="integrate_8hpp.html#a15cf595e04616281674463717a3d1000">max_cut</a> &lt;&lt; <span class="stringliteral">&quot;) is larger than simulation box (&quot;</span> &lt;&lt; <a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;).\n&quot;</span>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="errorhandling_8hpp.html#a62b07981730ac486dfb20b915e6b3047">runtimeError</a>(msg);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    range_start[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a>(range_start[i],<a class="code" href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a>[i]);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: Running stress_profile\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>));</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  binvolume = range[0]*range[1]*range[2]/(double)bins[0]/(<span class="keywordtype">double</span>)bins[1]/(double)bins[2];</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="comment">/* this next bit loops over all pair of particles, calculates the force between them, and distributes it amongst the tensors */</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">// loop over all local cells</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">for</span> (c = 0; c &lt; <a class="code" href="cells_8cpp.html#a99da5e8ac75258e3558759794077737b">local_cells</a>.<a class="code" href="structCellPList.html#a5e048c4df0720361e87fc32960e240e2">n</a>; c++) {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    cell = <a class="code" href="cells_8cpp.html#a99da5e8ac75258e3558759794077737b">local_cells</a>.<a class="code" href="structCellPList.html#aea60ac0faa16a48d42cdee57726382be">cell</a>[c];</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    particles   = cell-&gt;<a class="code" href="structParticleList.html#a3ed5f48ed3201b209dc585be8f4c44f9">part</a>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    np  = cell-&gt;<a class="code" href="structParticleList.html#a320bc471ea3907e6ae1a96bf774ba715">n</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// loop over all particles in this cell</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">for</span>(i = 0; i &lt; np; i++)  {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      p1 = &amp;(particles[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <a class="code" href="pressure_8cpp.html#ad44a2f2828031534357e913f39d582ea">whichbin</a>(p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>,bins,centre, range, &amp;bin); </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      <span class="keywordflow">if</span> (bin &gt;= 0) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d:Got particle number %d i is %d pos is %f %f %f \n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,p1-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">identity</a>,i,p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>[0],p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>[1],p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>[2]));</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d:Ideal gas component is {&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>));</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">for</span>(k=0;k&lt;3;k++) {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          <span class="keywordflow">for</span>(l=0;l&lt;3;l++) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            TensorInBin[bin].<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[k*3 + l] += (p1-&gt;<a class="code" href="structParticle.html#ad2daa30c46725fb06d3922708ca2aa30">m</a>.<a class="code" href="structParticleMomentum.html#a25cac362b1f1e3a755404a162fd680d4">v</a>[k])*(p1-&gt;<a class="code" href="structParticle.html#ad2daa30c46725fb06d3922708ca2aa30">m</a>.<a class="code" href="structParticleMomentum.html#a25cac362b1f1e3a755404a162fd680d4">v</a>[l])*<a class="code" href="utils_8hpp.html#a747a977c2fbce6f4bba1f13d0de15463">PMASS</a>(*p1)/<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>/<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%f &quot;</span>,(p1-&gt;<a class="code" href="structParticle.html#ad2daa30c46725fb06d3922708ca2aa30">m</a>.<a class="code" href="structParticleMomentum.html#a25cac362b1f1e3a755404a162fd680d4">v</a>[k])*(p1-&gt;<a class="code" href="structParticle.html#ad2daa30c46725fb06d3922708ca2aa30">m</a>.<a class="code" href="structParticleMomentum.html#a25cac362b1f1e3a755404a162fd680d4">v</a>[l])*<a class="code" href="utils_8hpp.html#a747a977c2fbce6f4bba1f13d0de15463">PMASS</a>(*p1)/<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>/<a class="code" href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a>));</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          }</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;}\n&quot;</span>));</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="comment">/* bonded contributions */</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      j = 0;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">while</span>(j &lt; p1-&gt;bl.n) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        type_num = p1-&gt;<a class="code" href="structParticle.html#ab20bd287fa4358341c0a5ca07c9570f4">bl</a>.<a class="code" href="structIntList.html#affac668f39ec07e34ce56192a0b59800">e</a>[j++];</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        iaparams = &amp;<a class="code" href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a>[type_num];</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="comment">/* fetch particle 2 */</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        p2 = <a class="code" href="core_2particle__data_8cpp.html#a7e36bffb74f5a39c88ac12327e99cb22">local_particles</a>[p1-&gt;<a class="code" href="structParticle.html#ab20bd287fa4358341c0a5ca07c9570f4">bl</a>.<a class="code" href="structIntList.html#affac668f39ec07e34ce56192a0b59800">e</a>[j++]];</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <a class="code" href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a>(dx, p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, p2-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="pressure_8hpp.html#a63cbeaf712267c567e47b39fb92f6b33">calc_bonded_force</a>(p1,p2,iaparams,&amp;j,dx,force);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: Bonded to particle %d with force %f %f %f\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,p2-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">identity</a>,force[0],force[1],force[2]));</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">if</span> ((pow(force[0],2)+pow(force[1],2)+pow(force[2],2)) &gt; 0) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#adf55314b6e2da67f5735e2d3d26de133">distribute_tensors</a>(TensorInBin,force,bins,range_start,range,p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, p2-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="comment">// Loop cell neighbors</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">for</span> (n = 0; n &lt; <a class="code" href="domain__decomposition_8cpp.html#a3d049536fb2ac4c226a769ab2a975f07">dd</a>.<a class="code" href="structDomainDecomposition.html#a41754e4bca854c4a9622435f512ff07c">cell_inter</a>[c].<a class="code" href="structIA__Neighbor__List.html#addd6c25c7c5d5f984808df97a8ddc7d0">n_neighbors</a>; n++) {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      pairs = <a class="code" href="domain__decomposition_8cpp.html#a3d049536fb2ac4c226a769ab2a975f07">dd</a>.<a class="code" href="structDomainDecomposition.html#a41754e4bca854c4a9622435f512ff07c">cell_inter</a>[c].<a class="code" href="structIA__Neighbor__List.html#a57a761949d555b03a5f7047bfe689611">nList</a>[n].<a class="code" href="structIA__Neighbor.html#a965be7efdf36dd9df1370fb0b97ff4a3">vList</a>.<a class="code" href="structPairList.html#af85cef4ff8d62ccf56b5b535f676bc31">pair</a>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      np    = <a class="code" href="domain__decomposition_8cpp.html#a3d049536fb2ac4c226a769ab2a975f07">dd</a>.<a class="code" href="structDomainDecomposition.html#a41754e4bca854c4a9622435f512ff07c">cell_inter</a>[c].<a class="code" href="structIA__Neighbor__List.html#a57a761949d555b03a5f7047bfe689611">nList</a>[n].<a class="code" href="structIA__Neighbor.html#a965be7efdf36dd9df1370fb0b97ff4a3">vList</a>.<a class="code" href="structPairList.html#ab91cd6aac6969e0d7157e92ab4ee64bd">n</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="comment">// verlet list loop //</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;2*np; i+=2) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        p1 = pairs[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];                    <span class="comment">// pointer to particle 1</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        p2 = pairs[i+1];                  <span class="comment">// pointer to particle 2</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="pressure_8cpp.html#a47fafd818e7c52776203aa86aeff2d97">incubewithskin</a>(p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>,centre,range)) &amp;&amp; (<a class="code" href="pressure_8cpp.html#a47fafd818e7c52776203aa86aeff2d97">incubewithskin</a>(p2-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>,centre,range))) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;          <a class="code" href="pressure_8cpp.html#a338a7afac824c7e16dc819761e0e6afb">get_nonbonded_interaction</a>(p1,p2, force);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;          <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d:Looking at pair %d %d force is %f %f %f\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>,p1-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">identity</a>, p2-&gt;<a class="code" href="structParticle.html#a365b1c7973c523e5299d2456237c3553">p</a>.<a class="code" href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">identity</a>,force[0],force[1], force[2]));</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;          <span class="keywordflow">if</span> ((pow(force[0],2)+pow(force[1],2)+pow(force[2],2)) &gt; 0) {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="pressure_8cpp.html#adf55314b6e2da67f5735e2d3d26de133">distribute_tensors</a>(TensorInBin,force,bins,range_start,range,p1-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>, p2-&gt;<a class="code" href="structParticle.html#aeb172f49293421e3d0f03277453e320b">r</a>.<a class="code" href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">p</a>) != 1) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;          }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;          <span class="comment">// PTENSOR_TRACE(fprintf(stderr,&quot;%d:Looking at pair %d %d not in cube with skin\n&quot;,this_node,p1-&gt;p.identity, p2-&gt;p.identity));</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;bins[0]*bins[1]*bins[2];i++) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">for</span> (j=0;j&lt;9;j++) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        TensorInBin[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[j] /= binvolume;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;}</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">/************************************************************/</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#ab1c0f3ec8558bd7f3dedf251928f3a89"> 1037</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#ab1c0f3ec8558bd7f3dedf251928f3a89">observable_compute_stress_tensor</a>(<span class="keywordtype">int</span> v_comp, <span class="keywordtype">double</span> *A, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_A)</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordtype">double</span> value;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">double</span> p_vel[3];</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">/* if desired (v_comp==1) replace ideal component with instantaneous one */</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="keywordflow">if</span> (total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> != 1+v_comp ) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="pressure_8cpp.html#ab3e42f91592a3720bc84158dcd829438">init_virials</a>(&amp;total_pressure);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="pressure_8cpp.html#aa0789ed045d218aa6f34f4cfda6070c4">init_p_tensor</a>(&amp;total_p_tensor);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="pressure_8cpp.html#a0b54f0b700f60999a5885ffc339fe2e4">init_virials_non_bonded</a>(&amp;total_pressure_non_bonded);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <a class="code" href="pressure_8cpp.html#af72e1f4e076399cde1454da1ab661b83">init_p_tensor_non_bonded</a>(&amp;total_p_tensor_non_bonded);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">if</span>(v_comp &amp;&amp; (<a class="code" href="core_2integrate_8cpp.html#ad7c4aed24aaac428b38b1ba8dd684c2c">integ_switch</a> == <a class="code" href="integrate_8hpp.html#a1c868623330157021f98dd5bbed44134">INTEG_METHOD_NPT_ISO</a>) &amp;&amp; !(nptiso.<a class="code" href="structnptiso__struct.html#ae9bb34febbe4b3d9c621435b4ed2c1a8">invalidate_p_vel</a>)) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">if</span> (total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> == 0)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <a class="code" href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a>(0);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] = 0.0;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <a class="code" href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a>(nptiso.<a class="code" href="structnptiso__struct.html#a5253ba364000c1ff1214e20bc61dc2a6">p_vel</a>, p_vel, 3, <a class="code" href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, 0, <a class="code" href="mpi_8h.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">for</span>(i=0; i&lt;3; i++)</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordflow">if</span>(nptiso.<a class="code" href="structnptiso__struct.html#a01037bb45520eaba2e574ad5190738e2">geometry</a> &amp; nptiso.<a class="code" href="structnptiso__struct.html#a1f68bcad97f06e37ca623e7c27ffdec8">nptgeom_dir</a>[i])</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] += p_vel[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] /= (nptiso.<a class="code" href="structnptiso__struct.html#a19b3a404fc449cbfd8d43579b13f4d54">dimension</a>*nptiso.<a class="code" href="structnptiso__struct.html#a4a4502c51e3ccdfd47990df8294e86d6">volume</a>);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> = 1+v_comp;   }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <a class="code" href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a>(v_comp);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordflow">for</span>(j=0; j&lt;9; j++) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    value = total_p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[j];</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">for</span> (i = 1; i &lt; total_p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">n</a>/9; i++) value += total_p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[9*i + j];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    A[j]=value;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;}</div>
<div class="line"><a name="l01072"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#a2f8e36c3ada77fdabe7a79013a754aa0"> 1072</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="pressure_8cpp.html#a2f8e36c3ada77fdabe7a79013a754aa0">update_stress_tensor</a> (<span class="keywordtype">int</span> v_comp) {</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordtype">double</span> p_vel[3];</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="comment">/* if desired (v_comp==1) replace ideal component with instantaneous one */</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">if</span> (total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> != 1+v_comp ) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                <a class="code" href="pressure_8cpp.html#ab3e42f91592a3720bc84158dcd829438">init_virials</a>(&amp;total_pressure);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <a class="code" href="pressure_8cpp.html#aa0789ed045d218aa6f34f4cfda6070c4">init_p_tensor</a>(&amp;total_p_tensor);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                <a class="code" href="pressure_8cpp.html#a0b54f0b700f60999a5885ffc339fe2e4">init_virials_non_bonded</a>(&amp;total_pressure_non_bonded);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                <a class="code" href="pressure_8cpp.html#af72e1f4e076399cde1454da1ab661b83">init_p_tensor_non_bonded</a>(&amp;total_p_tensor_non_bonded);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                <span class="keywordflow">if</span>(v_comp &amp;&amp; (<a class="code" href="core_2integrate_8cpp.html#ad7c4aed24aaac428b38b1ba8dd684c2c">integ_switch</a> == <a class="code" href="integrate_8hpp.html#a1c868623330157021f98dd5bbed44134">INTEG_METHOD_NPT_ISO</a>) &amp;&amp; !(nptiso.<a class="code" href="structnptiso__struct.html#ae9bb34febbe4b3d9c621435b4ed2c1a8">invalidate_p_vel</a>)) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                        <span class="keywordflow">if</span> (total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> == 0)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                <a class="code" href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a>(0);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                        p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] = 0.0;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                        <a class="code" href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a>(nptiso.<a class="code" href="structnptiso__struct.html#a5253ba364000c1ff1214e20bc61dc2a6">p_vel</a>, p_vel, 3, <a class="code" href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, 0, <a class="code" href="mpi_8h.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                        <span class="keywordflow">for</span>(i=0; i&lt;3; i++)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                <span class="keywordflow">if</span>(nptiso.<a class="code" href="structnptiso__struct.html#a01037bb45520eaba2e574ad5190738e2">geometry</a> &amp; nptiso.<a class="code" href="structnptiso__struct.html#a1f68bcad97f06e37ca623e7c27ffdec8">nptgeom_dir</a>[i])</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                        p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] += p_vel[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        p_tensor.<a class="code" href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">data</a>.<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[0] /= (nptiso.<a class="code" href="structnptiso__struct.html#a19b3a404fc449cbfd8d43579b13f4d54">dimension</a>*nptiso.<a class="code" href="structnptiso__struct.html#a4a4502c51e3ccdfd47990df8294e86d6">volume</a>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        total_pressure.<a class="code" href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">init_status</a> = 1+v_comp;   }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                        <a class="code" href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a>(v_comp);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"><a class="line" href="pressure_8hpp.html#ae8ef59c15cbdd5bb4cf5cf0790ca6cb1"> 1098</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="pressure_8cpp.html#ae8ef59c15cbdd5bb4cf5cf0790ca6cb1">analyze_local_stress_tensor</a>(<span class="keywordtype">int</span>* <a class="code" href="grid_8cpp.html#a071976c64226ce571f994f68f8b8a13f">periodic</a>, <span class="keywordtype">double</span>* range_start, <span class="keywordtype">double</span>* range, <span class="keywordtype">int</span>* bins, <a class="code" href="structDoubleList.html">DoubleList</a>* local_stress_tensor)</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;{</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,j;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <a class="code" href="structDoubleList.html">DoubleList</a> *TensorInBin;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: Running tclcommand_analyze_parse_local_stress_tensor\n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>));</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="comment">/* Allocate a doublelist of bins to keep track of stress profile */</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        TensorInBin = (<a class="code" href="structDoubleList.html">DoubleList</a> *)<a class="code" href="debug_8hpp.html#a6bb12c9cae32ecd32a4584a86c4c6c99">malloc</a>(bins[0]*bins[1]*bins[2]*<span class="keyword">sizeof</span>(<a class="code" href="structDoubleList.html">DoubleList</a>));</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">if</span> ( TensorInBin ) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="comment">/* Initialize the stress profile */</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                <span class="keywordflow">for</span> ( i = 0 ; i &lt; bins[0]*bins[1]*bins[2]; i++ ) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                        <a class="code" href="utils_8hpp.html#a5a8ea4876559bd3af1a84594d8055b69">init_doublelist</a>(&amp;TensorInBin[i]);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                        <a class="code" href="utils_8hpp.html#aba2a993dd4ce98970051131d40d77338">alloc_doublelist</a>(&amp;TensorInBin[i],9);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        <span class="keywordflow">for</span> ( j = 0 ; j &lt; 9 ; j++ ) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                                TensorInBin[<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">e</a>[j] = 0.0;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                        }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                fprintf(stderr, <span class="stringliteral">&quot;could not allocate memory for local_stress_tensor&quot;</span>);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="keywordflow">return</span> (<a class="code" href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <a class="code" href="communication_8cpp.html#ac46836986b2a7d77b63f1e4055f5c1a8">mpi_local_stress_tensor</a>(TensorInBin, bins, periodic,range_start, range);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <a class="code" href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a>(fprintf(stderr,<span class="stringliteral">&quot;%d: tclcommand_analyze_parse_local_stress_tensor: finished mpi_local_stress_tensor \n&quot;</span>,<a class="code" href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a>));</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">//      /* Write stress profile to Tcl export */</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">//      Tcl_AppendResult(interp, &quot;{ LocalStressTensor } &quot;, (char *)NULL);</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">//      for ( i = 0 ; i &lt; bins[0] ; i++) {</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">//              for ( j = 0 ; j &lt; bins[1] ; j++) {</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">//                      for ( k = 0 ; k &lt; bins[2] ; k++) {</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">//                              Tcl_AppendResult(interp, &quot; { &quot;, (char *)NULL);</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">//                              sprintf(buffer,&quot; { %d %d %d } &quot;,i,j,k);</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">//                              Tcl_AppendResult(interp,buffer, (char *)NULL);</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">//                              Tcl_AppendResult(interp, &quot; { &quot;, (char *)NULL);</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">//                              for ( l = 0 ; l &lt; 9 ; l++) {</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">//                                      Tcl_PrintDouble(interp,TensorInBin[i*bins[1]*bins[2]+j*bins[2]+k].e[l],buffer);</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">//                                      Tcl_AppendResult(interp, buffer, (char *)NULL);</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">//                                      Tcl_AppendResult(interp, &quot; &quot;, (char *)NULL);</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">//                              }</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">//                              Tcl_AppendResult(interp, &quot; } &quot;, (char *)NULL);</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">//                              Tcl_AppendResult(interp, &quot; } &quot;, (char *)NULL);</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">//                      }</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">//              }</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="utils_8hpp.html#a37474faad5e05ca5d6c2464f2f4aa27d">ES_OK</a>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div>
<div class="ttc" id="pressure_8cpp_html_a549dfcf24c7ae9a096808c3b032a9a80"><div class="ttname"><a href="pressure_8cpp.html#a549dfcf24c7ae9a096808c3b032a9a80">virials_non_bonded</a></div><div class="ttdeci">Observable_stat_non_bonded virials_non_bonded</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00040">pressure.cpp:40</a></div></div>
<div class="ttc" id="debug_8hpp_html_a47d4aef42890eb276ea7f81b7ab5e6ca"><div class="ttname"><a href="debug_8hpp.html#a47d4aef42890eb276ea7f81b7ab5e6ca">PTENSOR_TRACE</a></div><div class="ttdeci">#define PTENSOR_TRACE(cmd)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8hpp_source.html#l00269">debug.hpp:269</a></div></div>
<div class="ttc" id="structnptiso__struct_html_a1f68bcad97f06e37ca623e7c27ffdec8"><div class="ttname"><a href="structnptiso__struct.html#a1f68bcad97f06e37ca623e7c27ffdec8">nptiso_struct::nptgeom_dir</a></div><div class="ttdeci">int nptgeom_dir[3]</div><div class="ttdoc">bitwise comparison values corresponding to different directions </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00067">npt.hpp:67</a></div></div>
<div class="ttc" id="structParticle_html_ad2daa30c46725fb06d3922708ca2aa30"><div class="ttname"><a href="structParticle.html#ad2daa30c46725fb06d3922708ca2aa30">Particle::m</a></div><div class="ttdeci">ParticleMomentum m</div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00291">particle_data.hpp:291</a></div></div>
<div class="ttc" id="structParticlePosition_html_a1859189b20ddc6a4f92529e4cfcdc9fb"><div class="ttname"><a href="structParticlePosition.html#a1859189b20ddc6a4f92529e4cfcdc9fb">ParticlePosition::p</a></div><div class="ttdeci">double p[3]</div><div class="ttdoc">periodically folded position. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00182">particle_data.hpp:182</a></div></div>
<div class="ttc" id="cells_8cpp_html_a90d2b85cd831c48d6b2e211eabadadd7"><div class="ttname"><a href="cells_8cpp.html#a90d2b85cd831c48d6b2e211eabadadd7">cell_structure</a></div><div class="ttdeci">CellStructure cell_structure</div><div class="ttdoc">Type of cell structure in use. </div><div class="ttdef"><b>Definition:</b> <a href="cells_8cpp_source.html#l00057">cells.cpp:57</a></div></div>
<div class="ttc" id="structCellPList_html_a5e048c4df0720361e87fc32960e240e2"><div class="ttname"><a href="structCellPList.html#a5e048c4df0720361e87fc32960e240e2">CellPList::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="cells_8hpp_source.html#l00120">cells.hpp:120</a></div></div>
<div class="ttc" id="structCoulomb__parameters_html_af20ba286b510d86e358153664da69172"><div class="ttname"><a href="structCoulomb__parameters.html#af20ba286b510d86e358153664da69172">Coulomb_parameters::Dmethod</a></div><div class="ttdeci">DipolarInteration Dmethod</div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00533">interaction_data.hpp:533</a></div></div>
<div class="ttc" id="pressure_8cpp_html_adf55314b6e2da67f5735e2d3d26de133"><div class="ttname"><a href="pressure_8cpp.html#adf55314b6e2da67f5735e2d3d26de133">distribute_tensors</a></div><div class="ttdeci">int distribute_tensors(DoubleList *TensorInBin, double *force, int bins[3], double range_start[3], double range[3], double pos1[3], double pos2[3])</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00528">pressure.cpp:528</a></div></div>
<div class="ttc" id="structPairList_html_ab91cd6aac6969e0d7157e92ab4ee64bd"><div class="ttname"><a href="structPairList.html#ab91cd6aac6969e0d7157e92ab4ee64bd">PairList::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">Number of pairs contained. </div><div class="ttdef"><b>Definition:</b> <a href="verlet_8hpp_source.html#l00066">verlet.hpp:66</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a2f8e36c3ada77fdabe7a79013a754aa0"><div class="ttname"><a href="pressure_8cpp.html#a2f8e36c3ada77fdabe7a79013a754aa0">update_stress_tensor</a></div><div class="ttdeci">void update_stress_tensor(int v_comp)</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l01072">pressure.cpp:1072</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ad568113942dba4c44d094998cb173659"><div class="ttname"><a href="pressure_8cpp.html#ad568113942dba4c44d094998cb173659">virials</a></div><div class="ttdeci">Observable_stat virials</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00033">pressure.cpp:33</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a73295187f4571fbfac9e1c13d3b82469"><div class="ttname"><a href="pressure_8cpp.html#a73295187f4571fbfac9e1c13d3b82469">getintersection</a></div><div class="ttdeci">int getintersection(double pos1[3], double pos2[3], int given, int get, double value, double *answer, double box_size[3])</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00360">pressure.cpp:360</a></div></div>
<div class="ttc" id="structnptiso__struct_html_a01037bb45520eaba2e574ad5190738e2"><div class="ttname"><a href="structnptiso__struct.html#a01037bb45520eaba2e574ad5190738e2">nptiso_struct::geometry</a></div><div class="ttdeci">int geometry</div><div class="ttdoc">geometry information for the npt integrator. </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00065">npt.hpp:65</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a93de7ce3dee66c458e50911c1fcd3139"><div class="ttname"><a href="pressure_8cpp.html#a93de7ce3dee66c458e50911c1fcd3139">does_line_go_through_cube</a></div><div class="ttdeci">int does_line_go_through_cube(double pos1[3], double pos2[3], double range_start[3], double range[3], int sign[3], double entry[3], double exit[3], int *facein, int *faceout)</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00416">pressure.cpp:416</a></div></div>
<div class="ttc" id="cells_8hpp_html"><div class="ttname"><a href="cells_8hpp.html">cells.hpp</a></div><div class="ttdoc">This file contains everything related to the cell structure / cell system. </div></div>
<div class="ttc" id="structObservable__stat_html"><div class="ttname"><a href="structObservable__stat.html">Observable_stat</a></div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00043">statistics.hpp:43</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_af35bbb757587c54195a4ed75a6bc240aa6a8537a6d2a194c2216a8718ad709379"><div class="ttname"><a href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa6a8537a6d2a194c2216a8718ad709379">DIPOLAR_NONE</a></div><div class="ttdoc">dipolar interation switched off (NONE). </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00166">interaction_data.hpp:166</a></div></div>
<div class="ttc" id="structDomainDecomposition_html_a5fc123c6c4569b6d75eb38d52813e555"><div class="ttname"><a href="structDomainDecomposition.html#a5fc123c6c4569b6d75eb38d52813e555">DomainDecomposition::use_vList</a></div><div class="ttdeci">int use_vList</div><div class="ttdoc">flag for using Verlet List </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8hpp_source.html#l00108">domain_decomposition.hpp:108</a></div></div>
<div class="ttc" id="structDoubleList_html"><div class="ttname"><a href="structDoubleList.html">DoubleList</a></div><div class="ttdoc">Double list. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00090">utils.hpp:90</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_af35bbb757587c54195a4ed75a6bc240aa706a967eb8a0cbe56e7d0d7f7098e405"><div class="ttname"><a href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa706a967eb8a0cbe56e7d0d7f7098e405">DIPOLAR_P3M</a></div><div class="ttdoc">dipolar method is P3M. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00168">interaction_data.hpp:168</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ab4c6c64a8963c5f8cf0d2be205a380d8"><div class="ttname"><a href="pressure_8cpp.html#ab4c6c64a8963c5f8cf0d2be205a380d8">total_pressure_non_bonded</a></div><div class="ttdeci">Observable_stat_non_bonded total_pressure_non_bonded</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00041">pressure.cpp:41</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96af540dbc00e6ca3d796715665beb13826"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af540dbc00e6ca3d796715665beb13826">COULOMB_MMM1D_GPU</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00148">interaction_data.hpp:148</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a0b54f0b700f60999a5885ffc339fe2e4"><div class="ttname"><a href="pressure_8cpp.html#a0b54f0b700f60999a5885ffc339fe2e4">init_virials_non_bonded</a></div><div class="ttdeci">void init_virials_non_bonded(Observable_stat_non_bonded *stat_nb)</div><div class="ttdoc">Initializes a virials Observable stat. </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00279">pressure.cpp:279</a></div></div>
<div class="ttc" id="structIntList_html_affac668f39ec07e34ce56192a0b59800"><div class="ttname"><a href="structIntList.html#affac668f39ec07e34ce56192a0b59800">IntList::e</a></div><div class="ttdeci">int * e</div><div class="ttdoc">Dynamically allocated integer field. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00080">utils.hpp:80</a></div></div>
<div class="ttc" id="core_2integrate_8cpp_html_a1fad9813185ba0cb89981455e59b1408"><div class="ttname"><a href="core_2integrate_8cpp.html#a1fad9813185ba0cb89981455e59b1408">skin</a></div><div class="ttdeci">double skin</div><div class="ttdoc">Verlet list skin. </div><div class="ttdef"><b>Definition:</b> <a href="core_2integrate_8cpp_source.html#l00086">core/integrate.cpp:86</a></div></div>
<div class="ttc" id="statistics_8cpp_html_a7e48544751e562cabfefc56b7987ed70"><div class="ttname"><a href="statistics_8cpp.html#a7e48544751e562cabfefc56b7987ed70">obsstat_realloc_and_clear_non_bonded</a></div><div class="ttdeci">void obsstat_realloc_and_clear_non_bonded(Observable_stat_non_bonded *stat_nb, int n_nonbonded, int c_size)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8cpp_source.html#l01444">statistics.cpp:1444</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a67772df29a4e767ec0ad6f2ae56ce2cb"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a67772df29a4e767ec0ad6f2ae56ce2cb">COULOMB_EWALD_GPU</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00149">interaction_data.hpp:149</a></div></div>
<div class="ttc" id="integrate_8hpp_html_a15cf595e04616281674463717a3d1000"><div class="ttname"><a href="integrate_8hpp.html#a15cf595e04616281674463717a3d1000">max_cut</a></div><div class="ttdeci">double max_cut</div><div class="ttdoc">Maximal interaction cutoff. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00100">interaction_data.cpp:100</a></div></div>
<div class="ttc" id="utils_8hpp_html_aba2a993dd4ce98970051131d40d77338"><div class="ttname"><a href="utils_8hpp.html#aba2a993dd4ce98970051131d40d77338">alloc_doublelist</a></div><div class="ttdeci">void alloc_doublelist(DoubleList *dl, int size)</div><div class="ttdoc">Allocate an DoubleList of size size. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00241">utils.hpp:241</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ae8ef59c15cbdd5bb4cf5cf0790ca6cb1"><div class="ttname"><a href="pressure_8cpp.html#ae8ef59c15cbdd5bb4cf5cf0790ca6cb1">analyze_local_stress_tensor</a></div><div class="ttdeci">int analyze_local_stress_tensor(int *periodic, double *range_start, double *range, int *bins, DoubleList *local_stress_tensor)</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l01098">pressure.cpp:1098</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a894cae385bba4318094c3ee3b9d1906b"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a894cae385bba4318094c3ee3b9d1906b">COULOMB_ELC_P3M</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00144">interaction_data.hpp:144</a></div></div>
<div class="ttc" id="mpi_8h_html_aa058ba472f0fd41ae860caeaebca0166"><div class="ttname"><a href="mpi_8h.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a></div><div class="ttdeci">#define MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8h_source.html#l00089">mpi.h:89</a></div></div>
<div class="ttc" id="communication_8cpp_html_ac46836986b2a7d77b63f1e4055f5c1a8"><div class="ttname"><a href="communication_8cpp.html#ac46836986b2a7d77b63f1e4055f5c1a8">mpi_local_stress_tensor</a></div><div class="ttdeci">void mpi_local_stress_tensor(DoubleList *TensorInBin, int bins[3], int periodic[3], double range_start[3], double range[3])</div><div class="ttdoc">Issue GET_LOCAL_STRESS_TENSOR: gather the contribution to the local stress tensors from each node...</div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l01504">communication.cpp:1504</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a4e633be467e779cb5828994c8c7d373c"><div class="ttname"><a href="pressure_8cpp.html#a4e633be467e779cb5828994c8c7d373c">p_tensor_non_bonded</a></div><div class="ttdeci">Observable_stat_non_bonded p_tensor_non_bonded</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00042">pressure.cpp:42</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a825c6d4e7a14e8b23ff57844dc749ee5"><div class="ttname"><a href="pressure_8cpp.html#a825c6d4e7a14e8b23ff57844dc749ee5">total_p_tensor_non_bonded</a></div><div class="ttdeci">Observable_stat_non_bonded total_p_tensor_non_bonded</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00043">pressure.cpp:43</a></div></div>
<div class="ttc" id="structParticle_html_ab20bd287fa4358341c0a5ca07c9570f4"><div class="ttname"><a href="structParticle.html#ab20bd287fa4358341c0a5ca07c9570f4">Particle::bl</a></div><div class="ttdeci">IntList bl</div><div class="ttdoc">bonded interactions list. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00303">particle_data.hpp:303</a></div></div>
<div class="ttc" id="reaction__field_8hpp_html_af9a0d4b7fc39860d587ef27b2f690555"><div class="ttname"><a href="reaction__field_8hpp.html#af9a0d4b7fc39860d587ef27b2f690555">add_rf_coulomb_pair_force</a></div><div class="ttdeci">void add_rf_coulomb_pair_force(Particle *p1, Particle *p2, double d[3], double dist, double force[3])</div><div class="ttdoc">Computes the Reaction Field pair force and adds this force to the particle forces (see tclcommand_int...</div><div class="ttdef"><b>Definition:</b> <a href="reaction__field_8hpp_source.html#l00084">reaction_field.hpp:84</a></div></div>
<div class="ttc" id="lbgpu_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="lbgpu_8cpp_source.html#l00161">lbgpu.cpp:161</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a26086c6865b7d69f8b395b6c7e5e3f93"><div class="ttname"><a href="pressure_8cpp.html#a26086c6865b7d69f8b395b6c7e5e3f93">local_stress_tensor_calc</a></div><div class="ttdeci">int local_stress_tensor_calc(DoubleList *TensorInBin, int bins[3], int periodic[3], double range_start[3], double range[3])</div><div class="ttdoc">implementation of &#39;analyse local_stress_tensor </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00910">pressure.cpp:910</a></div></div>
<div class="ttc" id="verlet_8cpp_html_a41114956599ffa747f472804e7372739"><div class="ttname"><a href="verlet_8cpp.html#a41114956599ffa747f472804e7372739">build_verlet_lists</a></div><div class="ttdeci">void build_verlet_lists()</div><div class="ttdoc">Fill verlet tables. </div><div class="ttdef"><b>Definition:</b> <a href="verlet_8cpp_source.html#l00095">verlet.cpp:95</a></div></div>
<div class="ttc" id="structParticleProperties_html_aff59dca9a266f6720196cf06ac7a00d3"><div class="ttname"><a href="structParticleProperties.html#aff59dca9a266f6720196cf06ac7a00d3">ParticleProperties::type</a></div><div class="ttdeci">int type</div><div class="ttdoc">particle type, used for non bonded interactions. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00081">particle_data.hpp:81</a></div></div>
<div class="ttc" id="structParticleProperties_html_a45ec75b5967dbfd13d106a7dd8644cc1"><div class="ttname"><a href="structParticleProperties.html#a45ec75b5967dbfd13d106a7dd8644cc1">ParticleProperties::identity</a></div><div class="ttdeci">int identity</div><div class="ttdoc">unique identifier for the particle. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00077">particle_data.hpp:77</a></div></div>
<div class="ttc" id="utils_8hpp_html_a008137b55395036613fb97c40e7ba8b5"><div class="ttname"><a href="utils_8hpp.html#a008137b55395036613fb97c40e7ba8b5">SQR</a></div><div class="ttdeci">double SQR(double x)</div><div class="ttdoc">Calculates the SQuaRe of &#39;double&#39; x, returning &#39;double&#39;. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00346">utils.hpp:346</a></div></div>
<div class="ttc" id="pressure_8hpp_html"><div class="ttname"><a href="pressure_8hpp.html">pressure.hpp</a></div><div class="ttdoc">Pressure calculation. </div></div>
<div class="ttc" id="pressure_8cpp_html_ae6eeaf48657a74e6fe79dd91528c0da5"><div class="ttname"><a href="pressure_8cpp.html#ae6eeaf48657a74e6fe79dd91528c0da5">nptiso</a></div><div class="ttdeci">nptiso_struct nptiso</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00045">pressure.cpp:45</a></div></div>
<div class="ttc" id="domain__decomposition_8cpp_html_a3d049536fb2ac4c226a769ab2a975f07"><div class="ttname"><a href="domain__decomposition_8cpp.html#a3d049536fb2ac4c226a769ab2a975f07">dd</a></div><div class="ttdeci">DomainDecomposition dd</div><div class="ttdoc">Information about the domain decomposition. </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8cpp_source.html#l00057">domain_decomposition.cpp:57</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a0ce43e74c2f61c6e954e2d124649dc5b"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a0ce43e74c2f61c6e954e2d124649dc5b">COULOMB_INTER_RF</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00146">interaction_data.hpp:146</a></div></div>
<div class="ttc" id="structIA__Neighbor__List_html_addd6c25c7c5d5f984808df97a8ddc7d0"><div class="ttname"><a href="structIA__Neighbor__List.html#addd6c25c7c5d5f984808df97a8ddc7d0">IA_Neighbor_List::n_neighbors</a></div><div class="ttdeci">int n_neighbors</div><div class="ttdoc">number of interacting neighbor cells . </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8hpp_source.html#l00100">domain_decomposition.hpp:100</a></div></div>
<div class="ttc" id="pressure_8cpp_html_aa3cead5da74a7621c1d7b6da7f0d77b9"><div class="ttname"><a href="pressure_8cpp.html#aa3cead5da74a7621c1d7b6da7f0d77b9">p_tensor</a></div><div class="ttdeci">Observable_stat p_tensor</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00035">pressure.cpp:35</a></div></div>
<div class="ttc" id="nsquare_8hpp_html"><div class="ttname"><a href="nsquare_8hpp.html">nsquare.hpp</a></div><div class="ttdoc">This file contains the code for a simple n^2 particle loop. </div></div>
<div class="ttc" id="structDomainDecomposition_html_a41754e4bca854c4a9622435f512ff07c"><div class="ttname"><a href="structDomainDecomposition.html#a41754e4bca854c4a9622435f512ff07c">DomainDecomposition::cell_inter</a></div><div class="ttdeci">IA_Neighbor_List * cell_inter</div><div class="ttdoc">Array containing information about the interactions between the cells. </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8hpp_source.html#l00119">domain_decomposition.hpp:119</a></div></div>
<div class="ttc" id="utils_8hpp_html_ac110bac59d287179e3c5436056a083aa"><div class="ttname"><a href="utils_8hpp.html#ac110bac59d287179e3c5436056a083aa">dround</a></div><div class="ttdeci">double dround(double x)</div><div class="ttdoc">Mathematically rounds &#39;double&#39;-typed x, returning &#39;double&#39;. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00343">utils.hpp:343</a></div></div>
<div class="ttc" id="structParticleList_html_a3ed5f48ed3201b209dc585be8f4c44f9"><div class="ttname"><a href="structParticleList.html#a3ed5f48ed3201b209dc585be8f4c44f9">ParticleList::part</a></div><div class="ttdeci">Particle * part</div><div class="ttdoc">The particles payload. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00322">particle_data.hpp:322</a></div></div>
<div class="ttc" id="npt_8hpp_html_ad668c3a70323bb182cca9c9e4e15485c"><div class="ttname"><a href="npt_8hpp.html#ad668c3a70323bb182cca9c9e4e15485c">NPTGEOM_XDIR</a></div><div class="ttdeci">#define NPTGEOM_XDIR</div><div class="ttdoc">Allowable values for nptiso.geometry. </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00080">npt.hpp:80</a></div></div>
<div class="ttc" id="debug_8hpp_html_a6bb12c9cae32ecd32a4584a86c4c6c99"><div class="ttname"><a href="debug_8hpp.html#a6bb12c9cae32ecd32a4584a86c4c6c99">malloc</a></div><div class="ttdeci">#define malloc(s)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8hpp_source.html#l00040">debug.hpp:40</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_afb12463efc2793b7393589d011605331"><div class="ttname"><a href="interaction__data_8cpp.html#afb12463efc2793b7393589d011605331">n_particle_types</a></div><div class="ttdeci">int n_particle_types</div><div class="ttdoc">Maximal particle type seen so far. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00070">interaction_data.cpp:70</a></div></div>
<div class="ttc" id="cells_8hpp_html_a1a57771fcddf625920ffe20eb9bd5357"><div class="ttname"><a href="cells_8hpp.html#a1a57771fcddf625920ffe20eb9bd5357">CELL_STRUCTURE_LAYERED</a></div><div class="ttdeci">#define CELL_STRUCTURE_LAYERED</div><div class="ttdoc">cell structure layered </div><div class="ttdef"><b>Definition:</b> <a href="cells_8hpp_source.html#l00081">cells.hpp:81</a></div></div>
<div class="ttc" id="communication_8cpp_html_aded0066a6f7a450b6d51676425127bb0"><div class="ttname"><a href="communication_8cpp.html#aded0066a6f7a450b6d51676425127bb0">this_node</a></div><div class="ttdeci">int this_node</div><div class="ttdoc">The number of this node. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00075">communication.cpp:75</a></div></div>
<div class="ttc" id="layered_8hpp_html"><div class="ttname"><a href="layered_8hpp.html">layered.hpp</a></div><div class="ttdoc">The layered cellsystem. </div></div>
<div class="ttc" id="structIA__Neighbor_html_a965be7efdf36dd9df1370fb0b97ff4a3"><div class="ttname"><a href="structIA__Neighbor.html#a965be7efdf36dd9df1370fb0b97ff4a3">IA_Neighbor::vList</a></div><div class="ttdeci">PairList vList</div><div class="ttdoc">Verlet list for non bonded interactions of a cell with a neighbor cell. </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8hpp_source.html#l00072">domain_decomposition.hpp:72</a></div></div>
<div class="ttc" id="structParticleList_html_a320bc471ea3907e6ae1a96bf774ba715"><div class="ttname"><a href="structParticleList.html#a320bc471ea3907e6ae1a96bf774ba715">ParticleList::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">Number of particles contained. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00324">particle_data.hpp:324</a></div></div>
<div class="ttc" id="grid_8hpp_html_a2d8075c3dfa4364a1dcb28c4a4835067"><div class="ttname"><a href="grid_8hpp.html#a2d8075c3dfa4364a1dcb28c4a4835067">get_mi_vector</a></div><div class="ttdeci">void get_mi_vector(double res[3], double a[3], double b[3])</div><div class="ttdoc">get the minimal distance vector of two vectors in the current bc. </div><div class="ttdef"><b>Definition:</b> <a href="grid_8hpp_source.html#l00190">grid.hpp:190</a></div></div>
<div class="ttc" id="structParticleMomentum_html_a25cac362b1f1e3a755404a162fd680d4"><div class="ttname"><a href="structParticleMomentum.html#a25cac362b1f1e3a755404a162fd680d4">ParticleMomentum::v</a></div><div class="ttdeci">double v[3]</div><div class="ttdoc">velocity. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00228">particle_data.hpp:228</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ad44a2f2828031534357e913f39d582ea"><div class="ttname"><a href="pressure_8cpp.html#ad44a2f2828031534357e913f39d582ea">whichbin</a></div><div class="ttdeci">int whichbin(double pos[3], int bins[3], double centre[3], double range[3], int *bin)</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00812">pressure.cpp:812</a></div></div>
<div class="ttc" id="structBonded__ia__parameters_html"><div class="ttname"><a href="structBonded__ia__parameters.html">Bonded_ia_parameters</a></div><div class="ttdoc">Defines parameters for a bonded interaction. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00883">interaction_data.hpp:883</a></div></div>
<div class="ttc" id="structParticle_html_a365b1c7973c523e5299d2456237c3553"><div class="ttname"><a href="structParticle.html#a365b1c7973c523e5299d2456237c3553">Particle::p</a></div><div class="ttdeci">ParticleProperties p</div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00287">particle_data.hpp:287</a></div></div>
<div class="ttc" id="virtual__sites__relative_8cpp_html_a2f3248e72062244478a8bfa3bd40987d"><div class="ttname"><a href="virtual__sites__relative_8cpp.html#a2f3248e72062244478a8bfa3bd40987d">vs_relative_pressure_and_stress_tensor</a></div><div class="ttdeci">void vs_relative_pressure_and_stress_tensor(double *pressure, double *stress_tensor)</div><div class="ttdef"><b>Definition:</b> <a href="virtual__sites__relative_8cpp_source.html#l00297">virtual_sites_relative.cpp:297</a></div></div>
<div class="ttc" id="npt_8hpp_html_a10ec55a2cc0f0c2ea6b56b6286aa2db9"><div class="ttname"><a href="npt_8hpp.html#a10ec55a2cc0f0c2ea6b56b6286aa2db9">NPTGEOM_ZDIR</a></div><div class="ttdeci">#define NPTGEOM_ZDIR</div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00082">npt.hpp:82</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a78e53a0529d64f84379014a79b0d0b22"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a78e53a0529d64f84379014a79b0d0b22">COULOMB_RF</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00145">interaction_data.hpp:145</a></div></div>
<div class="ttc" id="structObservable__stat__non__bonded_html_aa975746c93f217ecc3404cb8f92aa8c9"><div class="ttname"><a href="structObservable__stat__non__bonded.html#aa975746c93f217ecc3404cb8f92aa8c9">Observable_stat_non_bonded::data_nb</a></div><div class="ttdeci">DoubleList data_nb</div><div class="ttdoc">Array for observables on each node. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00086">statistics.hpp:86</a></div></div>
<div class="ttc" id="structnptiso__struct_html_a5253ba364000c1ff1214e20bc61dc2a6"><div class="ttname"><a href="structnptiso__struct.html#a5253ba364000c1ff1214e20bc61dc2a6">nptiso_struct::p_vel</a></div><div class="ttdeci">double p_vel[3]</div><div class="ttdoc">ideal gas components of p_inst, derived from the velocities </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00056">npt.hpp:56</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96aced9f662b92362c64980251d3d9f429d"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96aced9f662b92362c64980251d3d9f429d">COULOMB_MMM1D</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00141">interaction_data.hpp:141</a></div></div>
<div class="ttc" id="pressure_8cpp_html_aeee2dc2fd6274ff5573a23dba7e7d0fc"><div class="ttname"><a href="pressure_8cpp.html#aeee2dc2fd6274ff5573a23dba7e7d0fc">getlength</a></div><div class="ttdeci">int getlength(double pos1[3], double pos2[3], int d1, double val1, int d2, double val2, int l, double *answer)</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00394">pressure.cpp:394</a></div></div>
<div class="ttc" id="structParticle_html"><div class="ttname"><a href="structParticle.html">Particle</a></div><div class="ttdoc">Struct holding all information for one particle. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00285">particle_data.hpp:285</a></div></div>
<div class="ttc" id="cells_8hpp_html_a5a7ff12df067824e6a37604b74d75f62"><div class="ttname"><a href="cells_8hpp.html#a5a7ff12df067824e6a37604b74d75f62">CELL_STRUCTURE_NSQUARE</a></div><div class="ttdeci">#define CELL_STRUCTURE_NSQUARE</div><div class="ttdoc">cell structure n square </div><div class="ttdef"><b>Definition:</b> <a href="cells_8hpp_source.html#l00079">cells.hpp:79</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a57749426446c1fa84ed774089d735a5f"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a57749426446c1fa84ed774089d735a5f">COULOMB_P3M</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00140">interaction_data.hpp:140</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_af35bbb757587c54195a4ed75a6bc240aa24204fef27dc4cd941ebeb09234199b9"><div class="ttname"><a href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa24204fef27dc4cd941ebeb09234199b9">DIPOLAR_ALL_WITH_ALL_AND_NO_REPLICA</a></div><div class="ttdoc">Dipolar method is all with all and no replicas. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00172">interaction_data.hpp:172</a></div></div>
<div class="ttc" id="structObservable__stat_html_a86067c750282e9e3340525cdab0124b7"><div class="ttname"><a href="structObservable__stat.html#a86067c750282e9e3340525cdab0124b7">Observable_stat::data</a></div><div class="ttdeci">DoubleList data</div><div class="ttdoc">Array for observables on each node. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00051">statistics.hpp:51</a></div></div>
<div class="ttc" id="utils_8hpp_html_a5a8ea4876559bd3af1a84594d8055b69"><div class="ttname"><a href="utils_8hpp.html#a5a8ea4876559bd3af1a84594d8055b69">init_doublelist</a></div><div class="ttdeci">void init_doublelist(DoubleList *il)</div><div class="ttdoc">Initialize an DoubleList. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00232">utils.hpp:232</a></div></div>
<div class="ttc" id="initialize_8hpp_html"><div class="ttname"><a href="initialize_8hpp.html">initialize.hpp</a></div><div class="ttdoc">This file contains the hook procedures. </div></div>
<div class="ttc" id="pressure_8cpp_html_a338a7afac824c7e16dc819761e0e6afb"><div class="ttname"><a href="pressure_8cpp.html#a338a7afac824c7e16dc819761e0e6afb">get_nonbonded_interaction</a></div><div class="ttdeci">int get_nonbonded_interaction(Particle *p1, Particle *p2, double *force)</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00828">pressure.cpp:828</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a98db3a3951cc30178873115d8be68fc3"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a98db3a3951cc30178873115d8be68fc3">COULOMB_DH</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00139">interaction_data.hpp:139</a></div></div>
<div class="ttc" id="structDoubleList_html_a255149a3e4f67167e82c0206fb767384"><div class="ttname"><a href="structDoubleList.html#a255149a3e4f67167e82c0206fb767384">DoubleList::e</a></div><div class="ttdeci">double * e</div><div class="ttdoc">Dynamically allocated double field. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00092">utils.hpp:92</a></div></div>
<div class="ttc" id="core_2particle__data_8cpp_html_a7e36bffb74f5a39c88ac12327e99cb22"><div class="ttname"><a href="core_2particle__data_8cpp.html#a7e36bffb74f5a39c88ac12327e99cb22">local_particles</a></div><div class="ttdeci">Particle ** local_particles</div><div class="ttdoc">id->particle mapping on all nodes. </div><div class="ttdef"><b>Definition:</b> <a href="core_2particle__data_8cpp_source.html#l00072">core/particle_data.cpp:72</a></div></div>
<div class="ttc" id="structnptiso__struct_html_a19b3a404fc449cbfd8d43579b13f4d54"><div class="ttname"><a href="structnptiso__struct.html#a19b3a404fc449cbfd8d43579b13f4d54">nptiso_struct::dimension</a></div><div class="ttdeci">int dimension</div><div class="ttdoc">The number of dimensions in which npt boxlength motion is coupled to particles. </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00069">npt.hpp:69</a></div></div>
<div class="ttc" id="virtual__sites__relative_8hpp_html"><div class="ttname"><a href="virtual__sites__relative_8hpp.html">virtual_sites_relative.hpp</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_a45b6a7c36597d364e43177dada980db2"><div class="ttname"><a href="interaction__data_8cpp.html#a45b6a7c36597d364e43177dada980db2">bonded_ia_params</a></div><div class="ttdeci">Bonded_ia_parameters * bonded_ia_params</div><div class="ttdoc">Field containing the paramters of the bonded ia types. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00096">interaction_data.cpp:96</a></div></div>
<div class="ttc" id="core_2integrate_8cpp_html_aa216048ea5d8bbcef641752b6d744ba8"><div class="ttname"><a href="core_2integrate_8cpp.html#aa216048ea5d8bbcef641752b6d744ba8">time_step</a></div><div class="ttdeci">double time_step</div><div class="ttdoc">Time step for the integration. </div><div class="ttdef"><b>Definition:</b> <a href="core_2integrate_8cpp_source.html#l00080">core/integrate.cpp:80</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a7dd5df122d1aa72dc2e48aa7f4ff77d7"><div class="ttname"><a href="pressure_8cpp.html#a7dd5df122d1aa72dc2e48aa7f4ff77d7">calc_long_range_virials</a></div><div class="ttdeci">void calc_long_range_virials()</div><div class="ttdoc">Calculate long range virials (P3M, MMM2d...). </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00158">pressure.cpp:158</a></div></div>
<div class="ttc" id="npt_8hpp_html_af9a2b98b46732b97cb93d9cea69b6ad9"><div class="ttname"><a href="npt_8hpp.html#af9a2b98b46732b97cb93d9cea69b6ad9">NPTGEOM_YDIR</a></div><div class="ttdeci">#define NPTGEOM_YDIR</div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00081">npt.hpp:81</a></div></div>
<div class="ttc" id="grid_8cpp_html_a7752833cd9d63c688e16d6920b898cb8"><div class="ttname"><a href="grid_8cpp.html#a7752833cd9d63c688e16d6920b898cb8">box_l</a></div><div class="ttdeci">double box_l[3]</div><div class="ttdoc">Simulation box dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="grid_8cpp_source.html#l00062">grid.cpp:62</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a6d759c803e5563dd9a238e5780e1a17e"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a6d759c803e5563dd9a238e5780e1a17e">COULOMB_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00138">interaction_data.hpp:138</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ab1c0f3ec8558bd7f3dedf251928f3a89"><div class="ttname"><a href="pressure_8cpp.html#ab1c0f3ec8558bd7f3dedf251928f3a89">observable_compute_stress_tensor</a></div><div class="ttdeci">int observable_compute_stress_tensor(int v_comp, double *A, unsigned int n_A)</div><div class="ttdoc">function to calculate stress tensor for the observables </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l01037">pressure.cpp:1037</a></div></div>
<div class="ttc" id="pressure_8cpp_html_af72e1f4e076399cde1454da1ab661b83"><div class="ttname"><a href="pressure_8cpp.html#af72e1f4e076399cde1454da1ab661b83">init_p_tensor_non_bonded</a></div><div class="ttdeci">void init_p_tensor_non_bonded(Observable_stat_non_bonded *stat_nb)</div><div class="ttdoc">Initializes stat_nb to be used by pressure_calc. </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00333">pressure.cpp:333</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_af35bbb757587c54195a4ed75a6bc240aaca7aa93cfe4c45f1da0a5a68cf5f47bb"><div class="ttname"><a href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aaca7aa93cfe4c45f1da0a5a68cf5f47bb">DIPOLAR_MDLC_DS</a></div><div class="ttdoc">Dipolar method is direct sum plus DLC. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00176">interaction_data.hpp:176</a></div></div>
<div class="ttc" id="pressure_8hpp_html_a63cbeaf712267c567e47b39fb92f6b33"><div class="ttname"><a href="pressure_8hpp.html#a63cbeaf712267c567e47b39fb92f6b33">calc_bonded_force</a></div><div class="ttdeci">void calc_bonded_force(Particle *p1, Particle *p2, Bonded_ia_parameters *iaparams, int *i, double dx[3], double force[3])</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8hpp_source.html#l00155">pressure.hpp:155</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_a6cf6e4a9cea419ad9be6212d30488c46"><div class="ttname"><a href="interaction__data_8cpp.html#a6cf6e4a9cea419ad9be6212d30488c46">coulomb</a></div><div class="ttdeci">Coulomb_parameters coulomb</div><div class="ttdoc">Structure containing the coulomb parameters. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00075">interaction_data.cpp:75</a></div></div>
<div class="ttc" id="mpi_8h_html_aafd1dc0086079e7904385538c54c9c8f"><div class="ttname"><a href="mpi_8h.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a></div><div class="ttdeci">#define MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8h_source.html#l00114">mpi.h:114</a></div></div>
<div class="ttc" id="structObservable__stat_html_af774c0aa4f73922554ec0d57630cc17c"><div class="ttname"><a href="structObservable__stat.html#af774c0aa4f73922554ec0d57630cc17c">Observable_stat::coulomb</a></div><div class="ttdeci">double * coulomb</div><div class="ttdoc">start of observables for coulomb interaction. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00067">statistics.hpp:67</a></div></div>
<div class="ttc" id="domain__decomposition_8cpp_html_a7386e3ccc9009ad5fe62d5876beda487"><div class="ttname"><a href="domain__decomposition_8cpp.html#a7386e3ccc9009ad5fe62d5876beda487">calculate_link_cell_virials</a></div><div class="ttdeci">void calculate_link_cell_virials(int v_comp)</div><div class="ttdoc">Nonbonded and bonded virials calculation using link-cell method. </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8cpp_source.html#l01244">domain_decomposition.cpp:1244</a></div></div>
<div class="ttc" id="grid_8cpp_html_a071976c64226ce571f994f68f8b8a13f"><div class="ttname"><a href="grid_8cpp.html#a071976c64226ce571f994f68f8b8a13f">periodic</a></div><div class="ttdeci">int periodic</div><div class="ttdoc">Flags for all three dimensions wether pbc are applied (default). </div><div class="ttdef"><b>Definition:</b> <a href="grid_8cpp_source.html#l00060">grid.cpp:60</a></div></div>
<div class="ttc" id="mpi_8h_html_a354a2ef0d716888be386250157dfafe4"><div class="ttname"><a href="mpi_8h.html#a354a2ef0d716888be386250157dfafe4">MPI_Reduce</a></div><div class="ttdeci">int MPI_Reduce(void *sbuf, void *rbuf, int count, MPI_Datatype dtype, MPI_Op op, int root, MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8h_source.html#l00203">mpi.h:203</a></div></div>
<div class="ttc" id="pressure_8cpp_html_aab16a20eb8e566f45c340d94e727b7be"><div class="ttname"><a href="pressure_8cpp.html#aab16a20eb8e566f45c340d94e727b7be">pressure_calc</a></div><div class="ttdeci">void pressure_calc(double *result, double *result_t, double *result_nb, double *result_t_nb, int v_comp)</div><div class="ttdoc">Calculates the pressure in the system from a virial expansion using the terms from calculate_verlet_v...</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00083">pressure.cpp:83</a></div></div>
<div class="ttc" id="structPairList_html_af85cef4ff8d62ccf56b5b535f676bc31"><div class="ttname"><a href="structPairList.html#af85cef4ff8d62ccf56b5b535f676bc31">PairList::pair</a></div><div class="ttdeci">Particle ** pair</div><div class="ttdoc">The pair payload (two pointers per pair) </div><div class="ttdef"><b>Definition:</b> <a href="verlet_8hpp_source.html#l00064">verlet.hpp:64</a></div></div>
<div class="ttc" id="pressure_8cpp_html_aab066004d9c353859414feb568539e89"><div class="ttname"><a href="pressure_8cpp.html#aab066004d9c353859414feb568539e89">reducepos</a></div><div class="ttdeci">int reducepos(double pos[3], int bins[3], double centre[3], double range[3], int reducedpos[3])</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00791">pressure.cpp:791</a></div></div>
<div class="ttc" id="statistics_8cpp_html_ad0eaf09a8021efab1a1cc80aa93ac38d"><div class="ttname"><a href="statistics_8cpp.html#ad0eaf09a8021efab1a1cc80aa93ac38d">obsstat_realloc_and_clear</a></div><div class="ttdeci">void obsstat_realloc_and_clear(Observable_stat *stat, int n_pre, int n_bonded, int n_non_bonded, int n_coulomb, int n_dipolar, int n_vsr, int c_size)</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8cpp_source.html#l01414">statistics.cpp:1414</a></div></div>
<div class="ttc" id="pressure_8cpp_html_af9f3959e330453e3c6fff5f4f0255bd0"><div class="ttname"><a href="pressure_8cpp.html#af9f3959e330453e3c6fff5f4f0255bd0">master_pressure_calc</a></div><div class="ttdeci">void master_pressure_calc(int v_comp)</div><div class="ttdoc">on the master node: calc energies only if necessary </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00343">pressure.cpp:343</a></div></div>
<div class="ttc" id="debug_8hpp_html_a2f68dcdf04325fdf10c5acfb7fb7b184"><div class="ttname"><a href="debug_8hpp.html#a2f68dcdf04325fdf10c5acfb7fb7b184">free</a></div><div class="ttdeci">#define free(v)</div><div class="ttdef"><b>Definition:</b> <a href="debug_8hpp_source.html#l00041">debug.hpp:41</a></div></div>
<div class="ttc" id="structParticle_html_aeb172f49293421e3d0f03277453e320b"><div class="ttname"><a href="structParticle.html#aeb172f49293421e3d0f03277453e320b">Particle::r</a></div><div class="ttdeci">ParticlePosition r</div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00289">particle_data.hpp:289</a></div></div>
<div class="ttc" id="utils_8hpp_html_adf516403d8f6999d63b8baec7d4beebd"><div class="ttname"><a href="utils_8hpp.html#adf516403d8f6999d63b8baec7d4beebd">drem_down</a></div><div class="ttdeci">double drem_down(double a, double b)</div><div class="ttdoc">Calculates the remainder of a division. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00301">utils.hpp:301</a></div></div>
<div class="ttc" id="structParticleList_html"><div class="ttname"><a href="structParticleList.html">ParticleList</a></div><div class="ttdoc">List of particles. </div><div class="ttdef"><b>Definition:</b> <a href="particle__data_8hpp_source.html#l00320">particle_data.hpp:320</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_af35bbb757587c54195a4ed75a6bc240aa27fdc96df11103ae1bf66629aec7ab78"><div class="ttname"><a href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa27fdc96df11103ae1bf66629aec7ab78">DIPOLAR_MDLC_P3M</a></div><div class="ttdoc">Dipolar method is P3M plus DLC. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00170">interaction_data.hpp:170</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a47fafd818e7c52776203aa86aeff2d97"><div class="ttname"><a href="pressure_8cpp.html#a47fafd818e7c52776203aa86aeff2d97">incubewithskin</a></div><div class="ttdeci">int incubewithskin(double pos[3], double centre[3], double range[3])</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00801">pressure.cpp:801</a></div></div>
<div class="ttc" id="core_2integrate_8cpp_html_ad7c4aed24aaac428b38b1ba8dd684c2c"><div class="ttname"><a href="core_2integrate_8cpp.html#ad7c4aed24aaac428b38b1ba8dd684c2c">integ_switch</a></div><div class="ttdeci">int integ_switch</div><div class="ttdoc">Switch determining which Integrator to use. </div><div class="ttdef"><b>Definition:</b> <a href="core_2integrate_8cpp_source.html#l00076">core/integrate.cpp:76</a></div></div>
<div class="ttc" id="structnptiso__struct_html_a4a4502c51e3ccdfd47990df8294e86d6"><div class="ttname"><a href="structnptiso__struct.html#a4a4502c51e3ccdfd47990df8294e86d6">nptiso_struct::volume</a></div><div class="ttdeci">double volume</div><div class="ttdoc">isotropic volume. </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00043">npt.hpp:43</a></div></div>
<div class="ttc" id="communication_8cpp_html_afca28e25889e44c4b080c8cc173800ea"><div class="ttname"><a href="communication_8cpp.html#afca28e25889e44c4b080c8cc173800ea">comm_cart</a></div><div class="ttdeci">MPI_Comm comm_cart</div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00077">communication.cpp:77</a></div></div>
<div class="ttc" id="structObservable__stat_html_adb45b31dc632ae073a9d0569f60ee7f0"><div class="ttname"><a href="structObservable__stat.html#adb45b31dc632ae073a9d0569f60ee7f0">Observable_stat::vs_relative</a></div><div class="ttdeci">double * vs_relative</div><div class="ttdoc">Start of observables for virtual sites relative (rigid bodies) </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00071">statistics.hpp:71</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_a5891bbcf7de795d9716d0aee88f72fce"><div class="ttname"><a href="interaction__data_8cpp.html#a5891bbcf7de795d9716d0aee88f72fce">interactions_sanity_checks</a></div><div class="ttdeci">int interactions_sanity_checks()</div><div class="ttdoc">check whether all force calculation routines are properly initialized. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00840">interaction_data.cpp:840</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_af33076101f612338df49016fa60b8d0a"><div class="ttname"><a href="interaction__data_8hpp.html#af33076101f612338df49016fa60b8d0a">checkIfParticlesInteract</a></div><div class="ttdeci">int checkIfParticlesInteract(int i, int j)</div><div class="ttdoc">check if the types of particles i and j have any non bonded interaction defined. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l01261">interaction_data.hpp:1261</a></div></div>
<div class="ttc" id="initialize_8cpp_html_a026c91016cfec2d7a602a3e705712107"><div class="ttname"><a href="initialize_8cpp.html#a026c91016cfec2d7a602a3e705712107">on_observable_calc</a></div><div class="ttdeci">void on_observable_calc()</div><div class="ttdoc">called before calculating observables, i.e. </div><div class="ttdef"><b>Definition:</b> <a href="initialize_8cpp_source.html#l00226">initialize.cpp:226</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96a1c457699b1ca8747a52abcae380492b3"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96a1c457699b1ca8747a52abcae380492b3">COULOMB_MMM2D</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00142">interaction_data.hpp:142</a></div></div>
<div class="ttc" id="integrate_8hpp_html"><div class="ttname"><a href="integrate_8hpp.html">integrate.hpp</a></div><div class="ttdoc">Molecular dynamics integrator. </div></div>
<div class="ttc" id="structCellStructure_html_a900f4f83cd2d54b9f393f92995694ded"><div class="ttname"><a href="structCellStructure.html#a900f4f83cd2d54b9f393f92995694ded">CellStructure::type</a></div><div class="ttdeci">int type</div><div class="ttdoc">type descriptor </div><div class="ttdef"><b>Definition:</b> <a href="cells_8hpp_source.html#l00132">cells.hpp:132</a></div></div>
<div class="ttc" id="cells_8cpp_html_a99da5e8ac75258e3558759794077737b"><div class="ttname"><a href="cells_8cpp.html#a99da5e8ac75258e3558759794077737b">local_cells</a></div><div class="ttdeci">CellPList local_cells</div><div class="ttdoc">list of pointers to all cells containing particles physically on the local node. </div><div class="ttdef"><b>Definition:</b> <a href="cells_8cpp_source.html#l00052">cells.cpp:52</a></div></div>
<div class="ttc" id="utils_8hpp_html_a6d4566915e747bc257792d3b3967a181"><div class="ttname"><a href="utils_8hpp.html#a6d4566915e747bc257792d3b3967a181">ES_ERROR</a></div><div class="ttdeci">#define ES_ERROR</div><div class="ttdoc">error code if an error occured </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00058">utils.hpp:58</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ab385f4cd4eb00c54d24562d28643823a"><div class="ttname"><a href="pressure_8cpp.html#ab385f4cd4eb00c54d24562d28643823a">total_p_tensor</a></div><div class="ttdeci">Observable_stat total_p_tensor</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00036">pressure.cpp:36</a></div></div>
<div class="ttc" id="mpi_8h_html_a2df6a15627583d5e6f5a48550644cbef"><div class="ttname"><a href="mpi_8h.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a></div><div class="ttdeci">#define MPI_COMM_WORLD</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8h_source.html#l00096">mpi.h:96</a></div></div>
<div class="ttc" id="structnptiso__struct_html"><div class="ttname"><a href="structnptiso__struct.html">nptiso_struct</a></div><div class="ttdoc">Structure to hold all variables related to the isotropic NpT-integration scheme. </div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00035">npt.hpp:35</a></div></div>
<div class="ttc" id="structIA__Neighbor__List_html_a57a761949d555b03a5f7047bfe689611"><div class="ttname"><a href="structIA__Neighbor__List.html#a57a761949d555b03a5f7047bfe689611">IA_Neighbor_List::nList</a></div><div class="ttdeci">IA_Neighbor * nList</div><div class="ttdoc">Interacting neighbor cell list. </div><div class="ttdef"><b>Definition:</b> <a href="domain__decomposition_8hpp_source.html#l00102">domain_decomposition.hpp:102</a></div></div>
<div class="ttc" id="utils_8hpp_html_a747a977c2fbce6f4bba1f13d0de15463"><div class="ttname"><a href="utils_8hpp.html#a747a977c2fbce6f4bba1f13d0de15463">PMASS</a></div><div class="ttdeci">#define PMASS(pt)</div><div class="ttdoc">macro for easy use of mass. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00166">utils.hpp:166</a></div></div>
<div class="ttc" id="domain__decomposition_8hpp_html"><div class="ttname"><a href="domain__decomposition_8hpp.html">domain_decomposition.hpp</a></div><div class="ttdoc">This file contains everything related to the cell system: domain decomposition. </div></div>
<div class="ttc" id="interaction__data_8hpp_html_af35bbb757587c54195a4ed75a6bc240aa62626c97d5ce90cac665d76112d1a961"><div class="ttname"><a href="interaction__data_8hpp.html#af35bbb757587c54195a4ed75a6bc240aa62626c97d5ce90cac665d76112d1a961">DIPOLAR_DS</a></div><div class="ttdoc">Dipolar method is magnetic dipolar direct sum. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00174">interaction_data.hpp:174</a></div></div>
<div class="ttc" id="forces__inline_8hpp_html_a0f7bdcddc16cc3c5cbcb744a996099c8"><div class="ttname"><a href="forces__inline_8hpp.html#a0f7bdcddc16cc3c5cbcb744a996099c8">calc_non_bonded_pair_force</a></div><div class="ttdeci">void calc_non_bonded_pair_force(Particle *p1, Particle *p2, IA_parameters *ia_params, double d[3], double dist, double dist2, double force[3], double torque1[3]=NULL, double torque2[3]=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="forces__inline_8hpp_source.html#l00423">forces_inline.hpp:423</a></div></div>
<div class="ttc" id="utils_8hpp_html_a37474faad5e05ca5d6c2464f2f4aa27d"><div class="ttname"><a href="utils_8hpp.html#a37474faad5e05ca5d6c2464f2f4aa27d">ES_OK</a></div><div class="ttdeci">#define ES_OK</div><div class="ttdoc">error code if no error occured </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00056">utils.hpp:56</a></div></div>
<div class="ttc" id="structDoubleList_html_ad300495b504514e653f20cc132c9a69b"><div class="ttname"><a href="structDoubleList.html#ad300495b504514e653f20cc132c9a69b">DoubleList::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">number of used elements in the double field. </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00094">utils.hpp:94</a></div></div>
<div class="ttc" id="communication_8cpp_html_ae37b67ec3433cd14074b4dd29daa1c7a"><div class="ttname"><a href="communication_8cpp.html#ae37b67ec3433cd14074b4dd29daa1c7a">mpi_gather_stats</a></div><div class="ttdeci">void mpi_gather_stats(int job, void *result, void *result_t, void *result_nb, void *result_t_nb)</div><div class="ttdoc">Issue REQ_GATHER: gather data for analysis in analyze. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l01414">communication.cpp:1414</a></div></div>
<div class="ttc" id="structnptiso__struct_html_ae9bb34febbe4b3d9c621435b4ed2c1a8"><div class="ttname"><a href="structnptiso__struct.html#ae9bb34febbe4b3d9c621435b4ed2c1a8">nptiso_struct::invalidate_p_vel</a></div><div class="ttdeci">int invalidate_p_vel</div><div class="ttdoc">flag which indicates if p_vel may (0) or may not (1) be used in offline pressure calculations such as...</div><div class="ttdef"><b>Definition:</b> <a href="npt_8hpp_source.html#l00059">npt.hpp:59</a></div></div>
<div class="ttc" id="pressure_8cpp_html_aa0789ed045d218aa6f34f4cfda6070c4"><div class="ttname"><a href="pressure_8cpp.html#aa0789ed045d218aa6f34f4cfda6070c4">init_p_tensor</a></div><div class="ttdeci">void init_p_tensor(Observable_stat *stat)</div><div class="ttdoc">Initializes stat to be used by pressure_calc. </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00291">pressure.cpp:291</a></div></div>
<div class="ttc" id="errorhandling_8hpp_html_a62b07981730ac486dfb20b915e6b3047"><div class="ttname"><a href="errorhandling_8hpp.html#a62b07981730ac486dfb20b915e6b3047">runtimeError</a></div><div class="ttdeci">#define runtimeError(msg)</div><div class="ttdef"><b>Definition:</b> <a href="errorhandling_8hpp_source.html#l00056">errorhandling.hpp:56</a></div></div>
<div class="ttc" id="cells_8cpp_html_a91f5f9cfd42c359d9244c32629c5bde4"><div class="ttname"><a href="cells_8cpp.html#a91f5f9cfd42c359d9244c32629c5bde4">rebuild_verletlist</a></div><div class="ttdeci">int rebuild_verletlist</div><div class="ttdoc">If non-zero, cell systems should reset the position for checking the Verlet criterion. </div><div class="ttdef"><b>Definition:</b> <a href="cells_8cpp_source.html#l00061">cells.cpp:61</a></div></div>
<div class="ttc" id="verlet_8cpp_html_a4e15d173b2cb6acd20c43c353a32e5b5"><div class="ttname"><a href="verlet_8cpp.html#a4e15d173b2cb6acd20c43c353a32e5b5">calculate_verlet_virials</a></div><div class="ttdeci">void calculate_verlet_virials(int v_comp)</div><div class="ttdoc">Nonbonded and bonded pressure calculation using the verlet list. </div><div class="ttdef"><b>Definition:</b> <a href="verlet_8cpp_source.html#l00362">verlet.cpp:362</a></div></div>
<div class="ttc" id="structObservable__stat_html_a9c3a374d1da3eec1a681467b2dcdb275"><div class="ttname"><a href="structObservable__stat.html#a9c3a374d1da3eec1a681467b2dcdb275">Observable_stat::dipolar</a></div><div class="ttdeci">double * dipolar</div><div class="ttdoc">start of observables for coulomb interaction. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00069">statistics.hpp:69</a></div></div>
<div class="ttc" id="pressure_8cpp_html_ab3e42f91592a3720bc84158dcd829438"><div class="ttname"><a href="pressure_8cpp.html#ab3e42f91592a3720bc84158dcd829438">init_virials</a></div><div class="ttdeci">void init_virials(Observable_stat *stat)</div><div class="ttdoc">Initializes a virials Observable stat. </div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00235">pressure.cpp:235</a></div></div>
<div class="ttc" id="interaction__data_8cpp_html_aae05a6fe1a1afecdedd013c330e42d56"><div class="ttname"><a href="interaction__data_8cpp.html#aae05a6fe1a1afecdedd013c330e42d56">n_bonded_ia</a></div><div class="ttdeci">int n_bonded_ia</div><div class="ttdoc">number of bonded interactions. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8cpp_source.html#l00095">interaction_data.cpp:95</a></div></div>
<div class="ttc" id="nsquare_8cpp_html_ae1fac23183565ffb72748e3fc9e0b66e"><div class="ttname"><a href="nsquare_8cpp.html#ae1fac23183565ffb72748e3fc9e0b66e">nsq_calculate_virials</a></div><div class="ttdeci">void nsq_calculate_virials(int v_comp)</div><div class="ttdoc">n^2 pressure calculation </div><div class="ttdef"><b>Definition:</b> <a href="nsquare_8cpp_source.html#l00351">nsquare.cpp:351</a></div></div>
<div class="ttc" id="debye__hueckel_8hpp_html_a7cf6993716ebf0e66ecbe72b876cb9c1"><div class="ttname"><a href="debye__hueckel_8hpp.html#a7cf6993716ebf0e66ecbe72b876cb9c1">add_dh_coulomb_pair_force</a></div><div class="ttdeci">void add_dh_coulomb_pair_force(Particle *p1, Particle *p2, double d[3], double dist, double force[3])</div><div class="ttdoc">Computes the Debye_Hueckel pair force and adds this force to the particle forces (see tclcommand_inte...</div><div class="ttdef"><b>Definition:</b> <a href="debye__hueckel_8hpp_source.html#l00064">debye_hueckel.hpp:64</a></div></div>
<div class="ttc" id="structCoulomb__parameters_html_a91e49bd10162ccc14beff4a244d905ec"><div class="ttname"><a href="structCoulomb__parameters.html#a91e49bd10162ccc14beff4a244d905ec">Coulomb_parameters::method</a></div><div class="ttdeci">CoulombMethod method</div><div class="ttdoc">Method to treat coulomb interaction. </div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00527">interaction_data.hpp:527</a></div></div>
<div class="ttc" id="cells_8hpp_html_af72b653af537e1e36b4b816d82b3ba7c"><div class="ttname"><a href="cells_8hpp.html#af72b653af537e1e36b4b816d82b3ba7c">CELL_STRUCTURE_DOMDEC</a></div><div class="ttdeci">#define CELL_STRUCTURE_DOMDEC</div><div class="ttdoc">cell structure domain decomposition </div><div class="ttdef"><b>Definition:</b> <a href="cells_8hpp_source.html#l00077">cells.hpp:77</a></div></div>
<div class="ttc" id="interaction__data_8hpp_html_aff5199c0965a1903845b2c4e4eddbf96af61ff343849d5de6d0637dfb7e347e7d"><div class="ttname"><a href="interaction__data_8hpp.html#aff5199c0965a1903845b2c4e4eddbf96af61ff343849d5de6d0637dfb7e347e7d">COULOMB_P3M_GPU</a></div><div class="ttdef"><b>Definition:</b> <a href="interaction__data_8hpp_source.html#l00147">interaction_data.hpp:147</a></div></div>
<div class="ttc" id="constraint_8cpp_html_a08874f3ecb3cab16c1e7a0c743eebff4"><div class="ttname"><a href="constraint_8cpp.html#a08874f3ecb3cab16c1e7a0c743eebff4">sign</a></div><div class="ttdeci">static double sign(double x)</div><div class="ttdef"><b>Definition:</b> <a href="constraint_8cpp_source.html#l00061">constraint.cpp:61</a></div></div>
<div class="ttc" id="structCellPList_html_aea60ac0faa16a48d42cdee57726382be"><div class="ttname"><a href="structCellPList.html#aea60ac0faa16a48d42cdee57726382be">CellPList::cell</a></div><div class="ttdeci">Cell ** cell</div><div class="ttdef"><b>Definition:</b> <a href="cells_8hpp_source.html#l00119">cells.hpp:119</a></div></div>
<div class="ttc" id="structObservable__stat__non__bonded_html"><div class="ttname"><a href="structObservable__stat__non__bonded.html">Observable_stat_non_bonded</a></div><div class="ttdoc">Structure used only in the pressure and stress tensor calculation to distinguish non-bonded intra- an...</div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00079">statistics.hpp:79</a></div></div>
<div class="ttc" id="pressure_8cpp_html_a824b43a2a1f32840f5ba28457a464d7e"><div class="ttname"><a href="pressure_8cpp.html#a824b43a2a1f32840f5ba28457a464d7e">total_pressure</a></div><div class="ttdeci">Observable_stat total_pressure</div><div class="ttdef"><b>Definition:</b> <a href="pressure_8cpp_source.html#l00034">pressure.cpp:34</a></div></div>
<div class="ttc" id="structObservable__stat__non__bonded_html_a204ad2e299a086f57d9b4fbb0e28c304"><div class="ttname"><a href="structObservable__stat__non__bonded.html#a204ad2e299a086f57d9b4fbb0e28c304">Observable_stat_non_bonded::init_status_nb</a></div><div class="ttdeci">int init_status_nb</div><div class="ttdoc">Status flag for observable calculation. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00083">statistics.hpp:83</a></div></div>
<div class="ttc" id="integrate_8hpp_html_a1c868623330157021f98dd5bbed44134"><div class="ttname"><a href="integrate_8hpp.html#a1c868623330157021f98dd5bbed44134">INTEG_METHOD_NPT_ISO</a></div><div class="ttdeci">#define INTEG_METHOD_NPT_ISO</div><div class="ttdef"><b>Definition:</b> <a href="integrate_8hpp_source.html#l00029">integrate.hpp:29</a></div></div>
<div class="ttc" id="structObservable__stat_html_a094d3f2ae324072aa596811dc2cf0978"><div class="ttname"><a href="structObservable__stat.html#a094d3f2ae324072aa596811dc2cf0978">Observable_stat::init_status</a></div><div class="ttdeci">int init_status</div><div class="ttdoc">Status flag for observable calculation. </div><div class="ttdef"><b>Definition:</b> <a href="statistics_8hpp_source.html#l00048">statistics.hpp:48</a></div></div>
<div class="ttc" id="layered_8cpp_html_a15f01bcfbdbb2713b8f123980a700de7"><div class="ttname"><a href="layered_8cpp.html#a15f01bcfbdbb2713b8f123980a700de7">layered_calculate_virials</a></div><div class="ttdeci">void layered_calculate_virials(int v_comp)</div><div class="ttdoc">calculate short ranged virials </div><div class="ttdef"><b>Definition:</b> <a href="layered_8cpp_source.html#l00673">layered.cpp:673</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="pressure_8cpp.html">pressure.cpp</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:38 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
