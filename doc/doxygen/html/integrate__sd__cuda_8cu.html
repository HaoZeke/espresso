<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: integrate_sd_cuda.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('integrate__sd__cuda_8cu.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">integrate_sd_cuda.cu File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Stokes dynamics integrator.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="config_8hpp_source.html">config.hpp</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &quot;cuda_runtime.h&quot;</code><br />
<code>#include &quot;curand.h&quot;</code><br />
<code>#include &lt;device_functions.h&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &quot;assert.h&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate__sd__cuda_8hpp_source.html">integrate_sd_cuda.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate__sd__cuda__debug_8hpp_source.html">integrate_sd_cuda_debug.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate__sd__cuda__kernel_8hpp_source.html">integrate_sd_cuda_kernel.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate__sd_8hpp_source.html">integrate_sd.hpp</a>&quot;</code><br />
<code>#include &lt;cublas_v2.h&gt;</code><br />
<code>#include &quot;<a class="el" href="global_8hpp_source.html">global.hpp</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for integrate_sd_cuda.cu:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="integrate__sd__cuda_8cu__incl.svg" width="100%" height="496"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="integrate__sd__cuda_8cu_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8c4889f014ba8756c4a04ac73cd5c404"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a8c4889f014ba8756c4a04ac73cd5c404">sd_gmres_solver_exit</a>()</td></tr>
<tr class="separator:a8c4889f014ba8756c4a04ac73cd5c404"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aabb49c83b12a0118537d10580e569f0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#aabb49c83b12a0118537d10580e569f0f">propagate_pos_sd_cuda</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *box_l_h, int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *pos_h, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *force_h, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *velo_h)</td></tr>
<tr class="separator:aabb49c83b12a0118537d10580e569f0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ee9d2dffeda8f8674602146184160a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a4ee9d2dffeda8f8674602146184160a3">sd_compute_displacement</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *r_d, int N, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> viscosity, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> radius, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_h, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *total_mobility_d, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *force_d, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *disp_d, int *myInfo_d)</td></tr>
<tr class="separator:a4ee9d2dffeda8f8674602146184160a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a200d7a826caf4baa58973589e2e50e05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a200d7a826caf4baa58973589e2e50e05">sd_iterative_solver</a> (const <a class="el" href="structmatrix.html">matrix</a> &amp;mobility, const <a class="el" href="structmatrix.html">matrix</a> &amp;resistance, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *force, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *disp, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> rel_tol, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> abs_tol, bool recalc)</td></tr>
<tr class="memdesc:a200d7a826caf4baa58973589e2e50e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">this calls an iterative solver to solve the problem: disp * (1+resistance*mobility) = mobility_d * force_d and returnes  <a href="#a200d7a826caf4baa58973589e2e50e05">More...</a><br /></td></tr>
<tr class="separator:a200d7a826caf4baa58973589e2e50e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077c854c69f2d43302a484b924100bc2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a077c854c69f2d43302a484b924100bc2">sd_gmres_solver</a> (const <a class="el" href="structmatrix.html">matrix</a> &amp;A1, const <a class="el" href="structmatrix.html">matrix</a> &amp;A2, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *b, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> tol, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> abs_tol, int maxit, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *x, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *res)</td></tr>
<tr class="separator:a077c854c69f2d43302a484b924100bc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afff4b5950fe74b6db09c6f09dc53960e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#afff4b5950fe74b6db09c6f09dc53960e">calculate_maxmin_eigenvalues</a> (const <a class="el" href="structmatrix.html">matrix</a> &amp;mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *lambda_min, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *lambda_max, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> tol)</td></tr>
<tr class="separator:afff4b5950fe74b6db09c6f09dc53960e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e2880ad63be0bb93dc99e6448b2a549"><td class="memItemLeft" align="right" valign="top"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a7e2880ad63be0bb93dc99e6448b2a549">calculate_chebyshev_coefficents</a> (<a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> lambda_min, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> lambda_max, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> tol, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> **coefficents)</td></tr>
<tr class="memdesc:a7e2880ad63be0bb93dc99e6448b2a549"><td class="mdescLeft">&#160;</td><td class="mdescRight">caclulate the chebyshev coefficents for the squareroot of the matrix It needs the largest and smalles eigenvalue which have to be computed before. Using chebyshev-gausquadrature <a class="el" href="">https://en.wikipedia.org/wiki/Chebyshev%E2%80%93Gauss_quadrature</a>.  <a href="#a7e2880ad63be0bb93dc99e6448b2a549">More...</a><br /></td></tr>
<tr class="separator:a7e2880ad63be0bb93dc99e6448b2a549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23f00da5c3ec956ad11bc9d7294604d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a23f00da5c3ec956ad11bc9d7294604d0">sd_compute_brownian_force_farfield</a> (const <a class="el" href="structmatrix.html">matrix</a> &amp;mobility, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *gaussian_ff, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> tol, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *brownian_force_ff)</td></tr>
<tr class="memdesc:a23f00da5c3ec956ad11bc9d7294604d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the brownian force resulting from the farfield To compute the farfield contribution of the brownian motion the squareroot of the inverse of the mobility is required. Instead of calculating it directly, its action on the vector containing the randomnumbers is computed via the chebyshev-polynomials. In the case of FF_ONLY this computes directly the displacement!  <a href="#a23f00da5c3ec956ad11bc9d7294604d0">More...</a><br /></td></tr>
<tr class="separator:a23f00da5c3ec956ad11bc9d7294604d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa328c99a29bc6604c0a559bbf96ce4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a5fa328c99a29bc6604c0a559bbf96ce4">sd_Rgemv</a> (const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *factor, const <a class="el" href="structmatrix.html">matrix</a> &amp;A, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *in, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *out)</td></tr>
<tr class="separator:a5fa328c99a29bc6604c0a559bbf96ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d730dc0507c29480a4fc61203afc184"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a9d730dc0507c29480a4fc61203afc184">sd_compute_mobility_matrix_wave_cpu</a> (int kmax, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> kmax2, <a class="el" href="structmatrix.html">matrix</a> &amp;mobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> a, const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *L_h, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> xi, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> selfmobility, <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> ew_prec)</td></tr>
<tr class="separator:a9d730dc0507c29480a4fc61203afc184"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab401a5b926c3edc04eae5a8e441affdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#ab401a5b926c3edc04eae5a8e441affdd">_cuda_check_error</a> (char *file, unsigned int line)</td></tr>
<tr class="separator:ab401a5b926c3edc04eae5a8e441affdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac204c9769b42fbc5366f495ec5ccc20d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#ac204c9769b42fbc5366f495ec5ccc20d">sd_find_max</a> (int *data, int length)</td></tr>
<tr class="separator:ac204c9769b42fbc5366f495ec5ccc20d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a88ff3cb437c7e29208e35c53e312523e"><td class="memItemLeft" align="right" valign="top">cublasHandle_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a88ff3cb437c7e29208e35c53e312523e">cublas</a> = NULL</td></tr>
<tr class="separator:a88ff3cb437c7e29208e35c53e312523e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4a060f024af79d06e145274cb2b9bdf"><td class="memItemLeft" align="right" valign="top">curandGenerator_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#ad4a060f024af79d06e145274cb2b9bdf">generator</a> = NULL</td></tr>
<tr class="separator:ad4a060f024af79d06e145274cb2b9bdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63f03e9c029f014a1e96363c1b8e8c84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="integrate__sd__cuda_8cu.html#a63f03e9c029f014a1e96363c1b8e8c84">reprint</a> =-1</td></tr>
<tr class="separator:a63f03e9c029f014a1e96363c1b8e8c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stokes dynamics integrator. </p>
<p>Here the calculation of the displacements is implemented. </p>

<p>Definition in file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a8c4889f014ba8756c4a04ac73cd5c404"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define sd_gmres_solver_exit</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code" href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">cuda_safe_mem</a>(cudaFree((<span class="keywordtype">void</span>*)r0));     <a class="code" href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">\</a></div>
<div class="line"><a class="code" href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">  cuda_safe_mem</a>(cudaFree((<span class="keywordtype">void</span>*)v));<a class="code" href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">cuda_safe_mem</a>(cudaFree((<span class="keywordtype">void</span>*)w));  <a class="code" href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">\</a></div>
<div class="line"><a class="code" href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">  cuda_safe_mem</a>(cudaFree((<span class="keywordtype">void</span>*)tmp)); res[0] = <a class="code" href="utils_8hpp.html#a48c815fd7c0d3161ad8be62bfce3ef2f">normr</a>;                  \</div>
<div class="line">  if (<a class="code" href="global_8cpp.html#a62eb0cf8aac6795965da189c98af8753">warnings</a> &gt; 1) printf(&quot;GMRes used %d iterations.\n&quot;, iteration);   \</div>
<div class="line">  if (tolb*1.01 &gt;= <a class="code" href="utils_8hpp.html#a48c815fd7c0d3161ad8be62bfce3ef2f">normr</a>)     { <span class="keywordflow">return</span> 0;}                              \</div>
<div class="line">  printf(<span class="stringliteral">&quot;tolb: %e, normr: %e, eps: %e \n&quot;</span>,tolb, <a class="code" href="utils_8hpp.html#a48c815fd7c0d3161ad8be62bfce3ef2f">normr</a>, eps);           \</div>
<div class="line">  if (tolb*100 &gt; <a class="code" href="utils_8hpp.html#a48c815fd7c0d3161ad8be62bfce3ef2f">normr</a>)       { <span class="keywordflow">return</span> 1;}                              \</div>
<div class="line">  if (initnorm*1e10 &gt;= <a class="code" href="utils_8hpp.html#a48c815fd7c0d3161ad8be62bfce3ef2f">normr</a>) { <span class="keywordflow">return</span> 2;}                              \</div>
<div class="line">  else                        { <span class="keywordflow">return</span> 4;}</div>
<div class="ttc" id="utils_8hpp_html_a48c815fd7c0d3161ad8be62bfce3ef2f"><div class="ttname"><a href="utils_8hpp.html#a48c815fd7c0d3161ad8be62bfce3ef2f">normr</a></div><div class="ttdeci">double normr(double v[3])</div><div class="ttdoc">calculates the length of a vector </div><div class="ttdef"><b>Definition:</b> <a href="utils_8hpp_source.html#l00434">utils.hpp:434</a></div></div>
<div class="ttc" id="cuda__utils_8hpp_html_a725cc96b2e195dbe5b09f3b4edc2fbcb"><div class="ttname"><a href="cuda__utils_8hpp.html#a725cc96b2e195dbe5b09f3b4edc2fbcb">cuda_safe_mem</a></div><div class="ttdeci">#define cuda_safe_mem(a)</div><div class="ttdef"><b>Definition:</b> <a href="cuda__utils_8hpp_source.html#l00046">cuda_utils.hpp:46</a></div></div>
<div class="ttc" id="global_8cpp_html_a62eb0cf8aac6795965da189c98af8753"><div class="ttname"><a href="global_8cpp.html#a62eb0cf8aac6795965da189c98af8753">warnings</a></div><div class="ttdeci">int warnings</div><div class="ttdoc">bool: whether to write out warnings or not </div><div class="ttdef"><b>Definition:</b> <a href="global_8cpp_source.html#l00109">global.cpp:109</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00960">960</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00972">sd_gmres_solver()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab401a5b926c3edc04eae5a8e441affdd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _cuda_check_error </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01695">1695</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="cuda__common__cuda_8cu_source.html#l00058">err</a>.</p>

</div>
</div>
<a class="anchor" id="a7e2880ad63be0bb93dc99e6448b2a549"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> calculate_chebyshev_coefficents </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>lambda_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>lambda_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> **&#160;</td>
          <td class="paramname"><em>coefficents</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>caclulate the chebyshev coefficents for the squareroot of the matrix It needs the largest and smalles eigenvalue which have to be computed before. Using chebyshev-gausquadrature <a class="el" href="">https://en.wikipedia.org/wiki/Chebyshev%E2%80%93Gauss_quadrature</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lambda_min</td><td>: the lower boundery </td></tr>
    <tr><td class="paramname">lambda_max</td><td>: the upper boundery of the interval </td></tr>
    <tr><td class="paramname">tol</td><td>: the given tollerance which should be achieved </td></tr>
    <tr><td class="paramname">coefficents</td><td>: the pointer where the data will be stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01283">1283</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="debug_8hpp_source.html#l00041">free</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="config_8hpp_source.html#l00145">M_PI</a>, <a class="el" href="debug_8hpp_source.html#l00040">malloc</a>, <a class="el" href="debug_8hpp_source.html#l00039">realloc</a>, and <a class="el" href="global_8cpp_source.html#l00109">warnings</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l01379">sd_compute_brownian_force_farfield()</a>.</p>

</div>
</div>
<a class="anchor" id="afff4b5950fe74b6db09c6f09dc53960e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_maxmin_eigenvalues </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>lambda_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>lambda_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01140">1140</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00044">matrix::size</a>, and <a class="el" href="global_8cpp_source.html#l00109">warnings</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l01379">sd_compute_brownian_force_farfield()</a>.</p>

</div>
</div>
<a class="anchor" id="aabb49c83b12a0118537d10580e569f0f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void propagate_pos_sd_cuda </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>box_l_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>pos_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>force_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>velo_h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00082">82</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">cublas</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="errorhandling_8cpp_source.html#l00115">errexit()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>, <a class="el" href="integrate__sd_8cpp_source.html#l00084">sd_radius</a>, <a class="el" href="integrate__sd_8cpp_source.html#l00083">sd_viscosity</a>, and <a class="el" href="core_2integrate_8cpp_source.html#l00080">time_step</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd_8cpp_source.html#l00348">propagate_pos_sd()</a>.</p>

</div>
</div>
<a class="anchor" id="a23f00da5c3ec956ad11bc9d7294604d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> sd_compute_brownian_force_farfield </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>gaussian_ff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>brownian_force_ff</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the brownian force resulting from the farfield To compute the farfield contribution of the brownian motion the squareroot of the inverse of the mobility is required. Instead of calculating it directly, its action on the vector containing the randomnumbers is computed via the chebyshev-polynomials. In the case of FF_ONLY this computes directly the displacement! </p>

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01379">1379</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__cuda_8cu_source.html#l01283">calculate_chebyshev_coefficents()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01140">calculate_maxmin_eigenvalues()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">cublas</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00039">matrix::data</a>, <a class="el" href="errorhandling_8cpp_source.html#l00115">errexit()</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00259">isSymmetricDev()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00045">matrix::ldd</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00044">matrix::size</a>, <a class="el" href="global_8cpp_source.html#l00109">warnings</a>, and <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00042">matrix::wavespace</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>.</p>

</div>
</div>
<a class="anchor" id="a4ee9d2dffeda8f8674602146184160a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sd_compute_displacement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>r_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>viscosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>total_mobility_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>force_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>disp_d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>myInfo_d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">167</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__matrix_8cu_source.html#l00094">matrix::_free_wavespace()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00040">matrix::col_idx</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00010">wavepart::cosines</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">cublas</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00039">matrix::data</a>, <a class="el" href="integrate__sd_8hpp_source.html#l00055">DIM</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00053">generator</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00248">hasAnyNanDev()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00043">matrix::is_sparse</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00259">isSymmetricDev()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00045">matrix::ldd</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00046">matrix::ldd_short</a>, <a class="el" href="config_8hpp_source.html#l00145">M_PI</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00009">wavepart::matrices</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00012">wavepart::num</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00281">printMatrixDev()</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00145">printPosDev()</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00095">printVectorDev()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00054">reprint</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00041">matrix::row_l</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01379">sd_compute_brownian_force_farfield()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01583">sd_compute_mobility_matrix_wave_cpu()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01708">sd_find_max()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00597">sd_iterative_solver()</a>, <a class="el" href="integrate__sd_8cpp_source.html#l00088">sd_random_precision</a>, <a class="el" href="integrate__sd_8cpp_source.html#l00087">sd_random_state</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>, <a class="el" href="integrate__sd_8cpp_source.html#l00086">sd_seed</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00596">sd_wavepart_addto_matrix()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00011">wavepart::sines</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00044">matrix::size</a>, <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>, <a class="el" href="core_2thermostat_8cpp_source.html#l00041">temperature</a>, <a class="el" href="core_2integrate_8cpp_source.html#l00080">time_step</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00008">wavepart::vecs</a>, <a class="el" href="global_8cpp_source.html#l00109">warnings</a>, and <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00042">matrix::wavespace</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00082">propagate_pos_sd_cuda()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d730dc0507c29480a4fc61203afc184"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sd_compute_mobility_matrix_wave_cpu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>kmax2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>L_h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>xi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>selfmobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>ew_prec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01583">1583</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00010">wavepart::cosines</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00046">matrix::ldd_short</a>, <a class="el" href="config_8hpp_source.html#l00145">M_PI</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00009">wavepart::matrices</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00013">wavepart::max</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00012">wavepart::num</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00054">reprint</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00011">wavepart::sines</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00008">wavepart::vecs</a>, and <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00042">matrix::wavespace</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>.</p>

</div>
</div>
<a class="anchor" id="ac204c9769b42fbc5366f495ec5ccc20d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sd_find_max </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01708">1708</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>.</p>

</div>
</div>
<a class="anchor" id="a077c854c69f2d43302a484b924100bc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sd_gmres_solver </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>A1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>A2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>abs_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00972">972</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="ghmc_8cpp_source.html#l00054">beta</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">cublas</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00045">matrix::ldd</a>, <a class="el" href="utils_8hpp_source.html#l00434">normr()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00960">sd_gmres_solver_exit</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00044">matrix::size</a>, <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>, and <a class="el" href="global_8cpp_source.html#l00109">warnings</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00597">sd_iterative_solver()</a>.</p>

</div>
</div>
<a class="anchor" id="a200d7a826caf4baa58973589e2e50e05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> sd_iterative_solver </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mobility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>resistance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>force</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>rel_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a>&#160;</td>
          <td class="paramname"><em>abs_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>recalc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this calls an iterative solver to solve the problem: disp * (1+resistance*mobility) = mobility_d * force_d and returnes </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">disp</td><td></td></tr>
    <tr><td class="paramname">mobility</td><td>and </td></tr>
    <tr><td class="paramname">resistance</td><td>are square matrizes with </td></tr>
    <tr><td class="paramname">size</td><td>&lt;size&gt; and ldd &lt;((size+31)/32)*32&gt; </td></tr>
    <tr><td class="paramname">force</td><td>and </td></tr>
    <tr><td class="paramname">disp</td><td>are vectors of </td></tr>
    <tr><td class="paramname">size</td><td>&lt;size&gt; </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00597">597</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="ghmc_8cpp_source.html#l00054">beta</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">cublas</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00039">matrix::data</a>, <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00248">hasAnyNanDev()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00043">matrix::is_sparse</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00045">matrix::ldd</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00972">sd_gmres_solver()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00044">matrix::size</a>, and <a class="el" href="global_8cpp_source.html#l00109">warnings</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>.</p>

</div>
</div>
<a class="anchor" id="a5fa328c99a29bc6604c0a559bbf96ce4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sd_Rgemv </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmatrix.html">matrix</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="EwaldgpuForce_8cpp.html#afca8eb41f1c759484b22c425442d9aa1">real</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">1483</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>References <a class="el" href="integrate__sd__matrix_8cu_source.html#l00185">matrix::assert_all()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00040">matrix::col_idx</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00010">wavepart::cosines</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">cublas</a>, <a class="el" href="cuda__utils_8hpp_source.html#l00046">cuda_safe_mem</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00039">matrix::data</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00043">matrix::is_sparse</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00045">matrix::ldd</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00046">matrix::ldd_short</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00009">wavepart::matrices</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00013">wavepart::max</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00012">wavepart::num</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00041">matrix::row_l</a>, <a class="el" href="integrate__sd__cuda__kernel_8cu_source.html#l00370">sd_wavepart_sum()</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00011">wavepart::sines</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00044">matrix::size</a>, <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00008">wavepart::vecs</a>, and <a class="el" href="integrate__sd__matrix_8hpp_source.html#l00042">matrix::wavespace</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l01140">calculate_maxmin_eigenvalues()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01379">sd_compute_brownian_force_farfield()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00972">sd_gmres_solver()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00597">sd_iterative_solver()</a>, and <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00042">sd_test()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a88ff3cb437c7e29208e35c53e312523e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cublasHandle_t cublas = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00052">52</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00082">propagate_pos_sd_cuda()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01379">sd_compute_brownian_force_farfield()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00972">sd_gmres_solver()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l00597">sd_iterative_solver()</a>, <a class="el" href="integrate__sd__cuda_8cu_source.html#l01483">sd_Rgemv()</a>, and <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00042">sd_test()</a>.</p>

</div>
</div>
<a class="anchor" id="ad4a060f024af79d06e145274cb2b9bdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">curandGenerator_t generator = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00053">53</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>, and <a class="el" href="integrate__sd__cuda__debug_8cu_source.html#l00042">sd_test()</a>.</p>

</div>
</div>
<a class="anchor" id="a63f03e9c029f014a1e96363c1b8e8c84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int reprint =-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="integrate__sd__cuda_8cu_source.html#l00054">54</a> of file <a class="el" href="integrate__sd__cuda_8cu_source.html">integrate_sd_cuda.cu</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd__cuda_8cu_source.html#l00167">sd_compute_displacement()</a>, and <a class="el" href="integrate__sd__cuda_8cu_source.html#l01583">sd_compute_mobility_matrix_wave_cpu()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="integrate__sd__cuda_8cu.html">integrate_sd_cuda.cu</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:41 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
