<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ESPResSo 3.4-dev-1009-g69a2b86-dirty-git: maggs.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_48x48.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ESPResSo 3.4-dev-1009-g69a2b86-dirty-git
   </div>
   <div id="projectbrief">Extensible Simulation Package for Soft Matter Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('maggs_8cpp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">maggs.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Maxwell Equations Molecular Dynamics (MEMD) method for electrostatic interactions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="mpi_8h_source.html">mpi.h</a>&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;cstring&gt;</code><br />
<code>#include &quot;<a class="el" href="ghosts_8hpp_source.html">ghosts.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="global_8hpp_source.html">global.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="grid_8hpp_source.html">grid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integrate_8hpp_source.html">integrate.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="initialize_8hpp_source.html">initialize.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interaction__data_8hpp_source.html">interaction_data.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="particle__data_8hpp_source.html">particle_data.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="communication_8hpp_source.html">communication.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="maggs_8hpp_source.html">maggs.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="thermostat_8hpp_source.html">thermostat.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cells_8hpp_source.html">cells.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="domain__decomposition_8hpp_source.html">domain_decomposition.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="errorhandling_8hpp_source.html">errorhandling.hpp</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for maggs.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="maggs_8cpp__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="maggs_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afd91a9756c540bf036a8e8bada873bed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#afd91a9756c540bf036a8e8bada873bed">REQ_MAGGS_SPREAD</a>&#160;&#160;&#160;300</td></tr>
<tr class="separator:afd91a9756c540bf036a8e8bada873bed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5acce35f01be6b31e717bfd142afb3c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa5acce35f01be6b31e717bfd142afb3c">REQ_MAGGS_EQUIL</a>&#160;&#160;&#160;301</td></tr>
<tr class="separator:aa5acce35f01be6b31e717bfd142afb3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af741baaff0ef249ec598d48615c74f66"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#af741baaff0ef249ec598d48615c74f66">SELF_FACTOR_1</a>&#160;&#160;&#160;1.57364595</td></tr>
<tr class="separator:af741baaff0ef249ec598d48615c74f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5ed2b50ab90839e10e145c732d19dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aaf5ed2b50ab90839e10e145c732d19dd">SELF_FACTOR_2</a>&#160;&#160;&#160;1.5078141</td></tr>
<tr class="separator:aaf5ed2b50ab90839e10e145c732d19dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e9854a38fcceea800337a3e30d4f96"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>&#160;&#160;&#160;3                 /* number of dimensions */</td></tr>
<tr class="separator:a64e9854a38fcceea800337a3e30d4f96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf292e53bd4a7ca0cf7b164daf1997a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a8bf292e53bd4a7ca0cf7b164daf1997a">NOWHERE</a>&#160;&#160;&#160;-1                  /* not a direction */</td></tr>
<tr class="separator:a8bf292e53bd4a7ca0cf7b164daf1997a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f3dfd29bcc1f569a5989716c54b6fc4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a0f3dfd29bcc1f569a5989716c54b6fc4">NDIRS</a>&#160;&#160;&#160;6				        /* number of directions */</td></tr>
<tr class="separator:a0f3dfd29bcc1f569a5989716c54b6fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47f7619de1dc9bd4313e7bca1e3c89ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a47f7619de1dc9bd4313e7bca1e3c89ff">XPLUS</a>&#160;&#160;&#160;0                     /* add for specific direction */</td></tr>
<tr class="separator:a47f7619de1dc9bd4313e7bca1e3c89ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75e6ffe5a6f42d8d9a638cf7f204f02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa75e6ffe5a6f42d8d9a638cf7f204f02">YPLUS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aa75e6ffe5a6f42d8d9a638cf7f204f02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59125b4bea2ca6afb92683ac56480530"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a59125b4bea2ca6afb92683ac56480530">ZPLUS</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a59125b4bea2ca6afb92683ac56480530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ec2662dc5b34b72c1150d91f46e352"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ae2ec2662dc5b34b72c1150d91f46e352">ZMINUS</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ae2ec2662dc5b34b72c1150d91f46e352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1351f1ff816687c3a5168d6419b5e69f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a1351f1ff816687c3a5168d6419b5e69f">YMINUS</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a1351f1ff816687c3a5168d6419b5e69f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add3c1b4b97fa3888de75db1d08b051ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#add3c1b4b97fa3888de75db1d08b051ed">XMINUS</a>&#160;&#160;&#160;5</td></tr>
<tr class="separator:add3c1b4b97fa3888de75db1d08b051ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a267c0c2c638604582d7a4d4bfb997893"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a267c0c2c638604582d7a4d4bfb997893">OPP_DIR</a>(dir)&#160;&#160;&#160;(5-(dir))	/* Opposite direction */</td></tr>
<tr class="separator:a267c0c2c638604582d7a4d4bfb997893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e0d42b2844179a1efb06ba8f28827f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa5e0d42b2844179a1efb06ba8f28827f">FOR3D</a>(dir)&#160;&#160;&#160;for(dir=0; dir&lt;<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>; dir++)</td></tr>
<tr class="separator:aa5e0d42b2844179a1efb06ba8f28827f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52d86f9f5df94174ac5dade5435c0026"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a52d86f9f5df94174ac5dade5435c0026">FORALL_INNER_SITES</a>(<a class="el" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  j,  k)</td></tr>
<tr class="separator:a52d86f9f5df94174ac5dade5435c0026"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48c1984524973c1fb847691aa544018e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a48c1984524973c1fb847691aa544018e">FORALL_SITES</a>(<a class="el" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,  j,  k)</td></tr>
<tr class="separator:a48c1984524973c1fb847691aa544018e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7e4663dc2d76e50cb125c31c10eb6321"><td class="memItemLeft" align="right" valign="top">typedef int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a7e4663dc2d76e50cb125c31c10eb6321">t_ivector</a>[<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>]</td></tr>
<tr class="separator:a7e4663dc2d76e50cb125c31c10eb6321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1198b4ee5559e64a58a935e8ff4d15c"><td class="memItemLeft" align="right" valign="top">typedef double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ad1198b4ee5559e64a58a935e8ff4d15c">t_dvector</a>[<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>]</td></tr>
<tr class="separator:ad1198b4ee5559e64a58a935e8ff4d15c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf885ab38916d9e7a6f0db3c0992dd98"><td class="memItemLeft" align="right" valign="top">typedef int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#acf885ab38916d9e7a6f0db3c0992dd98">t_dirs</a>[<a class="el" href="maggs_8cpp.html#a0f3dfd29bcc1f569a5989716c54b6fc4">NDIRS</a>]</td></tr>
<tr class="separator:acf885ab38916d9e7a6f0db3c0992dd98"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab898188966901a730f3fa52d1a64fe09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ab898188966901a730f3fa52d1a64fe09">maggs_get_linear_index</a> (int x, int y, int z, int latticedim[<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>])</td></tr>
<tr class="memdesc:ab898188966901a730f3fa52d1a64fe09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the 3D index into a linear index.  <a href="#ab898188966901a730f3fa52d1a64fe09">More...</a><br /></td></tr>
<tr class="separator:ab898188966901a730f3fa52d1a64fe09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732da4b4674754a644acde094074b23f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a732da4b4674754a644acde094074b23f">maggs_count_charged_particles</a> ()</td></tr>
<tr class="memdesc:a732da4b4674754a644acde094074b23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts the total number of charged particles on all processors.  <a href="#a732da4b4674754a644acde094074b23f">More...</a><br /></td></tr>
<tr class="separator:a732da4b4674754a644acde094074b23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a633d1edb624af06f00f86e370ce058"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a9a633d1edb624af06f00f86e370ce058">maggs_get_offset</a> (int index_shift, int index_base, int axes, int adim[3])</td></tr>
<tr class="memdesc:a9a633d1edb624af06f00f86e370ce058"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index shift is calculated for moving in various directions with the linear index.  <a href="#a9a633d1edb624af06f00f86e370ce058">More...</a><br /></td></tr>
<tr class="separator:a9a633d1edb624af06f00f86e370ce058"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291c05b2f40c3a1f9cb05d2f747401f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a291c05b2f40c3a1f9cb05d2f747401f8">maggs_calc_directions</a> (int j, int *dir1, int *dir2)</td></tr>
<tr class="memdesc:a291c05b2f40c3a1f9cb05d2f747401f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">For any direction j, write the two other directions into the pointers in circular permutation.  <a href="#a291c05b2f40c3a1f9cb05d2f747401f8">More...</a><br /></td></tr>
<tr class="separator:a291c05b2f40c3a1f9cb05d2f747401f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69e279ce3acd371e5d46010c7f10858f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a69e279ce3acd371e5d46010c7f10858f">maggs_calc_curl</a> (int mue, int nue, double *field, int *Neighbor, int index)</td></tr>
<tr class="memdesc:a69e279ce3acd371e5d46010c7f10858f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the finite differences rotation in real space in mue-nue plane: <img class="formulaInl" alt="$\frac{\partial}{\partial t}{D} = \nabla \times B$" src="form_7.png"/> (and prefactors plus current) The given "double* field" should be a B-Field!!  <a href="#a69e279ce3acd371e5d46010c7f10858f">More...</a><br /></td></tr>
<tr class="separator:a69e279ce3acd371e5d46010c7f10858f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad03c3b950586e2820505f11424c5d16d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ad03c3b950586e2820505f11424c5d16d">maggs_calc_dual_curl</a> (int mue, int nue, double *field, int *Neighbor, int index)</td></tr>
<tr class="memdesc:ad03c3b950586e2820505f11424c5d16d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the finite differences rotation in dual space in mue-nue plane: <img class="formulaInl" alt="$\frac{\partial}{\partial t}{B} = - \nabla \times D / (\epsilon)$" src="form_8.png"/> The given "double* field" should be a D-Field!!  <a href="#ad03c3b950586e2820505f11424c5d16d">More...</a><br /></td></tr>
<tr class="separator:ad03c3b950586e2820505f11424c5d16d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61def1d0aa3c1b2fa211b8107b2c1564"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a61def1d0aa3c1b2fa211b8107b2c1564">maggs_update_plaquette</a> (int mue, int nue, int *Neighbor, int index, double delta)</td></tr>
<tr class="memdesc:a61def1d0aa3c1b2fa211b8107b2c1564"><td class="mdescLeft">&#160;</td><td class="mdescRight">updates all D-fields on links of the plaquette and the surroundings.  <a href="#a61def1d0aa3c1b2fa211b8107b2c1564">More...</a><br /></td></tr>
<tr class="separator:a61def1d0aa3c1b2fa211b8107b2c1564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d01b0f599fd5360cfef5a5c15aec6c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a2d01b0f599fd5360cfef5a5c15aec6c3">maggs_sanity_checks</a> ()</td></tr>
<tr class="memdesc:a2d01b0f599fd5360cfef5a5c15aec6c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic sanity checks to see if the code will run.  <a href="#a2d01b0f599fd5360cfef5a5c15aec6c3">More...</a><br /></td></tr>
<tr class="separator:a2d01b0f599fd5360cfef5a5c15aec6c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91dbd110b6367afc3583486b26b6df33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a91dbd110b6367afc3583486b26b6df33">maggs_compute_dipole_correction</a> ()</td></tr>
<tr class="separator:a91dbd110b6367afc3583486b26b6df33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84d27d4b75007ae430c25ef2a82679b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ae84d27d4b75007ae430c25ef2a82679b">maggs_set_parameters</a> (double bjerrum, double f_mass, int mesh, int finite_epsilon_flag, double epsilon_infty)</td></tr>
<tr class="memdesc:ae84d27d4b75007ae430c25ef2a82679b"><td class="mdescLeft">&#160;</td><td class="mdescRight">called from: <a class="el" href="initialize_8cpp.html" title="Implementation of initialize.hpp. ">initialize.cpp</a>  <a href="#ae84d27d4b75007ae430c25ef2a82679b">More...</a><br /></td></tr>
<tr class="separator:ae84d27d4b75007ae430c25ef2a82679b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78de9fb74f1de85a6d93cf068dfe3d4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a78de9fb74f1de85a6d93cf068dfe3d4d">maggs_setup_neighbors</a> ()</td></tr>
<tr class="memdesc:a78de9fb74f1de85a6d93cf068dfe3d4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets up nearest neighbors for each site in linear index  <a href="#a78de9fb74f1de85a6d93cf068dfe3d4d">More...</a><br /></td></tr>
<tr class="separator:a78de9fb74f1de85a6d93cf068dfe3d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65958a28d942ac8104e4887c932d0fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#af65958a28d942ac8104e4887c932d0fa">maggs_setup_local_lattice</a> ()</td></tr>
<tr class="memdesc:af65958a28d942ac8104e4887c932d0fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up lattice, calculate dimensions and lattice parameters Allocate memory for lattice sites and fields.  <a href="#af65958a28d942ac8104e4887c932d0fa">More...</a><br /></td></tr>
<tr class="separator:af65958a28d942ac8104e4887c932d0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46d3803f720ae0f69dc0b1bcaa9a2c0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a46d3803f720ae0f69dc0b1bcaa9a2c0a">maggs_calc_surface_patches</a> (t_surf_patch *surface_patch)</td></tr>
<tr class="memdesc:a46d3803f720ae0f69dc0b1bcaa9a2c0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets up surface patches for all domains.  <a href="#a46d3803f720ae0f69dc0b1bcaa9a2c0a">More...</a><br /></td></tr>
<tr class="separator:a46d3803f720ae0f69dc0b1bcaa9a2c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fe81223d0bb0252639a9fa75f3efa7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a26fe81223d0bb0252639a9fa75f3efa7">maggs_prepare_surface_planes</a> (int dim, <a class="el" href="mpi_8h.html#af9d011bc903ab240995ba0071fb31c61">MPI_Datatype</a> *xy, <a class="el" href="mpi_8h.html#af9d011bc903ab240995ba0071fb31c61">MPI_Datatype</a> *xz, <a class="el" href="mpi_8h.html#af9d011bc903ab240995ba0071fb31c61">MPI_Datatype</a> *yz, t_surf_patch *surface_patch)</td></tr>
<tr class="memdesc:a26fe81223d0bb0252639a9fa75f3efa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">sets up MPI communications for domain surfaces  <a href="#a26fe81223d0bb0252639a9fa75f3efa7">More...</a><br /></td></tr>
<tr class="separator:a26fe81223d0bb0252639a9fa75f3efa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a057a428471d69e3d2e71c8aafed7712d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a057a428471d69e3d2e71c8aafed7712d">maggs_get_mesh_1D</a> ()</td></tr>
<tr class="memdesc:a057a428471d69e3d2e71c8aafed7712d"><td class="mdescLeft">&#160;</td><td class="mdescRight">get lattice size in one dimension  <a href="#a057a428471d69e3d2e71c8aafed7712d">More...</a><br /></td></tr>
<tr class="separator:a057a428471d69e3d2e71c8aafed7712d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16c169f5f6172b2ca241d238cd47313c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a16c169f5f6172b2ca241d238cd47313c">maggs_set_permittivity</a> (int node_x, int node_y, int node_z, int direction, double relative_epsilon)</td></tr>
<tr class="memdesc:a16c169f5f6172b2ca241d238cd47313c"><td class="mdescLeft">&#160;</td><td class="mdescRight">set permittivity for single lattice links  <a href="#a16c169f5f6172b2ca241d238cd47313c">More...</a><br /></td></tr>
<tr class="separator:a16c169f5f6172b2ca241d238cd47313c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ababc3fb3d16d027dbee2adb3e12b2f9c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ababc3fb3d16d027dbee2adb3e12b2f9c">maggs_exchange_surface_patch</a> (double *field, int dim, int e_equil)</td></tr>
<tr class="memdesc:ababc3fb3d16d027dbee2adb3e12b2f9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">MPI communication of surface region.  <a href="#ababc3fb3d16d027dbee2adb3e12b2f9c">More...</a><br /></td></tr>
<tr class="separator:ababc3fb3d16d027dbee2adb3e12b2f9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a949c2ba2dd4925c79b3cdac866d0e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a54a949c2ba2dd4925c79b3cdac866d0e">maggs_interpol1D</a> (double x)</td></tr>
<tr class="memdesc:a54a949c2ba2dd4925c79b3cdac866d0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolation function in one dimension.  <a href="#a54a949c2ba2dd4925c79b3cdac866d0e">More...</a><br /></td></tr>
<tr class="separator:a54a949c2ba2dd4925c79b3cdac866d0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45bad98f54d0db1b4e719bf7992aa2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#ae45bad98f54d0db1b4e719bf7992aa2e">maggs_interpolate_charge</a> (int *first, double *rel, double q)</td></tr>
<tr class="memdesc:ae45bad98f54d0db1b4e719bf7992aa2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the actual interpolating calculation.  <a href="#ae45bad98f54d0db1b4e719bf7992aa2e">More...</a><br /></td></tr>
<tr class="separator:ae45bad98f54d0db1b4e719bf7992aa2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa52aee5a4314109db73dcc6c40a8a032"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa52aee5a4314109db73dcc6c40a8a032">maggs_accumulate_charge_from_ghosts</a> ()</td></tr>
<tr class="memdesc:aa52aee5a4314109db73dcc6c40a8a032"><td class="mdescLeft">&#160;</td><td class="mdescRight">add charges from ghost cells to lattice sites.  <a href="#aa52aee5a4314109db73dcc6c40a8a032">More...</a><br /></td></tr>
<tr class="separator:aa52aee5a4314109db73dcc6c40a8a032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd85a7c6b78d6e4d672a12cdd37c973"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a5fd85a7c6b78d6e4d672a12cdd37c973">maggs_distribute_particle_charges</a> ()</td></tr>
<tr class="memdesc:a5fd85a7c6b78d6e4d672a12cdd37c973"><td class="mdescLeft">&#160;</td><td class="mdescRight">finds current lattice site of each particle.  <a href="#a5fd85a7c6b78d6e4d672a12cdd37c973">More...</a><br /></td></tr>
<tr class="separator:a5fd85a7c6b78d6e4d672a12cdd37c973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa946f5cf6f2a5ee6202804e0df1c6fea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa946f5cf6f2a5ee6202804e0df1c6fea">maggs_calc_charge_gradients</a> (double *rel, double q, double *grad)</td></tr>
<tr class="memdesc:aa946f5cf6f2a5ee6202804e0df1c6fea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the actual calculation of the gradient.  <a href="#aa946f5cf6f2a5ee6202804e0df1c6fea">More...</a><br /></td></tr>
<tr class="separator:aa946f5cf6f2a5ee6202804e0df1c6fea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45f54f0c2f4d666f04cd06d4cd0447b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a45f54f0c2f4d666f04cd06d4cd0447b7">maggs_update_charge_gradients</a> (double *grad)</td></tr>
<tr class="memdesc:a45f54f0c2f4d666f04cd06d4cd0447b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">finds correct lattice cube for particles.  <a href="#a45f54f0c2f4d666f04cd06d4cd0447b7">More...</a><br /></td></tr>
<tr class="separator:a45f54f0c2f4d666f04cd06d4cd0447b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6234f5d6faa3daed220b64dd28eeb24b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a6234f5d6faa3daed220b64dd28eeb24b">maggs_calc_self_energy_coeffs</a> ()</td></tr>
<tr class="memdesc:a6234f5d6faa3daed220b64dd28eeb24b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the self energy coefficients for the system, if corrected with <a class="el" href="classLattice.html">Lattice</a> Green's function.  <a href="#a6234f5d6faa3daed220b64dd28eeb24b">More...</a><br /></td></tr>
<tr class="separator:a6234f5d6faa3daed220b64dd28eeb24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1296f797ccc99d091e0c655a0f4f7c4a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a1296f797ccc99d091e0c655a0f4f7c4a">maggs_check_curl_E</a> ()</td></tr>
<tr class="memdesc:a1296f797ccc99d091e0c655a0f4f7c4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">For energy minimization:  <a href="#a1296f797ccc99d091e0c655a0f4f7c4a">More...</a><br /></td></tr>
<tr class="separator:a1296f797ccc99d091e0c655a0f4f7c4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75940b6e36c875517867239343c03759"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a75940b6e36c875517867239343c03759">maggs_perform_rot_move_inplane</a> (int <a class="el" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, int n)</td></tr>
<tr class="memdesc:a75940b6e36c875517867239343c03759"><td class="mdescLeft">&#160;</td><td class="mdescRight">If curl(E) is not zero, update plaquette with corrections.  <a href="#a75940b6e36c875517867239343c03759">More...</a><br /></td></tr>
<tr class="separator:a75940b6e36c875517867239343c03759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a3fb85341b77bc8ca3a735b37b72271"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a0a3fb85341b77bc8ca3a735b37b72271">maggs_minimize_transverse_field</a> ()</td></tr>
<tr class="memdesc:a0a3fb85341b77bc8ca3a735b37b72271"><td class="mdescLeft">&#160;</td><td class="mdescRight">For energy minimization: Relax B-fields in all directions.  <a href="#a0a3fb85341b77bc8ca3a735b37b72271">More...</a><br /></td></tr>
<tr class="separator:a0a3fb85341b77bc8ca3a735b37b72271"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0d0b7aaa7ae44587fd0963d103a82cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#af0d0b7aaa7ae44587fd0963d103a82cd">maggs_calc_init_e_field</a> ()</td></tr>
<tr class="memdesc:af0d0b7aaa7ae44587fd0963d103a82cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates initial electric field configuration.  <a href="#af0d0b7aaa7ae44587fd0963d103a82cd">More...</a><br /></td></tr>
<tr class="separator:af0d0b7aaa7ae44587fd0963d103a82cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5342bf1dca9ce7daccb8d24e8e3fca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#add5342bf1dca9ce7daccb8d24e8e3fca">maggs_calc_charge_fluxes_1D</a> (double q, double *help, double *flux, int dir)</td></tr>
<tr class="memdesc:add5342bf1dca9ce7daccb8d24e8e3fca"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the charge flux in direction "dir".  <a href="#add5342bf1dca9ce7daccb8d24e8e3fca">More...</a><br /></td></tr>
<tr class="separator:add5342bf1dca9ce7daccb8d24e8e3fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa55913564466ab03b6fc413ad0482bb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#afa55913564466ab03b6fc413ad0482bb">maggs_check_intersect_1D</a> (double delta, double r_new, int dir, int first, double *t_step, int <a class="el" href="statistics__correlation_8hpp.html#a61e7e746965ee25a9efd8bd6c15fc459">identity</a>)</td></tr>
<tr class="memdesc:afa55913564466ab03b6fc413ad0482bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extend particle trajectories on the one time step and check if the trajectory intersects the cell boundary in direction dirx#.  <a href="#afa55913564466ab03b6fc413ad0482bb">More...</a><br /></td></tr>
<tr class="separator:afa55913564466ab03b6fc413ad0482bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6057c32a84a76b71661dbd5b6621f0da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a6057c32a84a76b71661dbd5b6621f0da">maggs_calc_e_field_on_link_1D</a> (int index, double *flux, double v, int dir)</td></tr>
<tr class="memdesc:a6057c32a84a76b71661dbd5b6621f0da"><td class="mdescLeft">&#160;</td><td class="mdescRight">updates field on link coupling it with current.  <a href="#a6057c32a84a76b71661dbd5b6621f0da">More...</a><br /></td></tr>
<tr class="separator:a6057c32a84a76b71661dbd5b6621f0da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9b6d0a55142f5dfc704e9556ecb34d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa9b6d0a55142f5dfc704e9556ecb34d6">maggs_add_current_on_segment</a> (<a class="el" href="structParticle.html">Particle</a> *p, int ghost_cell)</td></tr>
<tr class="memdesc:aa9b6d0a55142f5dfc704e9556ecb34d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">loop over all cells and call charge current functions  <a href="#aa9b6d0a55142f5dfc704e9556ecb34d6">More...</a><br /></td></tr>
<tr class="separator:aa9b6d0a55142f5dfc704e9556ecb34d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4057e2cf6f0926734eef30ad0624b287"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a4057e2cf6f0926734eef30ad0624b287">maggs_couple_current_to_Dfield</a> ()</td></tr>
<tr class="memdesc:a4057e2cf6f0926734eef30ad0624b287"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate fluxes and couple them with fields symplectically.  <a href="#a4057e2cf6f0926734eef30ad0624b287">More...</a><br /></td></tr>
<tr class="separator:a4057e2cf6f0926734eef30ad0624b287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaee8a869e25c01bca6f13a3be50155ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aaee8a869e25c01bca6f13a3be50155ba">maggs_propagate_B_field</a> (double dt)</td></tr>
<tr class="memdesc:aaee8a869e25c01bca6f13a3be50155ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">propagate the B-field via <img class="formulaInl" alt="$\frac{\partial}{\partial t}{B} = \nabla\times D$" src="form_9.png"/> (and prefactor) CAREFUL: Usually this function is called twice, with dt/2 each time to ensure a time reversible integration scheme!  <a href="#aaee8a869e25c01bca6f13a3be50155ba">More...</a><br /></td></tr>
<tr class="separator:aaee8a869e25c01bca6f13a3be50155ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7a2d3a4e091afe85d566cd393a79e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aca7a2d3a4e091afe85d566cd393a79e0">maggs_add_transverse_field</a> (double dt)</td></tr>
<tr class="memdesc:aca7a2d3a4e091afe85d566cd393a79e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate D-field from B-field according to <img class="formulaInl" alt="$\frac{\partial}{\partial t}{D} = \nabla\times B$" src="form_10.png"/> (and prefactors)  <a href="#aca7a2d3a4e091afe85d566cd393a79e0">More...</a><br /></td></tr>
<tr class="separator:aca7a2d3a4e091afe85d566cd393a79e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da12cf5fc1aa7f488bf3d72c28fd811"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a3da12cf5fc1aa7f488bf3d72c28fd811">maggs_interpolate_part_charge_from_grad</a> (double *rel, double *grad, double *rho)</td></tr>
<tr class="memdesc:a3da12cf5fc1aa7f488bf3d72c28fd811"><td class="mdescLeft">&#160;</td><td class="mdescRight">interpolation function, solely for new self force correction.  <a href="#a3da12cf5fc1aa7f488bf3d72c28fd811">More...</a><br /></td></tr>
<tr class="separator:a3da12cf5fc1aa7f488bf3d72c28fd811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014767bbb2612baace2ed2bce601aa65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a014767bbb2612baace2ed2bce601aa65">maggs_calc_interpolated_self_force</a> (<a class="el" href="structParticle.html">Particle</a> *p)</td></tr>
<tr class="memdesc:a014767bbb2612baace2ed2bce601aa65"><td class="mdescLeft">&#160;</td><td class="mdescRight">new self force correction with lattice Green's function.  <a href="#a014767bbb2612baace2ed2bce601aa65">More...</a><br /></td></tr>
<tr class="separator:a014767bbb2612baace2ed2bce601aa65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16f182db77ba710d40fbe9f3e1c44bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#af16f182db77ba710d40fbe9f3e1c44bb">maggs_calc_self_influence</a> (<a class="el" href="structParticle.html">Particle</a> *P)</td></tr>
<tr class="memdesc:af16f182db77ba710d40fbe9f3e1c44bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each particle P, calculates self energy influence with direct Greens function, assuming constant permittivity on each lattice site.  <a href="#af16f182db77ba710d40fbe9f3e1c44bb">More...</a><br /></td></tr>
<tr class="separator:af16f182db77ba710d40fbe9f3e1c44bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a132fb5afa84a9849eb27506033a05f64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a132fb5afa84a9849eb27506033a05f64">maggs_calc_part_link_forces</a> (<a class="el" href="structParticle.html">Particle</a> *p, int index, double *grad)</td></tr>
<tr class="memdesc:a132fb5afa84a9849eb27506033a05f64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the actual force from the E-Field.  <a href="#a132fb5afa84a9849eb27506033a05f64">More...</a><br /></td></tr>
<tr class="separator:a132fb5afa84a9849eb27506033a05f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0078b38ad37dd27eae217b3e0d86a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a3e0078b38ad37dd27eae217b3e0d86a4">maggs_calc_forces</a> ()</td></tr>
<tr class="memdesc:a3e0078b38ad37dd27eae217b3e0d86a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public function.  <a href="#a3e0078b38ad37dd27eae217b3e0d86a4">More...</a><br /></td></tr>
<tr class="separator:a3e0078b38ad37dd27eae217b3e0d86a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5b2eff564c34eca511fb42b68181a6d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#af5b2eff564c34eca511fb42b68181a6d">maggs_electric_energy</a> ()</td></tr>
<tr class="memdesc:af5b2eff564c34eca511fb42b68181a6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">integrates 0.5*D*E over the whole system public function!  <a href="#af5b2eff564c34eca511fb42b68181a6d">More...</a><br /></td></tr>
<tr class="separator:af5b2eff564c34eca511fb42b68181a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a846b8c999bbf28cd40dcdc77f952f28a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a846b8c999bbf28cd40dcdc77f952f28a">maggs_magnetic_energy</a> ()</td></tr>
<tr class="memdesc:a846b8c999bbf28cd40dcdc77f952f28a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public funxtion.  <a href="#a846b8c999bbf28cd40dcdc77f952f28a">More...</a><br /></td></tr>
<tr class="separator:a846b8c999bbf28cd40dcdc77f952f28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a03751cecbfec2479818072ce503e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aa4a03751cecbfec2479818072ce503e1">maggs_init</a> ()</td></tr>
<tr class="memdesc:aa4a03751cecbfec2479818072ce503e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialization function.  <a href="#aa4a03751cecbfec2479818072ce503e1">More...</a><br /></td></tr>
<tr class="separator:aa4a03751cecbfec2479818072ce503e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ef0ea40ce4d8a531dbafe507ea17e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a99ef0ea40ce4d8a531dbafe507ea17e6">maggs_exit</a> ()</td></tr>
<tr class="memdesc:a99ef0ea40ce4d8a531dbafe507ea17e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the dynamically allocated memory Currently not called from anywhere.  <a href="#a99ef0ea40ce4d8a531dbafe507ea17e6">More...</a><br /></td></tr>
<tr class="separator:a99ef0ea40ce4d8a531dbafe507ea17e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1f05bc745e4b9abbd92ff21b9d0fba51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structMAGGS__struct.html">MAGGS_struct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a1f05bc745e4b9abbd92ff21b9d0fba51">maggs</a> = { 1, 1.0, 0. , 0. , 0. , 0. , 0. , 0 , 0. , 0. , {{0.},{0.}}}</td></tr>
<tr class="separator:a1f05bc745e4b9abbd92ff21b9d0fba51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477ce48d6b4d687b6309aa49ae62c64a"><td class="memItemLeft" align="right" valign="top">static lattice_parameters&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a></td></tr>
<tr class="separator:a477ce48d6b4d687b6309aa49ae62c64a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed96e0941bcf96f0430aee0678b32d02"><td class="memItemLeft" align="right" valign="top">static t_site *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#aed96e0941bcf96f0430aee0678b32d02">lattice</a></td></tr>
<tr class="separator:aed96e0941bcf96f0430aee0678b32d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a51c4996a5a8538afc8a76fcfd29866"><td class="memItemLeft" align="right" valign="top">static double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a2a51c4996a5a8538afc8a76fcfd29866">Dfield</a></td></tr>
<tr class="separator:a2a51c4996a5a8538afc8a76fcfd29866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41198699dcec2940bb1ee208fc239c96"><td class="memItemLeft" align="right" valign="top">static double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#a41198699dcec2940bb1ee208fc239c96">Bfield</a></td></tr>
<tr class="separator:a41198699dcec2940bb1ee208fc239c96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc000671ec8a1e4a80ad0fe660fae9f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="maggs_8cpp.html#acf885ab38916d9e7a6f0db3c0992dd98">t_dirs</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maggs_8cpp.html#afdc000671ec8a1e4a80ad0fe660fae9f">neighbor</a></td></tr>
<tr class="separator:afdc000671ec8a1e4a80ad0fe660fae9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Maxwell Equations Molecular Dynamics (MEMD) method for electrostatic interactions. </p>
<p>We use a local update scheme to propagate artificial B-fields on a lattice in the system. In principal, the algorithm simulates full electrodynamics, but with a tunable speed of light.</p>
<p>The method is very usable for large particle numbers or highly parallel architectures, since it is local and scales linearly. It is not suited for high-precision calculation of forces, since the simple interpolation scheme produces errors in the order of 10^-5 in the force.</p>
<p>The chosen mesh should roughly be of the size of the particles.</p>
<p>Further reading on the algorithm: I. Pasichnyk and B. Dunweg, Coulomb interaction via local dynamics: a molecular-dynamics algorithm. J. Phys: Condens. Matter, 16 ,p. 1399-4020, (2004).</p>
<p>We use a local update scheme to propagate artificial B-fields on a lattice in the system. In principal, the algorithm simulates full electrodynamics, but with a tunable speed of light.</p>
<p>The method is very usable for large particle numbers or highly parallel architectures, since it is local and scales linearly. It is not suited for high-precision calculation of forces, since the simple interpolation scheme produces errors in the order of 10^-5 in the force.</p>
<p>The chosen mesh should roughly be of the size of the particles.</p>
<p>Further reading on the algorithm: </p><ul>
<li>
I. Pasichnyk and B. Dunweg, Coulomb interaction via local dynamics: a molecular-dynamics algorithm. J. Phys: Condens. Matter, 16 ,p. 1399-4020, (2004). </li>
</ul>

<p>Definition in file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aa5e0d42b2844179a1efb06ba8f28827f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FOR3D</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dir</td><td>)</td>
          <td>&#160;&#160;&#160;for(dir=0; dir&lt;<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>; dir++)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00094">94</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01016">maggs_accumulate_charge_from_ghosts()</a>, <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>, <a class="el" href="maggs_8cpp_source.html#l01093">maggs_calc_charge_gradients()</a>, <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l02124">maggs_calc_self_influence()</a>, <a class="el" href="maggs_8cpp_source.html#l01890">maggs_couple_current_to_Dfield()</a>, <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>, <a class="el" href="maggs_8cpp_source.html#l02315">maggs_electric_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="maggs_8cpp_source.html#l02022">maggs_interpolate_part_charge_from_grad()</a>, <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00403">maggs_sanity_checks()</a>, <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>, and <a class="el" href="maggs_8cpp_source.html#l01125">maggs_update_charge_gradients()</a>.</p>

</div>
</div>
<a class="anchor" id="a52d86f9f5df94174ac5dade5435c0026"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FORALL_INNER_SITES</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">for</span>(<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.inner_left_down[0];<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.inner_up_right[0];<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)       \</div>
<div class="line">    for(j=<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.inner_left_down[1];j&lt;<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.inner_up_right[1];j++)   \</div>
<div class="line">      for(k=<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.inner_left_down[2];k&lt;<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.inner_up_right[2];k++)</div>
<div class="ttc" id="lbgpu_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="lbgpu_8cpp_source.html#l00161">lbgpu.cpp:161</a></div></div>
<div class="ttc" id="maggs_8cpp_html_a477ce48d6b4d687b6309aa49ae62c64a"><div class="ttname"><a href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a></div><div class="ttdeci">static lattice_parameters lparams</div><div class="ttdef"><b>Definition:</b> <a href="maggs_8cpp_source.html#l00160">maggs.cpp:160</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00096">96</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01242">maggs_check_curl_E()</a>, <a class="el" href="maggs_8cpp_source.html#l02315">maggs_electric_energy()</a>, and <a class="el" href="maggs_8cpp_source.html#l02338">maggs_magnetic_energy()</a>.</p>

</div>
</div>
<a class="anchor" id="a48c1984524973c1fb847691aa544018e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FORALL_SITES</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">j, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">k&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">for</span>(<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.dim[0];<a class="code" href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)                   \</div>
<div class="line">    <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.dim[1];j++)               \</div>
<div class="line">      <span class="keywordflow">for</span>(k=0;k&lt;<a class="code" href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a>.dim[2];k++)</div>
<div class="ttc" id="lbgpu_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="lbgpu_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="lbgpu_8cpp_source.html#l00161">lbgpu.cpp:161</a></div></div>
<div class="ttc" id="maggs_8cpp_html_a477ce48d6b4d687b6309aa49ae62c64a"><div class="ttname"><a href="maggs_8cpp.html#a477ce48d6b4d687b6309aa49ae62c64a">lparams</a></div><div class="ttdeci">static lattice_parameters lparams</div><div class="ttdef"><b>Definition:</b> <a href="maggs_8cpp_source.html#l00160">maggs.cpp:160</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00101">101</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>.</p>

</div>
</div>
<a class="anchor" id="a0f3dfd29bcc1f569a5989716c54b6fc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDIRS&#160;&#160;&#160;6				        /* number of directions */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00083">83</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8bf292e53bd4a7ca0cf7b164daf1997a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NOWHERE&#160;&#160;&#160;-1                  /* not a direction */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00082">82</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, and <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>.</p>

</div>
</div>
<a class="anchor" id="a267c0c2c638604582d7a4d4bfb997893"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPP_DIR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">dir</td><td>)</td>
          <td>&#160;&#160;&#160;(5-(dir))	/* Opposite direction */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00090">90</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00350">maggs_calc_curl()</a>.</p>

</div>
</div>
<a class="anchor" id="aa5acce35f01be6b31e717bfd142afb3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQ_MAGGS_EQUIL&#160;&#160;&#160;301</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00070">70</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>.</p>

</div>
</div>
<a class="anchor" id="afd91a9756c540bf036a8e8bada873bed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQ_MAGGS_SPREAD&#160;&#160;&#160;300</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00069">69</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>.</p>

</div>
</div>
<a class="anchor" id="af741baaff0ef249ec598d48615c74f66"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SELF_FACTOR_1&#160;&#160;&#160;1.57364595</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00074">74</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02124">maggs_calc_self_influence()</a>.</p>

</div>
</div>
<a class="anchor" id="aaf5ed2b50ab90839e10e145c732d19dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SELF_FACTOR_2&#160;&#160;&#160;1.5078141</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00075">75</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02124">maggs_calc_self_influence()</a>.</p>

</div>
</div>
<a class="anchor" id="a64e9854a38fcceea800337a3e30d4f96"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SPACE_DIM&#160;&#160;&#160;3                 /* number of dimensions */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00081">81</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01016">maggs_accumulate_charge_from_ghosts()</a>, <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>, <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01168">maggs_calc_self_energy_coeffs()</a>, <a class="el" href="maggs_8cpp_source.html#l02124">maggs_calc_self_influence()</a>, <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, and <a class="el" href="maggs_8cpp_source.html#l01125">maggs_update_charge_gradients()</a>.</p>

</div>
</div>
<a class="anchor" id="add3c1b4b97fa3888de75db1d08b051ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XMINUS&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00089">89</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="a47f7619de1dc9bd4313e7bca1e3c89ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define XPLUS&#160;&#160;&#160;0                     /* add for specific direction */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00084">84</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="a1351f1ff816687c3a5168d6419b5e69f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YMINUS&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00088">88</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="aa75e6ffe5a6f42d8d9a638cf7f204f02"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YPLUS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00085">85</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="ae2ec2662dc5b34b72c1150d91f46e352"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZMINUS&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00087">87</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="a59125b4bea2ca6afb92683ac56480530"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZPLUS&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00086">86</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="acf885ab38916d9e7a6f0db3c0992dd98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int t_dirs[<a class="el" href="maggs_8cpp.html#a0f3dfd29bcc1f569a5989716c54b6fc4">NDIRS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00113">113</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ad1198b4ee5559e64a58a935e8ff4d15c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef double t_dvector[<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00112">112</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a7e4663dc2d76e50cb125c31c10eb6321"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int t_ivector[<a class="el" href="maggs_8cpp.html#a64e9854a38fcceea800337a3e30d4f96">SPACE_DIM</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00111">111</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa52aee5a4314109db73dcc6c40a8a032"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_accumulate_charge_from_ghosts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add charges from ghost cells to lattice sites. </p>
<p>loop over ghost cells </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01016">1016</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="cells_8cpp_source.html#l00054">ghost_cells</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, and <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>.</p>

</div>
</div>
<a class="anchor" id="aa9b6d0a55142f5dfc704e9556ecb34d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_add_current_on_segment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ghost_cell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loop over all cells and call charge current functions </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td><a class="el" href="structParticle.html" title="Struct holding all information for one particle. ">Particle</a> pointer </td></tr>
    <tr><td class="paramname">ghost_cell</td><td>flag if cell is ghost cell </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01800">1800</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="particle__data_8hpp_source.html#l00077">ParticleProperties::identity</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="particle__data_8hpp_source.html#l00291">Particle::m</a>, <a class="el" href="maggs_8cpp_source.html#l01680">maggs_calc_charge_fluxes_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l01714">maggs_check_intersect_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00105">ParticleProperties::q</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>, and <a class="el" href="particle__data_8hpp_source.html#l00228">ParticleMomentum::v</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01890">maggs_couple_current_to_Dfield()</a>.</p>

</div>
</div>
<a class="anchor" id="aca7a2d3a4e091afe85d566cd393a79e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_add_transverse_field </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate D-field from B-field according to <img class="formulaInl" alt="$\frac{\partial}{\partial t}{D} = \nabla\times B$" src="form_10.png"/> (and prefactors) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>MD time step </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01986">1986</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00166">Bfield</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="maggs_8hpp_source.html#l00067">MAGGS_struct::invsqrt_f_mass</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00350">maggs_calc_curl()</a>, <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="add5342bf1dca9ce7daccb8d24e8e3fca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_charge_fluxes_1D </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>help</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the charge flux in direction "dir". </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>charge of the moving particle </td></tr>
    <tr><td class="paramname">help</td><td>the relative position in the cube to the opposite of left down front lattice site. </td></tr>
    <tr><td class="paramname">flux</td><td>flux variable to write into </td></tr>
    <tr><td class="paramname">dir</td><td>direction in which to calculate the flux </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01680">1680</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="maggs_8cpp_source.html#l00321">maggs_calc_directions()</a>, and <a class="el" href="maggs_8hpp_source.html#l00069">MAGGS_struct::prefactor</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>.</p>

</div>
</div>
<a class="anchor" id="aa946f5cf6f2a5ee6202804e0df1c6fea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_charge_gradients </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>grad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the actual calculation of the gradient. </p>
<p>Parameters: </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rel</td><td>3dim-array of relative position in cube, </td></tr>
    <tr><td class="paramname">q</td><td>charge, </td></tr>
    <tr><td class="paramname">grad</td><td>huge gradient array to write into </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01093">1093</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, and <a class="el" href="maggs_8cpp_source.html#l00321">maggs_calc_directions()</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01125">maggs_update_charge_gradients()</a>.</p>

</div>
</div>
<a class="anchor" id="a69e279ce3acd371e5d46010c7f10858f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_calc_curl </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the finite differences rotation in real space in mue-nue plane: <img class="formulaInl" alt="$\frac{\partial}{\partial t}{D} = \nabla \times B$" src="form_7.png"/> (and prefactors plus current) The given "double* field" should be a B-Field!! </p>
<dl class="section return"><dt>Returns</dt><dd>rotation result </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mue</td><td>direction 1 of plane to rotate in </td></tr>
    <tr><td class="paramname">nue</td><td>direction 2 of plane to rotate in </td></tr>
    <tr><td class="paramname">field</td><td>input B-field </td></tr>
    <tr><td class="paramname">Neighbor</td><td>neighbor lattice site </td></tr>
    <tr><td class="paramname">index</td><td>index of current lattice site </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00350">350</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00090">OPP_DIR</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>.</p>

</div>
</div>
<a class="anchor" id="a291c05b2f40c3a1f9cb05d2f747401f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_directions </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dir1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>dir2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For any direction j, write the two other directions into the pointers in circular permutation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">j</td><td>given first direction </td></tr>
    <tr><td class="paramname">dir1</td><td>write second direction into </td></tr>
    <tr><td class="paramname">dir2</td><td>write third direction into </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00321">321</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01680">maggs_calc_charge_fluxes_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l01093">maggs_calc_charge_gradients()</a>, <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, and <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="ad03c3b950586e2820505f11424c5d16d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_calc_dual_curl </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the finite differences rotation in dual space in mue-nue plane: <img class="formulaInl" alt="$\frac{\partial}{\partial t}{B} = - \nabla \times D / (\epsilon)$" src="form_8.png"/> The given "double* field" should be a D-Field!! </p>
<dl class="section return"><dt>Returns</dt><dd>rotation result </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mue</td><td>direction 1 of plane to rotate in </td></tr>
    <tr><td class="paramname">nue</td><td>direction 2 of plane to rotate in </td></tr>
    <tr><td class="paramname">field</td><td>input D-field </td></tr>
    <tr><td class="paramname">Neighbor</td><td>neighbor lattice site </td></tr>
    <tr><td class="paramname">index</td><td>index of current lattice site </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00370">370</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>.</p>

</div>
</div>
<a class="anchor" id="a6057c32a84a76b71661dbd5b6621f0da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_e_field_on_link_1D </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>updates field on link coupling it with current. </p>
<p>Force is multiplied by the time_step </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>index of lattice site </td></tr>
    <tr><td class="paramname">flux</td><td>charge flux in lattice site </td></tr>
    <tr><td class="paramname">v</td><td>speed of particle </td></tr>
    <tr><td class="paramname">dir</td><td>first direction of flux calculation </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01754">1754</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00321">maggs_calc_directions()</a>, <a class="el" href="maggs_8cpp_source.html#l00304">maggs_get_offset()</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, and <a class="el" href="maggs_8cpp_source.html#l00082">NOWHERE</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e0078b38ad37dd27eae217b3e0d86a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_forces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public function. </p>
<p>Calculate the forces on all particles.</p>
<p>Calculates the actual force on each particle by calling all other needed functions (except for maggs_propagate_B_field) </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02239">2239</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="cells_8cpp_source.html#l00275">cells_get_n_particles()</a>, <a class="el" href="maggs_8hpp_source.html#l00062">MAGGS_struct::finite_epsilon_flag</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l02124">maggs_calc_self_influence()</a>, <a class="el" href="maggs_8cpp_source.html#l00488">maggs_compute_dipole_correction()</a>, <a class="el" href="maggs_8cpp_source.html#l01890">maggs_couple_current_to_Dfield()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="debug_8hpp_source.html#l00174">MAGGS_TRACE</a>, <a class="el" href="maggs_8cpp_source.html#l01125">maggs_update_charge_gradients()</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="particle__data_8hpp_source.html#l00105">ParticleProperties::q</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="debug_8hpp_source.html#l00039">realloc</a>, <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>, and <a class="el" href="core_2integrate_8cpp_source.html#l00080">time_step</a>.</p>

<p>Referenced by <a class="el" href="forces_8cpp_source.html#l00152">calc_long_range_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="af0d0b7aaa7ae44587fd0963d103a82cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_init_e_field </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates initial electric field configuration. </p>
<p>currently uses simple and slow method of plaquettes and links. energy minimization takes up lots of time. </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01371">1371</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00090">CELL_GLOBAL_EXCHANGE</a>, <a class="el" href="cells_8cpp_source.html#l00331">cells_resort_particles()</a>, <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="maggs_8cpp_source.html#l00096">FORALL_INNER_SITES</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="random_8cpp_source.html#l00035">iy</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l01242">maggs_check_curl_E()</a>, <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>, <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>, <a class="el" href="debug_8hpp_source.html#l00174">MAGGS_TRACE</a>, <a class="el" href="maggs_8hpp_source.html#l00075">MAGGS_struct::mesh</a>, <a class="el" href="mpi_8h_source.html#l00205">MPI_Allreduce()</a>, <a class="el" href="mpi_8h_source.html#l00141">MPI_Comm_free()</a>, <a class="el" href="mpi_8h_source.html#l00140">MPI_Comm_split()</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00162">MPI_Recv()</a>, <a class="el" href="mpi_8h_source.html#l00166">MPI_Send()</a>, <a class="el" href="mpi_8h_source.html#l00089">MPI_SUM</a>, <a class="el" href="communication_8cpp_source.html#l00076">n_nodes</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="grid_8cpp_source.html#l00052">node_neighbors</a>, <a class="el" href="grid_8cpp_source.html#l00050">node_pos</a>, <a class="el" href="maggs_8hpp_source.html#l00069">MAGGS_struct::prefactor</a>, <a class="el" href="maggs_8cpp_source.html#l00070">REQ_MAGGS_EQUIL</a>, <a class="el" href="config_8hpp_source.html#l00103">ROUND_ERROR_PREC</a>, <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>, <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>, <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>, <a class="el" href="maggs_8cpp_source.html#l00089">XMINUS</a>, <a class="el" href="maggs_8cpp_source.html#l00084">XPLUS</a>, <a class="el" href="maggs_8cpp_source.html#l00088">YMINUS</a>, <a class="el" href="maggs_8cpp_source.html#l00085">YPLUS</a>, <a class="el" href="maggs_8cpp_source.html#l00087">ZMINUS</a>, and <a class="el" href="maggs_8cpp_source.html#l00086">ZPLUS</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02360">maggs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a014767bbb2612baace2ed2bce601aa65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_interpolated_self_force </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>new self force correction with lattice Green's function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td><a class="el" href="structParticle.html" title="Struct holding all information for one particle. ">Particle</a> pointer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02065">2065</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a132fb5afa84a9849eb27506033a05f64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_part_link_forces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>grad</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the actual force from the E-Field. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td><a class="el" href="structParticle.html" title="Struct holding all information for one particle. ">Particle</a> pointer </td></tr>
    <tr><td class="paramname">index</td><td>index of the lattice site </td></tr>
    <tr><td class="paramname">grad</td><td>charge gradient </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02188">2188</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="particle__data_8hpp_source.html#l00211">ParticleForce::f</a>, <a class="el" href="particle__data_8hpp_source.html#l00293">Particle::f</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00321">maggs_calc_directions()</a>, <a class="el" href="maggs_8cpp_source.html#l00304">maggs_get_offset()</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="maggs_8hpp_source.html#l00069">MAGGS_struct::prefactor</a>, and <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="a6234f5d6faa3daed220b64dd28eeb24b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_self_energy_coeffs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the self energy coefficients for the system, if corrected with <a class="el" href="classLattice.html">Lattice</a> Green's function. </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01168">1168</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00081">MAGGS_struct::alpha</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="config_8hpp_source.html#l00145">M_PI</a>, <a class="el" href="maggs_8hpp_source.html#l00075">MAGGS_struct::mesh</a>, <a class="el" href="maggs_8hpp_source.html#l00069">MAGGS_struct::prefactor</a>, <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02360">maggs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="af16f182db77ba710d40fbe9f3e1c44bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_self_influence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structParticle.html">Particle</a> *&#160;</td>
          <td class="paramname"><em>P</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each particle P, calculates self energy influence with direct Greens function, assuming constant permittivity on each lattice site. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P</td><td><a class="el" href="structParticle.html" title="Struct holding all information for one particle. ">Particle</a> pointer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02124">2124</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00073">MAGGS_struct::bjerrum</a>, <a class="el" href="particle__data_8hpp_source.html#l00211">ParticleForce::f</a>, <a class="el" href="particle__data_8hpp_source.html#l00293">Particle::f</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00105">ParticleProperties::q</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, <a class="el" href="maggs_8cpp_source.html#l00074">SELF_FACTOR_1</a>, <a class="el" href="maggs_8cpp_source.html#l00075">SELF_FACTOR_2</a>, and <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="a46d3803f720ae0f69dc0b1bcaa9a2c0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_calc_surface_patches </td>
          <td>(</td>
          <td class="paramtype">t_surf_patch *&#160;</td>
          <td class="paramname"><em>surface_patch</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets up surface patches for all domains. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">surface_patch</td><td>the local surface patch </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00706">706</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>.</p>

</div>
</div>
<a class="anchor" id="a1296f797ccc99d091e0c655a0f4f7c4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_check_curl_E </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For energy minimization: </p>
<dl class="section return"><dt>Returns</dt><dd>maximum of curl(E) from all sites. May also be used to verify constraint surface condition. </dd></dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01242">1242</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="maggs_8cpp_source.html#l00096">FORALL_INNER_SITES</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="random_8cpp_source.html#l00035">iy</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="mpi_8h_source.html#l00205">MPI_Allreduce()</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00090">MPI_MAX</a>, and <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>.</p>

</div>
</div>
<a class="anchor" id="afa55913564466ab03b6fc413ad0482bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_check_intersect_1D </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>t_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>identity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extend particle trajectories on the one time step and check if the trajectory intersects the cell boundary in direction dirx#. </p>
<dl class="section return"><dt>Returns</dt><dd>zero if no particle crosses intersection </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">delta</td><td>amount by which the particle moves </td></tr>
    <tr><td class="paramname">r_new</td><td>current position of particle </td></tr>
    <tr><td class="paramname">dir</td><td>direction in which to check for intersection </td></tr>
    <tr><td class="paramname">first</td><td>position of particle within lattice cube </td></tr>
    <tr><td class="paramname">t_step</td><td>time step </td></tr>
    <tr><td class="paramname">identity</td><td>particle ID </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01714">1714</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00079">MAGGS_struct::a</a>, <a class="el" href="debug_8hpp_source.html#l00174">MAGGS_TRACE</a>, and <a class="el" href="core_2integrate_8cpp_source.html#l00085">sim_time</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>.</p>

</div>
</div>
<a class="anchor" id="a91dbd110b6367afc3583486b26b6df33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_compute_dipole_correction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00488">488</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="maggs_8hpp_source.html#l00063">MAGGS_struct::epsilon_infty</a>, <a class="el" href="particle__data_8hpp_source.html#l00293">Particle::f</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="config_8hpp_source.html#l00145">M_PI</a>, <a class="el" href="mpi_8h_source.html#l00205">MPI_Allreduce()</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00089">MPI_SUM</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, and <a class="el" href="particle__data_8hpp_source.html#l00105">ParticleProperties::q</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="a732da4b4674754a644acde094074b23f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_count_charged_particles </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counts the total number of charged particles on all processors. </p>
<p>Count the number of charges in the whole system.</p>
<dl class="section return"><dt>Returns</dt><dd>total number of charged particles in the system </dd></dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00272">272</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00203">MPI_Reduce()</a>, <a class="el" href="mpi_8h_source.html#l00089">MPI_SUM</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, and <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>.</p>

<p>Referenced by <a class="el" href="communication_8cpp_source.html#l00404">mpi_bcast_event_slave()</a>.</p>

</div>
</div>
<a class="anchor" id="a4057e2cf6f0926734eef30ad0624b287"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_couple_current_to_Dfield </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate fluxes and couple them with fields symplectically. </p>
<p>It is assumed that the particle can not cross more than one cell boundary per direction </p>
<p>loop over real particles</p>
<p>loop over ghost particles </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01890">1890</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="cells_8cpp_source.html#l00054">ghost_cells</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="particle__data_8hpp_source.html#l00291">Particle::m</a>, <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, and <a class="el" href="particle__data_8hpp_source.html#l00228">ParticleMomentum::v</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="a5fd85a7c6b78d6e4d672a12cdd37c973"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_distribute_particle_charges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>finds current lattice site of each particle. </p>
<p>calculates charge interpolation on cube. </p>
<p>=== charge assignment ===</p>
<p>loop over inner cells </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01057">1057</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l01016">maggs_accumulate_charge_from_ghosts()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, and <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>.</p>

</div>
</div>
<a class="anchor" id="af5b2eff564c34eca511fb42b68181a6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_electric_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>integrates 0.5*D*E over the whole system public function! </p>
<p>Get the electric energy of the system as return value.</p>
<dl class="section return"><dt>Returns</dt><dd>returns electric energy </dd></dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02315">2315</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00079">MAGGS_struct::a</a>, <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="maggs_8cpp_source.html#l00096">FORALL_INNER_SITES</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="mpi_8h_source.html#l00205">MPI_Allreduce()</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00089">MPI_SUM</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

<p>Referenced by <a class="el" href="energy_8cpp_source.html#l00173">calc_long_range_energies()</a>.</p>

</div>
</div>
<a class="anchor" id="ababc3fb3d16d027dbee2adb3e12b2f9c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_exchange_surface_patch </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_equil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MPI communication of surface region. </p>
<p>works for D- and B-fields. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>Field to communicate. Can be B- or D-field. </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension in which to communicate </td></tr>
    <tr><td class="paramname">e_equil</td><td>Flag if field is already equilibated </td></tr>
  </table>
  </dd>
</dl>
<p>surface_patch</p>
<p>direction loop</p>
<p>pack send halo-plane data</p>
<p>communication</p>
<p>copy locally </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00825">825</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="communication_8cpp_source.html#l00077">comm_cart</a>, <a class="el" href="maggs_8cpp_source.html#l00706">maggs_calc_surface_patches()</a>, <a class="el" href="maggs_8cpp_source.html#l00771">maggs_prepare_surface_planes()</a>, <a class="el" href="mpi_8h_source.html#l00115">MPI_BYTE</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00164">MPI_Irecv()</a>, <a class="el" href="mpi_8h_source.html#l00171">MPI_Isend()</a>, <a class="el" href="mpi_8h_source.html#l00098">MPI_REQUEST_NULL</a>, <a class="el" href="mpi_8h_source.html#l00142">MPI_Type_commit()</a>, <a class="el" href="mpi_8cpp_source.html#l00080">MPI_Type_contiguous()</a>, <a class="el" href="mpi_8cpp_source.html#l00141">MPI_Type_create_hvector()</a>, <a class="el" href="mpi_8cpp_source.html#l00101">MPI_Type_vector()</a>, <a class="el" href="mpi_8h_source.html#l00151">MPI_Waitall()</a>, <a class="el" href="grid_8cpp_source.html#l00052">node_neighbors</a>, <a class="el" href="maggs_8cpp_source.html#l00069">REQ_MAGGS_SPREAD</a>, <a class="el" href="communication_8cpp_source.html#l00193">request</a>, and <a class="el" href="communication_8cpp_source.html#l00075">this_node</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>, and <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>.</p>

</div>
</div>
<a class="anchor" id="a99ef0ea40ce4d8a531dbafe507ea17e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_exit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the dynamically allocated memory Currently not called from anywhere. </p>
<p>Clean up, free memory.</p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02388">2388</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00166">Bfield</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="debug_8hpp_source.html#l00041">free</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, and <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>.</p>

</div>
</div>
<a class="anchor" id="ab898188966901a730f3fa52d1a64fe09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_get_linear_index </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>latticedim</em>[SPACE_DIM]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns the 3D index into a linear index. </p>
<p>adim contains the dimensions of the lattice in the 3 directions: adim[0] = x_max, ..., adim[2] = z_max z is the first index!!! </p><dl class="section return"><dt>Returns</dt><dd>linear index </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>index in x direction </td></tr>
    <tr><td class="paramname">y</td><td>index in y direction </td></tr>
    <tr><td class="paramname">z</td><td>index in z direction </td></tr>
    <tr><td class="paramname">latticedim</td><td>dimensions of the lattice </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00263">263</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00085">YPLUS</a>, and <a class="el" href="maggs_8cpp_source.html#l00086">ZPLUS</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>, <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01242">maggs_check_curl_E()</a>, <a class="el" href="maggs_8cpp_source.html#l02315">maggs_electric_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="maggs_8cpp_source.html#l02338">maggs_magnetic_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00799">maggs_set_permittivity()</a>, <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
<a class="anchor" id="a057a428471d69e3d2e71c8aafed7712d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_get_mesh_1D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>get lattice size in one dimension </p>
<dl class="section return"><dt>Returns</dt><dd>mesh in 1D </dd></dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00787">787</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00075">MAGGS_struct::mesh</a>.</p>

<p>Referenced by <a class="el" href="maggs__tcl_8cpp_source.html#l00056">tclcommand_localeps()</a>.</p>

</div>
</div>
<a class="anchor" id="a9a633d1edb624af06f00f86e370ce058"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_get_offset </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>axes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>adim</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Index shift is calculated for moving in various directions with the linear index. </p>
<dl class="section return"><dt>Returns</dt><dd>Offset of current node from base </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index_shift</td><td>amount to move in direction </td></tr>
    <tr><td class="paramname">index_base</td><td>index of base on current processor </td></tr>
    <tr><td class="paramname">axes</td><td>in which direction to move </td></tr>
    <tr><td class="paramname">adim</td><td>dimensions of the local lattice </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00304">304</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, and <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>.</p>

</div>
</div>
<a class="anchor" id="aa4a03751cecbfec2479818072ce503e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialization function. </p>
<p>initialization function, parse command and set parameters.</p>
<p>Sets maggs structure variables. Calls calculation of initial D-field. </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02360">2360</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00079">MAGGS_struct::a</a>, <a class="el" href="maggs_8hpp_source.html#l00073">MAGGS_struct::bjerrum</a>, <a class="el" href="interaction__data_8hpp_source.html#l00522">Coulomb_parameters::bjerrum</a>, <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="interaction__data_8cpp_source.html#l00075">coulomb</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="config_8hpp_source.html#l00145">M_PI</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01168">maggs_calc_self_energy_coeffs()</a>, <a class="el" href="maggs_8cpp_source.html#l00403">maggs_sanity_checks()</a>, <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>, <a class="el" href="maggs_8hpp_source.html#l00075">MAGGS_struct::mesh</a>, <a class="el" href="maggs_8hpp_source.html#l00071">MAGGS_struct::pref2</a>, <a class="el" href="maggs_8hpp_source.html#l00069">MAGGS_struct::prefactor</a>, and <a class="el" href="core_2thermostat_8cpp_source.html#l00041">temperature</a>.</p>

<p>Referenced by <a class="el" href="initialize_8cpp_source.html#l00423">on_boxl_change()</a>, <a class="el" href="initialize_8cpp_source.html#l00476">on_cell_structure_change()</a>, <a class="el" href="initialize_8cpp_source.html#l00291">on_coulomb_change()</a>, and <a class="el" href="initialize_8cpp_source.html#l00226">on_observable_calc()</a>.</p>

</div>
</div>
<a class="anchor" id="a54a949c2ba2dd4925c79b3cdac866d0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_interpol1D </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interpolation function in one dimension. </p>
<p>Currently only linear interpolation conserves charge. </p><dl class="section return"><dt>Returns</dt><dd>interpolation value </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>relative position of particle </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00958">958</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>.</p>

</div>
</div>
<a class="anchor" id="ae45bad98f54d0db1b4e719bf7992aa2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_interpolate_charge </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the actual interpolating calculation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first</td><td>3dim-array lattice position, </td></tr>
    <tr><td class="paramname">rel</td><td>3dim-array relative position in cube, </td></tr>
    <tr><td class="paramname">q</td><td>charge to interpolate </td></tr>
  </table>
  </dd>
</dl>
<p>relative pos. w.r.t. first</p>
<p>calculate charges at each vertex </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00971">971</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="maggs_8cpp_source.html#l00304">maggs_get_offset()</a>, <a class="el" href="maggs_8cpp_source.html#l00958">maggs_interpol1D()</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="maggs_8cpp_source.html#l00082">NOWHERE</a>, and <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01016">maggs_accumulate_charge_from_ghosts()</a>, and <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>.</p>

</div>
</div>
<a class="anchor" id="a3da12cf5fc1aa7f488bf3d72c28fd811"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_interpolate_part_charge_from_grad </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>rho</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>interpolation function, solely for new self force correction. </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02022">2022</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

</div>
</div>
<a class="anchor" id="a846b8c999bbf28cd40dcdc77f952f28a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_magnetic_energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public funxtion. </p>
<p>Get the magnetic energy of the artificial transversal field component as return value.</p>
<p>Integrates the B-field over the whole system to get the energy of the magnetic field. </p><dl class="section return"><dt>Returns</dt><dd>returns magnetic energy </dd></dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l02338">2338</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00079">MAGGS_struct::a</a>, <a class="el" href="maggs_8cpp_source.html#l00166">Bfield</a>, <a class="el" href="maggs_8cpp_source.html#l00096">FORALL_INNER_SITES</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, and <a class="el" href="utils_8hpp_source.html#l00346">SQR()</a>.</p>

</div>
</div>
<a class="anchor" id="a0a3fb85341b77bc8ca3a735b37b72271"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_minimize_transverse_field </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For energy minimization: Relax B-fields in all directions. </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01312">1312</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, and <a class="el" href="maggs_8cpp_source.html#l01274">maggs_perform_rot_move_inplane()</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>.</p>

</div>
</div>
<a class="anchor" id="a75940b6e36c875517867239343c03759"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_perform_rot_move_inplane </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If curl(E) is not zero, update plaquette with corrections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>index of the current lattice site </td></tr>
    <tr><td class="paramname">n</td><td>coordinate, is the normal direction to the plaquette </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01274">1274</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8cpp_source.html#l00390">maggs_update_plaquette()</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, and <a class="el" href="config_8hpp_source.html#l00103">ROUND_ERROR_PREC</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>.</p>

</div>
</div>
<a class="anchor" id="a26fe81223d0bb0252639a9fa75f3efa7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_prepare_surface_planes </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mpi_8h.html#af9d011bc903ab240995ba0071fb31c61">MPI_Datatype</a> *&#160;</td>
          <td class="paramname"><em>xy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mpi_8h.html#af9d011bc903ab240995ba0071fb31c61">MPI_Datatype</a> *&#160;</td>
          <td class="paramname"><em>xz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mpi_8h.html#af9d011bc903ab240995ba0071fb31c61">MPI_Datatype</a> *&#160;</td>
          <td class="paramname"><em>yz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">t_surf_patch *&#160;</td>
          <td class="paramname"><em>surface_patch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets up MPI communications for domain surfaces </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00771">771</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="mpi_8h_source.html#l00115">MPI_BYTE</a>, <a class="el" href="mpi_8h_source.html#l00114">MPI_DOUBLE</a>, <a class="el" href="mpi_8h_source.html#l00142">MPI_Type_commit()</a>, <a class="el" href="mpi_8cpp_source.html#l00080">MPI_Type_contiguous()</a>, and <a class="el" href="mpi_8cpp_source.html#l00101">MPI_Type_vector()</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>.</p>

</div>
</div>
<a class="anchor" id="aaee8a869e25c01bca6f13a3be50155ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_propagate_B_field </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>propagate the B-field via <img class="formulaInl" alt="$\frac{\partial}{\partial t}{B} = \nabla\times D$" src="form_9.png"/> (and prefactor) CAREFUL: Usually this function is called twice, with dt/2 each time to ensure a time reversible integration scheme! </p>
<p>Propagate the B-field in the system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>time step for update. Should be half the MD time step </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01953">1953</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00166">Bfield</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00067">MAGGS_struct::invsqrt_f_mass</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00370">maggs_calc_dual_curl()</a>, <a class="el" href="maggs_8cpp_source.html#l00825">maggs_exchange_surface_patch()</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, and <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>.</p>

<p>Referenced by <a class="el" href="integrate__sd_8cpp_source.html#l00138">integrate_sd()</a>, and <a class="el" href="core_2integrate_8cpp_source.html#l00231">integrate_vv()</a>.</p>

</div>
</div>
<a class="anchor" id="a2d01b0f599fd5360cfef5a5c15aec6c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_sanity_checks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Basic sanity checks to see if the code will run. </p>
<dl class="section return"><dt>Returns</dt><dd>zero if everything is fine. -1 otherwise. </dd></dl>
<p>check if speed of light parameter makes sense</p>
<p>check for fixed particles </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00403">403</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00079">MAGGS_struct::a</a>, <a class="el" href="maggs_8hpp_source.html#l00073">MAGGS_struct::bjerrum</a>, <a class="el" href="grid_8cpp_source.html#l00062">box_l</a>, <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="cells_8cpp_source.html#l00057">cell_structure</a>, <a class="el" href="cells_8hpp_source.html#l00077">CELL_STRUCTURE_DOMDEC</a>, <a class="el" href="particle__data_8hpp_source.html#l00053">COORDS_FIX_MASK</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l00057">dd</a>, <a class="el" href="particle__data_8hpp_source.html#l00166">ParticleProperties::ext_flag</a>, <a class="el" href="maggs_8hpp_source.html#l00065">MAGGS_struct::f_mass</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="maggs_8hpp_source.html#l00075">MAGGS_struct::mesh</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="grid_8cpp_source.html#l00049">node_grid</a>, <a class="el" href="particle__data_8hpp_source.html#l00287">Particle::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="grid_8hpp_source.html#l00054">PERIODIC</a>, <a class="el" href="errorhandling_8hpp_source.html#l00056">runtimeError</a>, <a class="el" href="core_2integrate_8cpp_source.html#l00086">skin</a>, <a class="el" href="core_2integrate_8cpp_source.html#l00080">time_step</a>, <a class="el" href="cells_8hpp_source.html#l00132">CellStructure::type</a>, and <a class="el" href="domain__decomposition_8hpp_source.html#l00108">DomainDecomposition::use_vList</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02360">maggs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ae84d27d4b75007ae430c25ef2a82679b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int maggs_set_parameters </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bjerrum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f_mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>finite_epsilon_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon_infty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>called from: <a class="el" href="initialize_8cpp.html" title="Implementation of initialize.hpp. ">initialize.cpp</a> </p>
<p>set the main parameters for the algorithm. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bjerrum</td><td>Bjerrum length for the system </td></tr>
    <tr><td class="paramname">f_mass</td><td>parameter to tune the speed of light (1/c^2) </td></tr>
    <tr><td class="paramname">mesh</td><td>Mesh size in one dimension </td></tr>
    <tr><td class="paramname">finite_epsilon_flag</td><td>whether to do epsilon-at-infinity-correction </td></tr>
    <tr><td class="paramname">epsilon_infty</td><td>epsilon-at-infinity </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00540">540</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00073">MAGGS_struct::bjerrum</a>, <a class="el" href="maggs_8hpp_source.html#l00063">MAGGS_struct::epsilon_infty</a>, <a class="el" href="utils_8hpp_source.html#l00056">ES_OK</a>, <a class="el" href="maggs_8hpp_source.html#l00065">MAGGS_struct::f_mass</a>, <a class="el" href="maggs_8hpp_source.html#l00062">MAGGS_struct::finite_epsilon_flag</a>, <a class="el" href="maggs_8hpp_source.html#l00067">MAGGS_struct::invsqrt_f_mass</a>, <a class="el" href="maggs_8hpp_source.html#l00075">MAGGS_struct::mesh</a>, and <a class="el" href="communication_8cpp_source.html#l01873">mpi_bcast_coulomb_params()</a>.</p>

<p>Referenced by <a class="el" href="maggs__tcl_8cpp_source.html#l00118">tclcommand_inter_coulomb_parse_maggs()</a>.</p>

</div>
</div>
<a class="anchor" id="a16c169f5f6172b2ca241d238cd47313c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double maggs_set_permittivity </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>node_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>node_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>node_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>relative_epsilon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set permittivity for single lattice links </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node_x</td><td>index of the node in x direction </td></tr>
    <tr><td class="paramname">node_y</td><td>index of the node in y direction </td></tr>
    <tr><td class="paramname">node_z</td><td>index of the node in z direction </td></tr>
    <tr><td class="paramname">direction</td><td>direction in which the link points from the node. 0 is for x, 1 is for y, 2 is for z </td></tr>
    <tr><td class="paramname">relative_epsilon</td><td>permittivity to set, relative to the background permittivity set by the bjerrum length </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00799">799</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, and <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>.</p>

<p>Referenced by <a class="el" href="maggs__tcl_8cpp_source.html#l00056">tclcommand_localeps()</a>.</p>

</div>
</div>
<a class="anchor" id="af65958a28d942ac8104e4887c932d0fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_setup_local_lattice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up lattice, calculate dimensions and lattice parameters Allocate memory for lattice sites and fields. </p>
<p>inner left down grid point (global index)</p>
<p>inner up right grid point (global index)</p>
<p>correct roundof errors at boundary</p>
<p>inner grid dimensions</p>
<p>spacial position of left down grid point</p>
<p>spacial position of upper right grid point</p>
<p>left down margin</p>
<p>up right margin</p>
<p>reduce inner grid indices from global to local</p>
<p>allocate memory for sites and neighbors</p>
<p>set up lattice sites </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00633">633</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8hpp_source.html#l00079">MAGGS_struct::a</a>, <a class="el" href="maggs_8cpp_source.html#l00166">Bfield</a>, <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="maggs_8cpp_source.html#l00101">FORALL_SITES</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="random_8cpp_source.html#l00035">iy</a>, <a class="el" href="maggs_8cpp_source.html#l00162">lattice</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>, <a class="el" href="debug_8hpp_source.html#l00040">malloc</a>, <a class="el" href="grid_8cpp_source.html#l00067">my_left</a>, <a class="el" href="grid_8cpp_source.html#l00068">my_right</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, and <a class="el" href="config_8hpp_source.html#l00103">ROUND_ERROR_PREC</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02360">maggs_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a78de9fb74f1de85a6d93cf068dfe3d4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_setup_neighbors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>sets up nearest neighbors for each site in linear index </p>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00563">563</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="random_8cpp_source.html#l00035">iy</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l00263">maggs_get_linear_index()</a>, <a class="el" href="maggs_8cpp_source.html#l00168">neighbor</a>, <a class="el" href="maggs_8cpp_source.html#l00089">XMINUS</a>, <a class="el" href="maggs_8cpp_source.html#l00084">XPLUS</a>, <a class="el" href="maggs_8cpp_source.html#l00088">YMINUS</a>, <a class="el" href="maggs_8cpp_source.html#l00085">YPLUS</a>, <a class="el" href="maggs_8cpp_source.html#l00087">ZMINUS</a>, and <a class="el" href="maggs_8cpp_source.html#l00086">ZPLUS</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>.</p>

</div>
</div>
<a class="anchor" id="a45f54f0c2f4d666f04cd06d4cd0447b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_update_charge_gradients </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>grad</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>finds correct lattice cube for particles. </p>
<p>calculates charge gradients on this cube. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grad</td><td>gradient array to write into </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l01125">1125</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="cells_8hpp_source.html#l00119">CellPList::cell</a>, <a class="el" href="maggs_8cpp_source.html#l00094">FOR3D</a>, <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>, <a class="el" href="maggs_8hpp_source.html#l00077">MAGGS_struct::inva</a>, <a class="el" href="cells_8cpp_source.html#l00052">local_cells</a>, <a class="el" href="maggs_8cpp_source.html#l00160">lparams</a>, <a class="el" href="maggs_8cpp_source.html#l01093">maggs_calc_charge_gradients()</a>, <a class="el" href="cells_8hpp_source.html#l00120">CellPList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00324">ParticleList::n</a>, <a class="el" href="particle__data_8hpp_source.html#l00182">ParticlePosition::p</a>, <a class="el" href="particle__data_8hpp_source.html#l00322">ParticleList::part</a>, <a class="el" href="particle__data_8hpp_source.html#l00289">Particle::r</a>, and <a class="el" href="maggs_8cpp_source.html#l00081">SPACE_DIM</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>.</p>

</div>
</div>
<a class="anchor" id="a61def1d0aa3c1b2fa211b8107b2c1564"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maggs_update_plaquette </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>Neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>updates all D-fields on links of the plaquette and the surroundings. </p>
<p>delta was calculated before in function "maggs_perform_rot_move_inplane". </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mue</td><td>direction 1 of update </td></tr>
    <tr><td class="paramname">nue</td><td>direction 2 of update </td></tr>
    <tr><td class="paramname">Neighbor</td><td>neighbor lattice site </td></tr>
    <tr><td class="paramname">index</td><td>index of current lattice site </td></tr>
    <tr><td class="paramname">delta</td><td>by which amount to update field </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00390">390</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>References <a class="el" href="maggs_8cpp_source.html#l00164">Dfield</a>, and <a class="el" href="lbgpu_8cpp_source.html#l00161">i</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01274">maggs_perform_rot_move_inplane()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a41198699dcec2940bb1ee208fc239c96"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* Bfield</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00166">166</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02388">maggs_exit()</a>, <a class="el" href="maggs_8cpp_source.html#l02338">maggs_magnetic_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>, and <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>.</p>

</div>
</div>
<a class="anchor" id="a2a51c4996a5a8538afc8a76fcfd29866"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* Dfield</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00164">164</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01242">maggs_check_curl_E()</a>, <a class="el" href="maggs_8cpp_source.html#l02315">maggs_electric_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l02388">maggs_exit()</a>, <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01274">maggs_perform_rot_move_inplane()</a>, <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>, and <a class="el" href="maggs_8cpp_source.html#l00390">maggs_update_plaquette()</a>.</p>

</div>
</div>
<a class="anchor" id="aed96e0941bcf96f0430aee0678b32d02"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">t_site* lattice</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00162">162</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>, <a class="el" href="maggs_8cpp_source.html#l02315">maggs_electric_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l02388">maggs_exit()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="maggs_8cpp_source.html#l00799">maggs_set_permittivity()</a>, and <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>.</p>

</div>
</div>
<a class="anchor" id="a477ce48d6b4d687b6309aa49ae62c64a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">lattice_parameters lparams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00160">160</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="maggs_8cpp_source.html#l01016">maggs_accumulate_charge_from_ghosts()</a>, <a class="el" href="maggs_8cpp_source.html#l01800">maggs_add_current_on_segment()</a>, <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l02239">maggs_calc_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l02124">maggs_calc_self_influence()</a>, <a class="el" href="maggs_8cpp_source.html#l00706">maggs_calc_surface_patches()</a>, <a class="el" href="maggs_8cpp_source.html#l01242">maggs_check_curl_E()</a>, <a class="el" href="maggs_8cpp_source.html#l01890">maggs_couple_current_to_Dfield()</a>, <a class="el" href="maggs_8cpp_source.html#l01057">maggs_distribute_particle_charges()</a>, <a class="el" href="maggs_8cpp_source.html#l02315">maggs_electric_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="maggs_8cpp_source.html#l02338">maggs_magnetic_energy()</a>, <a class="el" href="maggs_8cpp_source.html#l01312">maggs_minimize_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00799">maggs_set_permittivity()</a>, <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>, <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>, and <a class="el" href="maggs_8cpp_source.html#l01125">maggs_update_charge_gradients()</a>.</p>

</div>
</div>
<a class="anchor" id="a1f05bc745e4b9abbd92ff21b9d0fba51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structMAGGS__struct.html">MAGGS_struct</a> maggs = { 1, 1.0, 0. , 0. , 0. , 0. , 0. , 0 , 0. , 0. , {{0.},{0.}}}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00157">157</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="communication_8cpp_source.html#l01881">mpi_bcast_coulomb_params_slave()</a>, and <a class="el" href="maggs__tcl_8cpp_source.html#l00179">tclprint_to_result_Maggs()</a>.</p>

</div>
</div>
<a class="anchor" id="afdc000671ec8a1e4a80ad0fe660fae9f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="maggs_8cpp.html#acf885ab38916d9e7a6f0db3c0992dd98">t_dirs</a>* neighbor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="maggs_8cpp_source.html#l00168">168</a> of file <a class="el" href="maggs_8cpp_source.html">maggs.cpp</a>.</p>

<p>Referenced by <a class="el" href="verlet_8cpp_source.html#l00095">build_verlet_lists()</a>, <a class="el" href="verlet_8cpp_source.html#l00213">build_verlet_lists_and_calc_verlet_ia()</a>, <a class="el" href="iccp3m_8cpp_source.html#l00336">build_verlet_lists_and_calc_verlet_ia_iccp3m()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l01135">calc_link_cell()</a>, <a class="el" href="iccp3m_8cpp_source.html#l00436">calc_link_cell_iccp3m()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l01188">calculate_link_cell_energies()</a>, <a class="el" href="domain__decomposition_8cpp_source.html#l01244">calculate_link_cell_virials()</a>, <a class="el" href="maggs_8cpp_source.html#l01986">maggs_add_transverse_field()</a>, <a class="el" href="maggs_8cpp_source.html#l01754">maggs_calc_e_field_on_link_1D()</a>, <a class="el" href="maggs_8cpp_source.html#l01371">maggs_calc_init_e_field()</a>, <a class="el" href="maggs_8cpp_source.html#l02188">maggs_calc_part_link_forces()</a>, <a class="el" href="maggs_8cpp_source.html#l01242">maggs_check_curl_E()</a>, <a class="el" href="maggs_8cpp_source.html#l02388">maggs_exit()</a>, <a class="el" href="maggs_8cpp_source.html#l00971">maggs_interpolate_charge()</a>, <a class="el" href="maggs_8cpp_source.html#l01274">maggs_perform_rot_move_inplane()</a>, <a class="el" href="maggs_8cpp_source.html#l01953">maggs_propagate_B_field()</a>, <a class="el" href="maggs_8cpp_source.html#l00633">maggs_setup_local_lattice()</a>, and <a class="el" href="maggs_8cpp_source.html#l00563">maggs_setup_neighbors()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aebb8dcc11953d78e620bbef0b9e2183.html">core</a></li><li class="navelem"><a class="el" href="maggs_8cpp.html">maggs.cpp</a></li>
    <li class="footer">Generated on Fri Jun 12 2015 16:19:42 for ESPResSo 3.4-dev-1009-g69a2b86-dirty-git by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
